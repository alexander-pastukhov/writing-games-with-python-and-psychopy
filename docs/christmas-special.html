<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Christmas special | Writing games with Python and PsychoPy</title>
<meta name="author" content="Alexander (Sasha) Pastukhov">
<meta name="description" content="Today we are going to program a Christmas-special. However, this is still an opportunity to learn something new. You will learn about zipping lists and we will start offloading settings into a...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 11 Christmas special | Writing games with Python and PsychoPy">
<meta property="og:type" content="book">
<meta property="og:url" content="https://alexander-pastukhov.github.io/writing-games-with-python-and-psychopy/christmas-special.html">
<meta property="og:description" content="Today we are going to program a Christmas-special. However, this is still an opportunity to learn something new. You will learn about zipping lists and we will start offloading settings into a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Christmas special | Writing games with Python and PsychoPy">
<meta name="twitter:description" content="Today we are going to program a Christmas-special. However, this is still an opportunity to learn something new. You will learn about zipping lists and we will start offloading settings into a...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Writing games with Python and PsychoPy</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="software.html"><span class="header-section-number">2</span> Software</a></li>
<li><a class="" href="programming-tips.html"><span class="header-section-number">3</span> Programming tips and tricks</a></li>
<li><a class="" href="python-basics.html"><span class="header-section-number">4</span> Python basics</a></li>
<li><a class="" href="guess-the-number-single-round.html"><span class="header-section-number">5</span> Guess the Number: a single round edition</a></li>
<li><a class="" href="guess-the-number-multi-round.html"><span class="header-section-number">6</span> Guess the Number: a multi round edition</a></li>
<li><a class="" href="guess-the-number-ai.html"><span class="header-section-number">7</span> Guess the Number: AI takes a turn</a></li>
<li><a class="" href="psychopy-basics.html"><span class="header-section-number">8</span> Gettings started with PsychoPy</a></li>
<li><a class="" href="whack-a-mole.html"><span class="header-section-number">9</span> Whack-a-Mole</a></li>
<li><a class="" href="memory-game.html"><span class="header-section-number">10</span> Memory game</a></li>
<li><a class="active" href="christmas-special.html"><span class="header-section-number">11</span> Christmas special</a></li>
<li><a class="" href="flappy-bird.html"><span class="header-section-number">12</span> Flappy Bird</a></li>
<li><a class="" href="seminar-02-06.html"><span class="header-section-number">13</span> Guitar Hero: staircase and iterator functions</a></li>
<li><a class="" href="the-snake.html"><span class="header-section-number">14</span> The Snake</a></li>
<li><a class="" href="moon-lander.html"><span class="header-section-number">15</span> Moon lander</a></li>
<li><a class="" href="space-invaders.html"><span class="header-section-number">16</span> Space invaders: mixins and duck typing</a></li>
<li><a class="" href="game-of-life-numpy.html"><span class="header-section-number">17</span> Game of life (NumPy)</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/alexander-pastukhov/writing-games-with-python-and-psychopy">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="christmas-special" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Christmas special<a class="anchor" aria-label="anchor" href="#christmas-special"><i class="fas fa-link"></i></a>
</h1>
<p>Today we are going to program a Christmas-special. However, this is still an opportunity to learn something new. You will learn about zipping lists and we will start offloading settings into a separate file. Here is how the Christmas tree looks for me:</p>
<div style="text-align:center;">
<video controls><source src="videos/christmas.m4v" type="video/mp4"></source></video>
</div>
<div id="chapter-concepts-6" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Chapter concepts<a class="anchor" aria-label="anchor" href="#chapter-concepts-6"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Building Christmas spirit</li>
<li>Zipping over lists</li>
<li>Loading setting from JSON or YAML file.</li>
</ul>
</div>
<div id="christmas-tree" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Christmas tree<a class="anchor" aria-label="anchor" href="#christmas-tree"><i class="fas fa-link"></i></a>
</h2>
<p>Let us start our Christmas decoration with a Christmas tree. You can download <a href="material/pine-tree.png">the one I’ve found</a> (created by <a href="https://openclipart.org/artist/isaiah658">isaiah658</a>) or find an image that you like. Create your basic PsychoPy code to create a window (we will be using <a href="https://psychopy.org/api/visual/circle.html#psychopy.visual.circle.Circle">Circle</a> later, so think about suitable units), an <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> with a tree, draw it and wait for any key press.</p>
<div class="rmdnote program">
<p>Put your code into <code>code01.py</code>.</p>
</div>
</div>
<div id="christmas-tree-decoration" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Christmas tree decoration<a class="anchor" aria-label="anchor" href="#christmas-tree-decoration"><i class="fas fa-link"></i></a>
</h2>
<p>For the decoration, let us use <a href="https://psychopy.org/api/visual/circle.html#psychopy.visual.circle.Circle">Circle</a> objects of various sizes and color. We could create each one separately with its own custom hard-coded values, but let us instead create three constants that are lists of equal length that describe, respectively position of each ball (<code>BALL_POS</code> would be a good name, each entry should be a tuple of <code>(x, y)</code>), size (<code>BALL_SIZE</code>), and color (<code>BALL_COLOR</code>, stick to <code>"red"</code>, <code>"blue"</code>, and <code>"yellow"</code>, this limited selection of specific colors will be important later when we animate them).</p>
<p>Create a list of balls by iterating over these three lists. You have two choices, you can either use an index variable, building an index via <a href="https://docs.python.org/3/library/functions.html#func-range">range()</a> using <a href="https://docs.python.org/3/library/functions.html#len">len()</a> of one of the lists (they should all be of the same length). But let use a cool trick of iterating over a <a href="https://docs.python.org/3/library/functions.html#zip">zip()</a> of lists. <a href="https://docs.python.org/3/library/functions.html#zip">zip()</a> gives you a tuple combining one element from each list that you can unpack on the fly as in the example below (note that loop variables will receive values in the order that you used for lists).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="christmas-special.html#cb97-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb97-2"><a href="christmas-special.html#cb97-2" aria-hidden="true" tabindex="-1"></a>letters <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>]</span>
<span id="cb97-3"><a href="christmas-special.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>  a_number, a_letter <span class="kw">in</span>  <span class="bu">zip</span>(numbers, letters):</span>
<span id="cb97-4"><a href="christmas-special.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"</span><span class="sc">%d</span><span class="st">: </span><span class="sc">%s</span><span class="st">"</span><span class="op">%</span>(a_number, a_letter))</span>
<span id="cb97-5"><a href="christmas-special.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1: A</span></span>
<span id="cb97-6"><a href="christmas-special.html#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2: B</span></span>
<span id="cb97-7"><a href="christmas-special.html#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3: C</span></span></code></pre></div>
<p>You can zip as many lists as you want. We, obviously, want three. Decide on whether you want to create <code>balls</code> as an empty list and then append each newly created <a href="https://psychopy.org/api/visual/circle.html#psychopy.visual.circle.Circle">Circle</a> to it in the loop or use list comprehension. Do not forget to draw the balls and think about what you should draw first: the tree or the balls. Experiment with position and sizes to makes it look just perfect.</p>
<div class="rmdnote program">
<p>Put your code into <code>code02.py</code>.</p>
</div>
</div>
<div id="twinkle-twinkle-little-star" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Twinkle, twinkle, little star<a class="anchor" aria-label="anchor" href="#twinkle-twinkle-little-star"><i class="fas fa-link"></i></a>
</h2>
<p>Now let us make our Christmas balls twinkle, as in the video. The idea is that only one color is “active” at a time. The balls of that color are “on” and balls of other color are “off” (white or gray, or some other color of your liking). Now our display becomes dynamic, so you need to have a game loop and with an opportunity to exit the program by pressing <em>escape</em>.</p>
<p>For this, we need to define a list of colors (“red”, “blue”, “yellow”) that we can cycle through and an variable that hold the index of the currently active color (I’ve called it <code>icolor</code>). Every X seconds (I do it every 0.5 seconds, define this as a constant, e.g., <code>TWINKLE_DURATION</code>), increment this index, so that the next color in the list becomes active. Note that you have an out-of-range problem: When you initialize <code>icolor</code> to 0 and increment it by 1 three times, your index is already too large (3, the length of our <code>colors</code> list is 3, so the maximal index is 2). You can either use an <code>if</code> to check for that or you can use a remainder operator <code>%</code> (think about the remainder if you divide <em>any</em> positive value by the length of the <code>colors</code> list).</p>
<p>Once you need to update whether balls are “on” or “off”, you need to loop both through the balls and their colors in the original <code>BALLS_COLOR</code> list (when you use a string with color name, it gets translated into an RGB value, so we cannot compare it directly). Again, you can use <a href="https://docs.python.org/3/library/functions.html#zip">zip()</a> to loop simultaneously through Christmas balls and their color. If their color matches the active one, their <code>fillColor</code> should be that color. If not, their <code>fillColor</code> should be some “neutral” / “off” color (white? gray?).</p>
<p>To keep track of time, you will need a timer variable, use either <a href="https://psychopy.org/api/clock.html#psychopy.clock.Clock">Clock</a> or <a href="https://psychopy.org/api/clock.html#psychopy.clock.CountdownTimer">CountdownTimer</a>. Once the <code>TWINKLE_DURATION</code> elapsed, update the active color, all the balls, and do not forget to reset the timer.</p>
<div class="rmdnote program">
<p>Put your code into <code>code03.py</code>.</p>
</div>
</div>
<div id="lets-make-some-noise" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Let’s make some noise!<a class="anchor" aria-label="anchor" href="#lets-make-some-noise"><i class="fas fa-link"></i></a>
</h2>
<p>Let add some Christmas music! Download <a href="material/Deck%20the%20Halls%20B.ogg">Deck the Halls version by Kevin MacLeod</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Deck the Halls B by Kevin MacLeod &lt;a href="http://incompetech.com" class="uri"&gt;http://incompetech.com&lt;/a&gt;
Creative Commons — Attribution 4.0 International — CC BY 4.0
Free Download / Stream: &lt;a href="https://bit.ly/deck-the-halls-b" class="uri"&gt;https://bit.ly/deck-the-halls-b&lt;/a&gt;
Music promoted by Audio Library &lt;a href="https://youtu.be/RzjZ-WdVeyk" class="uri"&gt;https://youtu.be/RzjZ-WdVeyk&lt;/a&gt;&lt;/p&gt;'><sup>62</sup></a>. For this, we will use <a href="https://psychopy.org/api/sound.html">sound</a> module of PsychoPy library that generate sounds on the fly and also play audio files in various format such as wav or ogg (but not mp3!). Unfortunately, sound it surprisingly tricky, there are many libraries that might be used by PsychoPy (as of end of 2021 PsychoPy lists four backends that it might use), and things sometimes break. Thus, if the music does not play for you, ask me and we will try to set your sound libraries up.</p>
<p>Using sound is very simple. First, you need to import the <code>Sound</code> class as suggested in the manual:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="christmas-special.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> psychopy.sound <span class="im">import</span> Sound</span></code></pre></div>
<p>Then, you need a new object of <code>Sound</code> class supplying the file name as the first parameter (I called the variable <code>song</code>). Right before start the loop, you <code>.play()</code> the sound. Note, if you want to play the same sound again, you need to “rewind” it by explicitly calling its <code>.stop()</code> method (for some reason, the sound stops at the end but does not gets “rewind”, so when you try to play it again and notices that it is already at the end and stops without playing anything).</p>
<div class="rmdnote program">
<p>Put your code into <code>code04.py</code>.</p>
</div>
</div>
<div id="settings-files" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Settings file formats<a class="anchor" aria-label="anchor" href="#settings-files"><i class="fas fa-link"></i></a>
</h2>
<p>So far, we either hard-coded specific values or defined them as constants (a better of these two approaches). However, this means that if you want to run your game with different settings, you need to modify the program itself. And if you want to have two versions of the game (two experimental conditions), you would need to have two programs with all the problems of maintaining virtually identical code in several places at once.</p>
<p>A better approach is to have separate files with settings, so you can keep the code constant and alter specific parameters by specifying which settings file the program should use. This is helpful even you plan to have a single set of setting as it separates code from constants, puts the latter all in one place and makes it easier to edit and check them. There are multiple formats for settings files: XML, INI, JSON, YAML, etc. Our format of the choice for today will be JSON. However, this is a question of taste. Personally, I like YAML for subjective reasons (fewer curly brackets and quotation marks), but you are free to use any format you like. As you will see, this makes little difference for the actual Python code.</p>
<div id="xml" class="section level3" number="11.6.1">
<h3>
<span class="header-section-number">11.6.1</span> XML<a class="anchor" aria-label="anchor" href="#xml"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://en.wikipedia.org/wiki/XML">XML</a> — an Extensible Markup Language — looks similar to HTML (HyperText Markup Language). Experiments designed using PsychoPy Builder interface are stored using XML files but with <a href="https://www.psychopy.org/psyexp.html">.psyexp extension</a>. A settings file for our Christmas programin XML could look like this</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb99-1"><a href="christmas-special.html#cb99-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">Balls</span>&gt;</span>
<span id="cb99-2"><a href="christmas-special.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">Ball</span>&gt;</span>
<span id="cb99-3"><a href="christmas-special.html#cb99-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Position</span>&gt;</span>
<span id="cb99-4"><a href="christmas-special.html#cb99-4" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">x</span>&gt;0.1&lt;/<span class="kw">x</span>&gt;</span>
<span id="cb99-5"><a href="christmas-special.html#cb99-5" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">y</span>&gt;0.2&lt;/<span class="kw">y</span>&gt;</span>
<span id="cb99-6"><a href="christmas-special.html#cb99-6" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">Position</span>&gt;</span>
<span id="cb99-7"><a href="christmas-special.html#cb99-7" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Size</span>&gt;0.01&lt;/<span class="kw">Size</span>&gt;</span>
<span id="cb99-8"><a href="christmas-special.html#cb99-8" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Color</span>&gt;red&lt;/<span class="kw">Color</span>&gt;</span>
<span id="cb99-9"><a href="christmas-special.html#cb99-9" aria-hidden="true" tabindex="-1"></a>  &lt;/<span class="kw">Ball</span>&gt;</span>
<span id="cb99-10"><a href="christmas-special.html#cb99-10" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">Ball</span>&gt;</span>
<span id="cb99-11"><a href="christmas-special.html#cb99-11" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Position</span>&gt;</span>
<span id="cb99-12"><a href="christmas-special.html#cb99-12" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">x</span>&gt;0.2&lt;/<span class="kw">x</span>&gt;</span>
<span id="cb99-13"><a href="christmas-special.html#cb99-13" aria-hidden="true" tabindex="-1"></a>      &lt;<span class="kw">y</span>&gt;0.1&lt;/<span class="kw">y</span>&gt;</span>
<span id="cb99-14"><a href="christmas-special.html#cb99-14" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">Position</span>&gt;</span>
<span id="cb99-15"><a href="christmas-special.html#cb99-15" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Size</span>&gt;0.02&lt;/<span class="kw">Size</span>&gt;</span>
<span id="cb99-16"><a href="christmas-special.html#cb99-16" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">Color</span>&gt;yellow&lt;/<span class="kw">Color</span>&gt;</span>
<span id="cb99-17"><a href="christmas-special.html#cb99-17" aria-hidden="true" tabindex="-1"></a>  &lt;/<span class="kw">Ball</span>&gt;</span>
<span id="cb99-18"><a href="christmas-special.html#cb99-18" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb99-19"><a href="christmas-special.html#cb99-19" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">Balls</span>&gt;</span>
<span id="cb99-20"><a href="christmas-special.html#cb99-20" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">Timing</span>&gt;</span>
<span id="cb99-21"><a href="christmas-special.html#cb99-21" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">Twinkle</span><span class="ot"> duration</span><span class="er">&gt;0.5&lt;/Twinkle</span> <span class="er">duration&gt;</span></span>
<span id="cb99-22"><a href="christmas-special.html#cb99-22" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;/Timing&gt;</span></span></code></pre></div>
<p>The advantage of XML is that it is very flexible yet structured and you can use <a href="https://docs.python.org/3/library/xml.html">native Python interface</a> to work with it. However, XML is not easy for humans to read, it is overpowered for our purposes of having a simple set of unique constants and its power means that using it is fairly cumbersome (I use <code>\</code> to split a single line into many lines).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="christmas-special.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xml.dom <span class="im">import</span> minidom</span>
<span id="cb100-2"><a href="christmas-special.html#cb100-2" aria-hidden="true" tabindex="-1"></a>settings <span class="op">=</span> minidom.parse(<span class="st">'settings.xml'</span>)</span>
<span id="cb100-3"><a href="christmas-special.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this will give you string "0.4"</span></span>
<span id="cb100-4"><a href="christmas-special.html#cb100-4" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> settings.getElementsByTagName(<span class="st">"Balls"</span>)[<span class="dv">0</span>]. <span class="op">\</span></span>
<span id="cb100-5"><a href="christmas-special.html#cb100-5" aria-hidden="true" tabindex="-1"></a>                getElementsByTagName(<span class="st">"Ball"</span>)[<span class="dv">0</span>]. <span class="op">\</span></span>
<span id="cb100-6"><a href="christmas-special.html#cb100-6" aria-hidden="true" tabindex="-1"></a>                getElementsByTagName(<span class="st">"Size"</span>)[<span class="dv">0</span>].firstChild.data</span></code></pre></div>
</div>
<div id="ini" class="section level3" number="11.6.2">
<h3>
<span class="header-section-number">11.6.2</span> INI<a class="anchor" aria-label="anchor" href="#ini"><i class="fas fa-link"></i></a>
</h3>
<p>This is a format with a structure similar to that found in MS Windows INI files.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode ini"><code class="sourceCode ini"><span id="cb101-1"><a href="christmas-special.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[Balls]</span></span>
<span id="cb101-2"><a href="christmas-special.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="dt">    x </span><span class="ot">=</span><span class="st"> 0.1, 0.2</span></span>
<span id="cb101-3"><a href="christmas-special.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="dt">    y </span><span class="ot">=</span><span class="st"> 0.2, 0.1</span></span>
<span id="cb101-4"><a href="christmas-special.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="dt">    size </span><span class="ot">=</span><span class="st"> 0.01, 0.02</span></span>
<span id="cb101-5"><a href="christmas-special.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="dt">    color </span><span class="ot">=</span><span class="st"> red, yellow</span></span>
<span id="cb101-6"><a href="christmas-special.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="kw">[Timing]</span></span>
<span id="cb101-7"><a href="christmas-special.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="dt">    TwinkleDuration </span><span class="ot">=</span><span class="st"> </span><span class="fl">0.5</span></span></code></pre></div>
<p>As you can see it is easier to read and Python has a special <a href="https://docs.python.org/3/library/configparser.html">configparser</a> library to work with them. The object you get is, effectively, a dictionary with additional methods and attributes. However <code>ConfigParser</code> does not try to guess the type of data, so all values are stored as <em>strings</em> and it is your job to convert them to whatever type you need, e.g., integer, list, etc.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="christmas-special.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> configparser</span>
<span id="cb102-2"><a href="christmas-special.html#cb102-2" aria-hidden="true" tabindex="-1"></a>settings <span class="op">=</span> configparser.ConfigParser()</span>
<span id="cb102-3"><a href="christmas-special.html#cb102-3" aria-hidden="true" tabindex="-1"></a>settings.read(<span class="st">'settings.ini'</span>)</span>
<span id="cb102-4"><a href="christmas-special.html#cb102-4" aria-hidden="true" tabindex="-1"></a>settings[<span class="st">'Balls'</span>][<span class="st">'size'</span>] <span class="co"># this will give you a string '0.01, 0.02'</span></span></code></pre></div>
</div>
<div id="json" class="section level3" number="11.6.3">
<h3>
<span class="header-section-number">11.6.3</span> JSON<a class="anchor" aria-label="anchor" href="#json"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://en.wikipedia.org/wiki/JSON">JSON</a> (JavaScript Object Notation) is a popular format to serialize data for web applications that use it to exchange data between a server and a client.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb103-1"><a href="christmas-special.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb103-2"><a href="christmas-special.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Balls"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb103-3"><a href="christmas-special.html#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"position"</span><span class="fu">:</span> <span class="ot">[[</span><span class="fl">0.1</span><span class="ot">,</span> <span class="fl">0.2</span><span class="ot">],</span> <span class="ot">[</span><span class="fl">0.2</span><span class="ot">,</span> <span class="fl">0.1</span><span class="ot">]]</span><span class="fu">,</span></span>
<span id="cb103-4"><a href="christmas-special.html#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"size"</span><span class="fu">:</span> <span class="ot">[</span><span class="fl">0.01</span><span class="ot">,</span> <span class="fl">0.02</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb103-5"><a href="christmas-special.html#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"color"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"red"</span><span class="ot">,</span> <span class="st">"yellow"</span><span class="ot">]</span></span>
<span id="cb103-6"><a href="christmas-special.html#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb103-7"><a href="christmas-special.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Timing"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb103-8"><a href="christmas-special.html#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"Twinkle duration"</span> <span class="fu">:</span> <span class="fl">0.5</span></span>
<span id="cb103-9"><a href="christmas-special.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb103-10"><a href="christmas-special.html#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>You can parse any <em>string</em> in JSON format into a dictionary in Python using <a href="https://docs.python.org/3/library/json.html">json</a> module. Its advantage over INI files is that JSON explicitly specifies data type (i.e., strings are in quotation marks), so it converts it automatically. Note that unlike configparse, json module does not work with files directly, so you need to open it manually (ignore the <code>with</code> magic for a moment, you will learn about it in detail when we will talk about context managers).</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="christmas-special.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb104-2"><a href="christmas-special.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'settings.json'</span>) <span class="im">as</span> json_file:</span>
<span id="cb104-3"><a href="christmas-special.html#cb104-3" aria-hidden="true" tabindex="-1"></a>    settings <span class="op">=</span> json.load(json_file)</span>
<span id="cb104-4"><a href="christmas-special.html#cb104-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb104-5"><a href="christmas-special.html#cb104-5" aria-hidden="true" tabindex="-1"></a>settings[<span class="st">"Balls"</span>][<span class="st">"size"</span>] <span class="co"># this will give a list [0.01, 0.02]</span></span></code></pre></div>
</div>
<div id="yaml" class="section level3" number="11.6.4">
<h3>
<span class="header-section-number">11.6.4</span> YAML<a class="anchor" aria-label="anchor" href="#yaml"><i class="fas fa-link"></i></a>
</h3>
<p><a href="https://en.wikipedia.org/wiki/YAML">YAML</a> (YAML Ain’t Markup Language, rhymes with camel) is very similar to JSON but its config files are more human-readable. It has fewer special symbols and curly brackets but, as in Python, you must watch the indentations as they determine the hierarchy.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb105-1"><a href="christmas-special.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Balls</span><span class="kw">:</span></span>
<span id="cb105-2"><a href="christmas-special.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">position</span><span class="kw">:</span><span class="at"> </span><span class="kw">[[</span><span class="fl">0.1</span><span class="kw">,</span><span class="at"> </span><span class="fl">0.2</span><span class="kw">],</span><span class="at"> </span><span class="kw">[</span><span class="fl">0.2</span><span class="kw">,</span><span class="at"> </span><span class="fl">0.1</span><span class="kw">]]</span></span>
<span id="cb105-3"><a href="christmas-special.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">size</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="fl">0.01</span><span class="kw">,</span><span class="at"> </span><span class="fl">0.02</span><span class="kw">]</span></span>
<span id="cb105-4"><a href="christmas-special.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">color</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"red"</span><span class="kw">,</span><span class="at"> </span><span class="st">"yellow"</span><span class="kw">]</span></span>
<span id="cb105-5"><a href="christmas-special.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Timing</span><span class="kw">:</span></span>
<span id="cb105-6"><a href="christmas-special.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">Twinkle duration </span><span class="kw">:</span><span class="at"> </span><span class="fl">0.5</span></span></code></pre></div>
<p>You will need to install a third-party library <a href="https://pyyaml.org/">pyyaml</a> to work with YAML files. You get the same dictionary as for the JSON</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="christmas-special.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yaml</span>
<span id="cb106-2"><a href="christmas-special.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"settings.yaml"</span>) <span class="im">as</span> yaml_stream:</span>
<span id="cb106-3"><a href="christmas-special.html#cb106-3" aria-hidden="true" tabindex="-1"></a>    settings <span class="op">=</span> yaml.load(yaml_stream)</span>
<span id="cb106-4"><a href="christmas-special.html#cb106-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb106-5"><a href="christmas-special.html#cb106-5" aria-hidden="true" tabindex="-1"></a>settings[<span class="st">"Balls"</span>][<span class="st">"size"</span>] <span class="co"># this will give a list [0.01, 0.02]</span></span></code></pre></div>
</div>
</div>
<div id="using-settings" class="section level2" number="11.7">
<h2>
<span class="header-section-number">11.7</span> Using settings<a class="anchor" aria-label="anchor" href="#using-settings"><i class="fas fa-link"></i></a>
</h2>
<p>Look at your <em>code04.py</em> and identify constants and hard-coded values that you should put into a settings file. E.g., definitely constants that describes Christmas balls and twinkle duration but, possibly, also the size of the window, name of the Christmas tree and song files, etc. In general, I put every such value into settings even if it used only once (as with the size of the window) because then I know that <em>all</em> constants are the settings file. This way there is a single, nicely organized place to check and I do not need to search through the code to figure a specific value out.</p>
<p>Once you transferred all your constants into the settings file (use either JSON or YAML), add the code that loads it at the very beginning and use settings dictionary in place of constants.</p>
<div class="rmdnote program">
<p>Put your code into <code>code05.py</code>.</p>
</div>
</div>
<div id="merry-christmas-and-a-happy-new-year" class="section level2" number="11.8">
<h2>
<span class="header-section-number">11.8</span> Merry Christmas and a Happy New Year!<a class="anchor" aria-label="anchor" href="#merry-christmas-and-a-happy-new-year"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="memory-game.html"><span class="header-section-number">10</span> Memory game</a></div>
<div class="next"><a href="flappy-bird.html"><span class="header-section-number">12</span> Flappy Bird</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#christmas-special"><span class="header-section-number">11</span> Christmas special</a></li>
<li><a class="nav-link" href="#chapter-concepts-6"><span class="header-section-number">11.1</span> Chapter concepts</a></li>
<li><a class="nav-link" href="#christmas-tree"><span class="header-section-number">11.2</span> Christmas tree</a></li>
<li><a class="nav-link" href="#christmas-tree-decoration"><span class="header-section-number">11.3</span> Christmas tree decoration</a></li>
<li><a class="nav-link" href="#twinkle-twinkle-little-star"><span class="header-section-number">11.4</span> Twinkle, twinkle, little star</a></li>
<li><a class="nav-link" href="#lets-make-some-noise"><span class="header-section-number">11.5</span> Let’s make some noise!</a></li>
<li>
<a class="nav-link" href="#settings-files"><span class="header-section-number">11.6</span> Settings file formats</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#xml"><span class="header-section-number">11.6.1</span> XML</a></li>
<li><a class="nav-link" href="#ini"><span class="header-section-number">11.6.2</span> INI</a></li>
<li><a class="nav-link" href="#json"><span class="header-section-number">11.6.3</span> JSON</a></li>
<li><a class="nav-link" href="#yaml"><span class="header-section-number">11.6.4</span> YAML</a></li>
</ul>
</li>
<li><a class="nav-link" href="#using-settings"><span class="header-section-number">11.7</span> Using settings</a></li>
<li><a class="nav-link" href="#merry-christmas-and-a-happy-new-year"><span class="header-section-number">11.8</span> Merry Christmas and a Happy New Year!</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/alexander-pastukhov/writing-games-with-python-and-psychopy/blob/master/09-christmas.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/alexander-pastukhov/writing-games-with-python-and-psychopy/edit/master/09-christmas.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Writing games with Python and PsychoPy</strong>" was written by Alexander (Sasha) Pastukhov. It was last built on 2022-11-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
