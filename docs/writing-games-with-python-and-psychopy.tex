% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\title{Writing games with Python and PsychoPy}
\author{Alexander (Sasha) Pastukhov}
\date{2021-11-15}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Writing games with Python and PsychoPy},
  pdfauthor={Alexander (Sasha) Pastukhov},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{intro}{%
\chapter{Introduction}\label{intro}}

This book will teach you programming. Hopefully, it will do so in a fun way because if there is something more satisfying than playing a video game then it is creating one. Although it is written for the course called \emph{``Python for social and experimental psychology''}, my main aim is not to teach you Python per se. Python is a fantastic tool (more on this later) but it is just one of many programming languages that exist. My ultimate goal is to help you to develop general programming skills, which do not depend on a specific-programming language, and make sure that you form good habits that will make your code clear, easy to read, and easy to maintain. That last part is crucial. Programming is not about writing code that works. That, obviously, must be true but it is only the minimal requirement. Programming is about writing a clear and easy-to-read code that others and, even more importantly, you-two-weeks later can understand.

\hypertarget{prerequisites}{%
\section{Prerequisites}\label{prerequisites}}

The material assumes no foreknowledge of Python or programming from the reader. Its purpose is to gradually build up your knowledge and allow you to create more and more complex games.

\hypertarget{why-games}{%
\section{Why games?}\label{why-games}}

The actual purpose of this course is to teach psychology and social studies students how to program \emph{experiments}. That is what the real research is about. However, there is little practical difference between the two. The basic ingredients are the same and, arguably, experiments are just boring games. And, be assured, if you can program a game, you can certainly program an experiment.

\hypertarget{why-should-a-psychologist-learn-programming}{%
\section{Why should a psychologist learn programming?}\label{why-should-a-psychologist-learn-programming}}

Why should a psychologist, who is interested in people, learn how to program computers? The most obvious answer is that this is a useful skill. Being able to program gives you freedom to create an experiment that answers your research question, not an experiment that can be implemented given constraints of your software.

More importantly, at least from my point of view, learning how to program changes the way you think in general. People are smart but computers are dumb. When you explain your experiment or travel plans to somebody, you can be fairly vague, make a minor mistake, even skip certain parts. People are smart so they will fill the missing information in with their knowledge, spot and correct a mistake, ask you for more information, and can improvise on their own once they encounter something that you have not covered. Computers are dumb, so you must be precise, you cannot have gray areas, you cannot leave anything to ``it will figure it out once it happens'' (it won't). My personal experience, corroborated by psychologists who learned programming, is that it makes you realize just how vague and imprecise people can be without realizing it. Programming forces you to be precise and thorough, to plan ahead for any eventuality there might be. And this is a very useful skill by itself as it can be applied to any activity that requires planning be that an experimental design or travel arrangements.

\hypertarget{why-python}{%
\section{Why Python?}\label{why-python}}

There are many ways to create an experiment for psychological research. You can use drag-and-drop systems either commercial like \href{https://www.neurobs.com/}{Presentation}, \href{https://www.sr-research.com/experiment-builder/}{Experiment Builder} or free like \href{https://psychopy.org/builder}{PsychoPy Bulder interface}. They have a much shallower learning curve, so you can start creating and running your experiments faster. However, the simplicity of their use has a price: They are fairly limited in which stimuli you can use and how you can control the presentation schedule, conditions, feedback, etc. Typically, they allow you to extend them by programming the desired behavior but you do need to know how to program to do this (knowing Python supercharges your PsychoPy experiments). Thus, I think that while these systems, in particular \href{https://psychopy.org/}{PsychoPy}, are great tools to quickly bang a simple experiment together, they are most useful if you understand
\emph{how} they create the underlying code and how you would program it yourself. Then, you will not be limited by the software, as you know you can program something the default drag-and-drop won't allow. At the same time, you can always opt in, if drag-and-drop is sufficient but faster. Or use a mix of the two approaches. At the end, it is about having options and creative freedom to program an experiment that will answer your research question, not an experiment that your software allows you to program.

We will learn programming in Python, which is a great language that combines simple and clear syntax with power and ability to tackle almost any problem. In this seminar, we will concentrate on desktop experiments but you can use it for online experiments (\href{https://otree.readthedocs.io/en/latest/}{oTree} and \href{https://psychopy.org/}{PsychoPy}), scientific programming (\href{https://numpy.org/}{NumPy} and \href{https://www.scipy.org/}{SciPy}), data analysis (\href{https://pandas.pydata.org/}{pandas}), machine learning (\href{https://keras.io/}{keras}), website programming (\href{https://www.djangoproject.com/}{django}), computer vision (\href{https://opencv.org/}{OpenCV}), etc. Thus, Python is one of the most versatile programming tools that you can use for all stages of your research or work. And, Python is free, so you do not need to worry whether you or your future employer will be able to afford license fees (a very real problem, if you use Matlab).

\hypertarget{seminar-specific-information}{%
\section{Seminar-specific information}\label{seminar-specific-information}}

This is a material for \emph{Python for social and experimental psychology} seminar as taught by me at the University of Bamberg. Each chapter covers a single game, introducing necessary ideas and is accompanied by exercises that you need to complete and submit. To pass the seminar, you will need to complete all assignments, i.e., write all the games. You do not need to complete or provide correct solutions for \emph{all} the exercises to pass the course and information on how the points for exercises will be converted to an actual grade (if you need one) or ``pass'' will be available during the seminar.

The material is structured, so that each chapter or chapter section correspond to a single meeting. However, we are all different, so work at your own pace, read the material and submit assignments independently. I will provide detailed feedback for each assignment and you will have an opportunity to address issues and resubmit again with no loss of points. Note that my feedback will cover not only the actual problems with the code but the way you implemented the solution and how clean and well-documented your code is. Remember, our task is not just to learn how to program a working game but how to write a nice clear easy-to-read-and-maintain code\footnote{Good habits! Form good habits! Thank you for reading this subliminal message.}.

Very important: Do not hesitate to ask questions. If I feel that you missed the information in the material, I will point you to the exact location. If you are confused, I'll gently prod you with questions so that you will solve your own problem. If you need more information, I'll supply it. If you simply want to know more, ask and I'll explain why things are the way they are or suggest what to read. If I feel that you should be able to solve the issue without my help, I'll tell you so (although, I would still probably ask a few hinting questions).

\hypertarget{about-the-material}{%
\section{About the material}\label{about-the-material}}

This material is \textbf{free to use} and is licensed under the \href{https://creativecommons.org/licenses/by-nc-nd/4.0/}{Creative Commons Attribution-NonCommercial-NoDerivatives V4.0 International License}.

\hypertarget{software}{%
\chapter{Software}\label{software}}

For this book and seminar, we will need to install

\begin{itemize}
\tightlist
\item
  PsychoPy that comes bundled with Python.
\item
  IDE of your choice. My instructions will be for Visual Studio Code, which has a very good Python support.
\item
  Jupyter Notebook for trying out small snippets of code.
\end{itemize}

I will not give detailed instructions on how to install the necessary software but rather point you to official manuals. This makes this text more future-proof as specific details might easily change\footnote{If you are part of the seminar, ask me whenever you have problems or are unsure about how to proceeed}.

\hypertarget{install-psychopy}{%
\section{PsychoPy}\label{install-psychopy}}

Download and install \href{https://www.psychopy.org/download.html}{Standalone PsychoPy} version. Use whatever the latest (and greatest) PsychoPy version is suggested to you (PsychoPy 2021.2.3 using Python3.6 as of time of writing) and follow instructions.

Note that you can also install PsychoPy as a anaconda package or install an official Python distribution and add PsychoPy via pip. However, I find the standalone easier to use as it has all necessary additional libraries. Plus, it has additional tools for GUI-based experiment programming and integration with \href{https://pavlovia.org/}{Pavlovia.org}.

\hypertarget{install-vs-code}{%
\section{VS Code}\label{install-vs-code}}

\href{https://code.visualstudio.com/}{Visual Studio Code} is a free lightweight open-source editor with strong support for Python. Download the installer for your platform and follow the instructions.

Next, follow \href{https://code.visualstudio.com/docs/python/python-tutorial}{Getting Started with Python in VS Code} tutorial. \textbf{Skip} the \emph{Install a Python interpreter} section, as you already have Python installation bundled with PsychoPy. This is the interpreter that you should use in the \emph{Select a Python interpreter} section. In my case the path is \texttt{C:\textbackslash{}Program\ Files\textbackslash{}PsychoPy3\textbackslash{}python.exe}.

Install and enable a linter, software that highlights syntactical and stylistic problems in your Python source code. Follow the \href{https://code.visualstudio.com/docs/python/linting}{manual} at VS Code website.

\hypertarget{jupyter-notebooks}{%
\section{Jupyter Notebooks}\label{jupyter-notebooks}}

\href{https://jupyter.org/}{Jupyter Notebooks} offer a very convenient way to mix text, figure and code in a single document. They also make it easy to play with various small snippets in parallel without running scripts. We will rely on them for our first chapter and for an occasional exercises or code testing later on. There are two way you can use them: 1) in VS Code using Jupyter extension, 2) in your browser using classical interface.

\hypertarget{jupyter-notebooks-in-vs-code}{%
\subsection{Jupyter Notebooks in VS Code}\label{jupyter-notebooks-in-vs-code}}

Follow \href{https://code.visualstudio.com/docs/datascience/jupyter-notebooks}{the manual} on how to install Jupyter package and use notebooks in VS Code.

\hypertarget{jupyter-notebooks-in-anaconda}{%
\subsection{Jupyter Notebooks in Anaconda}\label{jupyter-notebooks-in-anaconda}}

The simplest way to use Jupyter Notebooks along with a lot of other useful data science tools is via \href{https://www.anaconda.com/products/individual}{Anaconda} toolkit. However, note that this will introduce a \emph{second} Python distribution to your system. This, in turn, could lead to some confusion when working with scripts in VS Code if you accidentally have Anaconda interpreter active instead of the PsychoPy one. Do not panic, follow \href{https://code.visualstudio.com/docs/python/python-tutorial\#_select-a-python-interpreter}{Select a Python interpreter} instructions and make sure that you have PsychoPy interpreter as the active one.

Otherwise, download and install Anaconda. The website has an excellent \href{https://docs.anaconda.com/anaconda/user-guide/getting-started/}{Getting started} section.

\hypertarget{files-folder}{%
\section{Keeping things tidy}\label{files-folder}}

Before we start, I suggest that you create a folder called \emph{games-with-python} (or something along these lines). If you opted to use Jupyter Notebooks via Anaconda, you should create it in your user folder because this is where Anaconda would expects to find them. Then, create a new subfolder for each chapter / game. For the seminar, you would need to zip and upload a folder with all the files.

\hypertarget{programming-tips}{%
\chapter{Programming tips and tricks}\label{programming-tips}}

Below are some tips about writing and reading the code. Some may sound cryptic when you read them for the first time (they will become clear once we cover the necessary material). Some will feel like an overkill for simple projects that we will be implementing. I suggest that you read this section casually the very first time but return to it frequently once we start to program in earnest. Unfortunately, these tricks won't work it you do not use them! So you should \emph{always} use them and they should become your \emph{good habits}, like using a seat belt. The seat belt does nothing useful on most (hopefully, all) days but you wear it because it might suddenly and very urgently become extremely useful and you can never be sure when this will happen. Same with coding. Quite often you will be tempted to write ``quick-n-dirty'' code because this is just a ``simple test'', temporary solution, a prototype, a pilot experiment, etc. But, as they say in Russia ``There is nothing more permanent than a temporary solution''. More often than not, you will find that your toy code grew into a full blown experiment and it is a mess. Or you want to come back to that pilot experiment you did a few months ago but realize that it is easier to start from scratch than to understand how that monster works\footnote{Happened to me more often than I dare to admit.}. Thus, resist the temptation! Form the good habits and you future-you will be very grateful!

\hypertarget{writing-tips}{%
\section{Writing the code}\label{writing-tips}}

\hypertarget{use-a-linter}{%
\subsection{Use a linter}\label{use-a-linter}}

Linter is a program that analyses your code \emph{style} and highlights any issues it finds: spaces where should be none, no spaces where should be some, wrong names, overly long lines, etc. These do not affect how the code runs but following linter's advice results in a consistent standard if boring-looking\footnote{``Boring is Good!'', see ``The Hitman's Bodyguard'' movie.} Python code. Try to address all the problems that the linter raised. However, use your better judgment because sometimes lines that are longer than linter would prefer are more readable than two shorter ones. Similarly, a ``bad'' variable name by linter standards can be a meaningful name for a psychologist. Remember, your code is for people, not for the linter.

\hypertarget{document-your-code}{%
\subsection{Document your code}\label{document-your-code}}

Every time you create a new file: document it and update the documentation whenever you add/change/delete new functions or classes. Every time your create a new function: document it. New class: document it. New constant: unless it is super clear from the name alone, document it. You will learn a \href{https://numpydoc.readthedocs.io/en/latest/format.html}{NumPy} way of doing this in the book.

I cannot stress how important documenting your code is. VS Code (an editor that we will use) is smart enough to parse NumPy docstring, so it will show this help to you whenever you use your own functions (helps you to help you!). More importantly, writing documentation forces you to think and formulate (in human language!) what the function or class is doing, what type the arguments / attributes / methods are, what is the range of valid values, what are the defaults, what should a function return, etc. More often than not, you will realize that you have overlooked some important detail that may not be apparent from the code itself.

\hypertarget{add-some-air}{%
\subsection{Add some air}\label{add-some-air}}

Separate chunks of code with some empty lines. Think paragraphs in the normal text. You wouldn't want your book to be a single paragraph nightmare? Put a comment before each chunk that explains \emph{what} it does but not \emph{how} it does it. E.g., in our typical PsychoPy-based game there will be a point when we draw all stimuli and redraw the window. That is a nice self-contained chunk that can be described as \texttt{\#\ drawing\ all\ stimuli}. The code provides details on what exactly is drawn, what is the drawing order, etc. But that single comment will help you to understand what this chunk is about and whether it is relevant for you at the moment. Same goes for \texttt{\#\ processing\ key\ presses} or \texttt{\#\ checking\ gameover\ conditions}, etc. But be careful and make sure that the comment describes the code correctly. E.g., if the comment says \texttt{\#\ drawing\ all\ stimuli} where should be no stimuli-drawing code anywhere else and no code that does something else!

\hypertarget{write-your-code-one-teeny-tiny-step-a-time}{%
\subsection{Write your code one teeny-tiny step a time}\label{write-your-code-one-teeny-tiny-step-a-time}}

Your motto should be ``slow but steady''. This is the way I will guide you through the games. Always start with a something extremely simple like a static rectangle or image. Make sure it works. Add a minor functionality: Change in color, position, another rectangle, storing it as an attribute, etc. Make sure it works. Never go to the next step unless you fully understand what your current code is doing and you are 100\% certain\footnote{Seriously, 100\%! If you have even a shadow of a doubt, check again. That shadow will grow and make you progressively uncertain about your code.} that it behaves as it should. This tortoise-speed approach may feel silly and overly slow but it is still faster than writing a large chunk of code and then trying to make it work. It is much easier to solve simple problems one at a time than a lot of them simultaneously.

\hypertarget{there-is-nothing-wrong-with-stackoverflow}{%
\subsection{There is nothing wrong with StackOverflow}\label{there-is-nothing-wrong-with-stackoverflow}}

Yes, you can always try to find a solution to your problem on StackOverflow\footnote{However, if you are doing the seminar, ask me first!}. I do it all the time! However, you should use the provided solution \emph{only if you understand it}! Do not copy-paste the code that \emph{seems} to solve a problem like yours. If you do that and you are lucky, it might work. Or, again if you are lucky, it won't work in an obvious manner. But if you are not so lucky, it will (sometimes) work incorrectly in a subtle way. And, since you did not really know what the code was doing when you pasted it, you will be even more confused. So use StackOverflow as a source of knowledge, not as a source of copy-pastable code!

\#\# Reading the code \{\#reading-tips\}
Reading code is easy because computers are dumb and you are smart. This means that instructions you give the computer must necessarily be very simple and, therefore, are very easy to understand for a human. Unfortunately, reading code is also hard because computers are dumb and you are smart. Your are so smart that you don't even need to read the entire code to understand what it is doing, you just read the key bits and fill in the gaps. Unfortunately, this means that you will tend to read over mistakes. This is not unique to programming, if you ever proofraed a text, you now how hard it is to find tipos. Your brain corrects them on the fly using the context and you read the word as it should be, not as it is actually written\footnote{Tip: Read your text one sentence at a time starting from the back or read one random sentence at a time. This breaks the flow of the text and helps you concentrate on words rather than on the meaning and the story.}.

My experience with programming in general and on this seminar in particular is that most problems you get stuck with are simple to be point of being dumb and obvious in retrospect\footnote{Hindsight is always 20/20!}. Do not despair! It is not you, but just a consequence of how wonderfully your brain is wired for pattern-recognition. Below are several suggestions that could help you to make reading code more robust.

\hypertarget{think-like-a-computer}{%
\subsection{Think like a computer}\label{think-like-a-computer}}

Read the code line-by-line and ``execute'' it the way the compute would. Use pen-and-paper to keep the track of variables. Trace which chunks of code can be reached and when. Slow yourself down and make sure you understand each line and are able to keep track of the variables. Once you do that it will be easy to spot a mistake.

\hypertarget{pretend-that-youve-never-seen-this-code-in-your-life}{%
\subsection{Pretend that you've never seen this code in your life}\label{pretend-that-youve-never-seen-this-code-in-your-life}}

Assume that you have no idea what the code is doing. As I wrote, quite often you \emph{literally} do not see a mistake because your brain fills-in details and bends the reality to match your expectations. You \emph{know} what this chunk of code should be doing, so instead of reading it you skim through it and, unless it looks obviously terribly wrong, assume that it does what it should. Turning your expectations off is hard but is immensely helpful.

\hypertarget{do-not-search-only-under-the-street-lamp}{%
\subsection{Do not search only under the street lamp}\label{do-not-search-only-under-the-street-lamp}}

Whenever you are using some new code or need to implement something that feels complicated and your code does not work as it should, you will tend to assume that a problem is with the new fancy code. Simply because it is new, fancy, and complicated. But, in my experience, the error will typically hide in plain sight in the simpler ``trivial'' code nearby which you never properly look at, because it is simple and trivial. Check everything, not just the places where you would expect to have made a mistake.

\hypertarget{use-the-debugger}{%
\subsection{Use the debugger}\label{use-the-debugger}}

In the book, you will learn how to pause an execution of your game, so you can investigate its state. Use this knowledge! Put breakpoints and execute the code step-by-step. Check values of variables using ``Watch'' tab. Use debug console to check whether functions return results that they should. For complex conditions or mathematical formulas, split them into small bits, copy and execute these bits in the debug console and check whether numbers add up. Make sure that a code chunk checks out and then proceed to analyze the next one. Debugging is particularly helpful to identify the code that is not reached or reached at the wrong moment.

\hypertarget{zen-of-python}{%
\section{Zen of Python}\label{zen-of-python}}

I found \href{https://www.python.org/dev/peps/pep-0020/}{Zen of Python} to be good inspiration on how to approach programming.

\hypertarget{python-basics}{%
\chapter{Python basics}\label{python-basics}}

Hopefully, you already \protect\hyperlink{files-folder}{created a special folder} for this book. Download the \href{notebooks/Seminar\%2001.\%20Basics.ipynb}{exercise notebook} (Alt+Click should download rather than open it), put it in a chapter's folder, and open it (see \protect\hyperlink{jupyter-notebooks}{relevant instructions}. You will need to switch between explanations here and the exercises in the notebook, so keep them both open.

\hypertarget{chapter-concepts}{%
\section{Chapter concepts}\label{chapter-concepts}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{variables}{Variables}.
\item
  \protect\hyperlink{constants}{Constants}.
\item
  Basic \protect\hyperlink{value-types}{value types}.
\item
  \protect\hyperlink{print}{Printing} things out.
\item
  Putting values \protect\hyperlink{string-formatting}{into strings}.
\end{itemize}

\hypertarget{variables}{%
\section{Variables}\label{variables}}

The first fundamental concept that we need to be acquainted with is \textbf{variable}. Variables are used to store information and you can think of it as a box with a name tag, so that you can put something into it. The name tag on that box is the name of the variable and its value what you store in it. For example, we can create a variable that stores the number of legs that a game character has. We begin with a number typical for a human being.

\begin{center}\includegraphics[width=0.5\linewidth]{images/variable-as-box} \end{center}

In Python, you would write

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

The \textbf{assignment statement} above has very simple structure:

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{\textless{}}\NormalTok{variable}\OperatorTok{{-}}\NormalTok{name}\OperatorTok{\textgreater{}} \OperatorTok{=} \OperatorTok{\textless{}}\NormalTok{value}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

Variable name (name tag on the box) should be meaningful, it can start with letters or \_ and can contain letters, numbers, and \_ symbol but not spaces, tabs, special characters, etc. Python recommends (well, actually, \href{https://www.python.org/dev/peps/pep-0008/}{insists}) that you use \textbf{snake\_case} (all lower-case, underscore for spaces) to format your variable names. The \texttt{\textless{}value\textgreater{}} on the right side is a more complex story, as it can be hard-coded (as in example above), computed using other variables or the same variable, returned by a function, etc.

Using variables means that you can concentrate what corresponding values \textbf{mean} rather than worrying about what these values are. For example, the next time you need to compute something based on number of character's legs (e.g., how many pairs of shoes does a character need), you can compute it based on current value of \texttt{number\_of\_legs} variable rather than assume that it is \texttt{1}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# BAD: why 1? Is it because the character has two legs or}
\CommentTok{\# because we issue one pair of shoes per character irrespective of}
\CommentTok{\# their actual number of legs?}
\NormalTok{pairs\_of\_shoes }\OperatorTok{=} \DecValTok{1}

\CommentTok{\# BETTER (but what if our character has only one leg?)}
\NormalTok{pairs\_of\_shoes }\OperatorTok{=}\NormalTok{ number\_of\_legs }\OperatorTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

Variables also give you flexibility. Their values can change during the program run: player's score is increasing, number of lives decreasing, number of spells it can cast grows or falls depending on their use, etc. Yet, you can always use the value in the variable to perform necessary computations. For example, here is a slightly extended \texttt{number\_of\_shoes} example.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{2}

\CommentTok{\# ...}
\CommentTok{\# something happens and our character is turned into an octopus}
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{8}
\CommentTok{\# ...}

\CommentTok{\# the same code still works and we still can compute the correct number of pairs of shoes}
\NormalTok{pairs\_of\_shoes }\OperatorTok{=}\NormalTok{ number\_of\_legs }\OperatorTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

As noted above, you can think about a variable as a labeled box you can store something in. That means that you can always ``throw away'' the old value and put something new. In case of variables, the ``throwing away'' part happens automatically, as a new value overwrites the old one. Check yourself, what will be final value of the variable in the code below?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{2}
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{5}
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{1}
\NormalTok{number\_of\_legs}
\end{Highlighting}
\end{Shaded}

Do exercise \#1.

Note that a variable (``a box with a name tag'') exists only after you assign something to it. So, the following code will generate a \texttt{NameError}, a Python's way to tell that you it never heard of variable \texttt{number\_of\_hands}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{2}
\NormalTok{number\_of\_gloves }\OperatorTok{=}\NormalTok{ number\_of\_hands }\OperatorTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

However, you can create a variable the does not hold any \emph{specific} value by assigning \texttt{None} to it. \texttt{None} was added to the language specifically to mean \emph{no value} or \emph{nothing}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_hands }\OperatorTok{=} \VariableTok{None} \CommentTok{\# variable exists now, but holds no particular value.}
\end{Highlighting}
\end{Shaded}

As you have already seen, you can \emph{compute} a value instead of specifying it. What would be the answer here?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{2} \OperatorTok{*} \DecValTok{2}
\NormalTok{number\_of\_legs }\OperatorTok{=} \DecValTok{7} \OperatorTok{{-}} \DecValTok{2}
\NormalTok{number\_of\_legs}
\end{Highlighting}
\end{Shaded}

Do exercise \#2.

\hypertarget{assignments-are-not-equations}{%
\section{Assignments are not equations!}\label{assignments-are-not-equations}}

\textbf{Very important}: although assignments \emph{look} like mathematical equations, they are \textbf{not equations!} They follow a \textbf{very important} rule that you must keep in mind when understanding assignments: the right side of an expression is evaluated \emph{first} until the final value is computed, then and only then that final value is assigned to the variable specified on the left side (put in the box). What this means is that you can use the same variable on \emph{both} sides! Let's take a look at this code:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=} \DecValTok{2}
\NormalTok{y }\OperatorTok{=} \DecValTok{5}
\NormalTok{x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{+}\NormalTok{ y }\OperatorTok{{-}} \DecValTok{4}
\end{Highlighting}
\end{Shaded}

What happens when computer evaluates the last line? First, it takes \emph{current} values of all variables (\texttt{2} for \texttt{x} and \texttt{5} for \texttt{y}) and puts them into the expression. After that internal step, the expression looks like

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=} \DecValTok{2} \OperatorTok{+} \DecValTok{5} \OperatorTok{{-}} \DecValTok{4}
\end{Highlighting}
\end{Shaded}

Then, it computes the expression on the right side and, \textbf{once the computation is completed}, stores that new value in \texttt{x}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=} \DecValTok{3}
\end{Highlighting}
\end{Shaded}

Do exercise \#3 to make sure you understand this.

\hypertarget{constants}{%
\section{Constants}\label{constants}}

Although the real power of variables is that you can change their value, you should use them even if the value remains constant throughout the program. There are no true constants in Python, rather an agreement that their names should be all \texttt{UPPER\_CASE}. Accordingly, when you see \texttt{SUCH\_A\_VARIABLE} you know that you should not change its value. Technically, this is just a recommendation, as no one can stop you from modifying value of a \texttt{CONSTANT}. However, much of Python's ease-of-use comes from such agreements (such as a \texttt{snake\_case} convention above). We will encounter more of such agreements later, for example, when learning about objects.

Taking all this into account, if number of legs stays constant throughout the game, you should highlight that constancy and write

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NUMBER\_OF\_LEGS }\OperatorTok{=} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

I strongly recommend using constants and avoid hardcoding values. First, if you have several identical values that mean different things (2 legs, 2 eyes, 2 ears, 2 vehicles per character, etc.), seeing a \texttt{2} in the code will not tell you what does this \texttt{2} mean (the legs? the ears? the score multiplier?). You can, of course, figure it out based on the code that uses this number but you could spare yourself that extra effort and use a properly named constant instead. Then, you just read its name and the meaning of the value becomes apparent and it is the meaning not the actual value that you are mostly interested in. Second, if you decide to permanently \emph{change} that value (say, our main character is now a tripod), when using a constant means you have only one place to worry about, the rest of the code stays as is. If you hard-coded that number, you are in for an exciting\footnote{not really} and definitely long search-and-replace throughout the entire code.

Do exercise \#4.

\hypertarget{value-types}{%
\section{Value types}\label{value-types}}

So far, we only used integer numeric values (1, 2, 5, 1000\ldots). Although, Python supports \href{https://docs.python.org/3/library/stdtypes.html}{many different value types}, at first we will concentrate on a small subset of them:

\begin{itemize}
\tightlist
\item
  integer numbers, we already used, e.g.~\texttt{-1}, \texttt{100000}, \texttt{42}.
\item
  float numbers that can take any real value, e.g.~\texttt{42.0}, \texttt{3.14159265359}, \texttt{2.71828}.
\item
  strings that can store text. The text is enclosed between either paired quotes \texttt{"some\ text"} or apostrophes \texttt{\textquotesingle{}some\ text\textquotesingle{}}. This means that you can use quotes or apostrophes inside the string, as long as its is enclosed by the alternative. E.g., \texttt{"students\textquotesingle{}\ homework"} (enclosed in \texttt{"}, apostrophe \texttt{\textquotesingle{}} inside) or \texttt{\textquotesingle{}"All\ generalizations\ are\ false,\ including\ this\ one."\ Mark\ Twain\textquotesingle{}} (quotation enclosed by apostrophes). There is much much more to strings and we will cover that material throughout the course.
\item
  logical / Boolean values that are either \texttt{True} or \texttt{False}.
\end{itemize}

When using a variable it is important that you know what type of value it stores and this is mostly on you. In some cases, Python will raise an error, if you try doing a computation using incompatible value types. In other cases, Python will automatically convert values between certain types, e.g.~any integer value is also a real value, so conversion from \texttt{1} to \texttt{1.0} is mostly trivial and automatic. However, in other cases you may need to use explicit conversion. Go to exercise \#5 and try guessing which code will run and which will throw an error due to incompatible types?

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{5} \OperatorTok{+} \FloatTok{2.0}
\CommentTok{\textquotesingle{}5\textquotesingle{}} \OperatorTok{+} \DecValTok{2}
\CommentTok{\textquotesingle{}5\textquotesingle{}} \OperatorTok{+} \StringTok{\textquotesingle{}2\textquotesingle{}}
\CommentTok{\textquotesingle{}5\textquotesingle{}} \OperatorTok{+} \VariableTok{True}
\DecValTok{5} \OperatorTok{+} \VariableTok{True}
\end{Highlighting}
\end{Shaded}

Do exercise \#5.

Surprised by the last one? This is because internally, \texttt{True} is also \texttt{1} and \texttt{False} is \texttt{0}!

You can explicitly convert from one type to another using special functions. For example, to turn a number or a logical value into a string, you simply write \href{https://docs.python.org/3/library/functions.html\#func-str}{str(\textless value\textgreater)}. In examples below, what would be the result?

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{str}\NormalTok{(}\DecValTok{10} \OperatorTok{/} \DecValTok{2}\NormalTok{)}
\BuiltInTok{str}\NormalTok{(}\FloatTok{2.5} \OperatorTok{+} \VariableTok{True}\NormalTok{)}
\BuiltInTok{str}\NormalTok{(}\VariableTok{True}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Do exercise \#6.

Similarly, you can convert to a logical/Boolean variable using \href{https://docs.python.org/3/library/functions.html\#bool}{bool(\textless value\textgreater)} function. The rules are simple, for numeric values \texttt{0} is \texttt{False}, any other non-zero value is converted to \texttt{True}. For string, an empty string \texttt{\textquotesingle{}\textquotesingle{}} is evaluated to \texttt{False} and non-empty string is converted to \texttt{True}. What would be the output in the examples below?

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{bool}\NormalTok{(}\OperatorTok{{-}}\DecValTok{10}\NormalTok{)}
\BuiltInTok{bool}\NormalTok{(}\FloatTok{0.0}\NormalTok{)}

\NormalTok{secret\_message }\OperatorTok{=} \StringTok{\textquotesingle{}\textquotesingle{}}
\BuiltInTok{bool}\NormalTok{(secret\_message)}

\BuiltInTok{bool}\NormalTok{(}\StringTok{\textquotesingle{}False\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Do exercise \#7.

Converting to integer or float numbers using, respectively, \href{https://docs.python.org/3/library/functions.html\#int}{int(\textless value\textgreater)} and \href{https://docs.python.org/3/library/functions.html\#float}{float(\textless value\textgreater)} is trickier. The simplest case is from logical to integer/float, as \texttt{True} gives you \texttt{int(True)} is \texttt{1} and \texttt{float(True)} is \texttt{1.0} and \texttt{False} gives you \texttt{0}/\texttt{0.0}. When converting from float to integer, Python simply drops the fractional part (it does not do proper rounding!). When converting a string, it must be a valid number of the corresponding type or the error is generated. E.g., you can convert a string like \texttt{"123"} to an integer or a float but this won't work for \texttt{"a123"}. Moreover, you can convert \texttt{"123.4"} to floating-point number but not to an integer, as it has fractional part in it. Given all this, which cells would work and what output would they produce?

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{float}\NormalTok{(}\VariableTok{False}\NormalTok{)}
\BuiltInTok{int}\NormalTok{(}\OperatorTok{{-}}\FloatTok{3.3}\NormalTok{)}
\BuiltInTok{float}\NormalTok{(}\StringTok{"67.8"}\NormalTok{)}
\BuiltInTok{int}\NormalTok{(}\StringTok{"123+3"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Do exercise \#8.

\hypertarget{print}{%
\section{Printing output}\label{print}}

To print the value, you need to use \href{https://docs.python.org/3/library/functions.html\#print}{print()} function (we will talk about functions in general later). In the simplest case, you pass the value and it will be printed out.

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\CommentTok{\#\textgreater{} 5}
\end{Highlighting}
\end{Shaded}

or

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{"five"}\NormalTok{)}
\CommentTok{\#\textgreater{} five}
\end{Highlighting}
\end{Shaded}

Of course, you already know about the variables, so rather than putting a value directly, you can pass a variable instead and its \emph{value} will be printed out.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{number\_of\_pancakes }\OperatorTok{=} \DecValTok{10}
\BuiltInTok{print}\NormalTok{(number\_of\_pancakes)}
\CommentTok{\#\textgreater{} 10}
\end{Highlighting}
\end{Shaded}

or

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{breakfast }\OperatorTok{=} \StringTok{"pancakes"}
\BuiltInTok{print}\NormalTok{(breakfast)}
\CommentTok{\#\textgreater{} pancakes}
\end{Highlighting}
\end{Shaded}

You can also pass more than one value/variable to the print function and all values will be printed one after another. For example, if we want to tell the user what did I had for breakfast, we can do

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{breakfast }\OperatorTok{=} \StringTok{"pancakes"}
\NormalTok{number\_of\_items }\OperatorTok{=} \DecValTok{10}
\BuiltInTok{print}\NormalTok{(breakfast, number\_of\_items)}
\CommentTok{\#\textgreater{} pancakes 10}
\end{Highlighting}
\end{Shaded}

What will be printed by the code below?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dinner }\OperatorTok{=} \StringTok{"steak"}
\NormalTok{count }\OperatorTok{=} \DecValTok{4}
\NormalTok{desert }\OperatorTok{=} \StringTok{"cupcakes"}

\BuiltInTok{print}\NormalTok{(count, dinner, count, desert)}
\end{Highlighting}
\end{Shaded}

Do exercise \#9.

However, you probably would want to be more explicit, when you print out the information. For example, imagine you have these three variables:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{meal }\OperatorTok{=} \StringTok{"breakfast"}
\NormalTok{dish }\OperatorTok{=} \StringTok{"pancakes"}
\NormalTok{count }\OperatorTok{=} \DecValTok{10}
\end{Highlighting}
\end{Shaded}

You could, of course do \texttt{print(meal,\ dish,\ count)} but it would be nicer to print ``\emph{I had \textbf{10 pancakes} for \textbf{breakfast}}'', where items in bold would be the inserted variables' values. For this, we need to use string formatting. Please note that the string formatting is not specific to printing, you can create a new string value via formatting and store it in a variable without printing it out or print it out without storing it.

\hypertarget{string-formatting}{%
\section{String formatting}\label{string-formatting}}

A great resource on string formatting in Python is \href{https://pyformat.info/}{pyformat.info}. As Python constantly evolves, it now has more than one way to format strings. Below, I will introduce the ``old'' format that is based on classic string formatting used in \texttt{sprintf} function in C, Matlab, R, and many other programming languages. It is somewhat less flexible than newer ones but for simple tasks the difference is negligible. Knowing the old format is useful because of its generality. If you want to learn alternatives, read at the link above.

The general call is \texttt{"a\ string\ with\ formatting"\%(tuple\ of\ values\ to\ be\ used\ during\ formatting)}. You will learn about tuples later. For now, assume that it is just a comma-separated list of values enclosed in round brackets: \texttt{(1,\ 2,\ 3)}.

In \texttt{"a\ string\ with\ formatting"}, you specify where you want to put the value via \texttt{\%} symbol that is followed by an \emph{optional} formatting info and the \emph{required} symbol that defines the \textbf{type} of the value. The type symbols are

\begin{itemize}
\tightlist
\item
  \texttt{s} for string
\item
  \texttt{d} for an integer
\item
  \texttt{f} for a float value
\item
  \texttt{g} for an ``optimally'' printed float value, so that scientific notation is used for large values (\emph{e.g.}, \texttt{10e5} instead of \texttt{100000}).
\end{itemize}

Here is an example of formatting a string using an integer:

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{"I had }\SpecialCharTok{\%d}\StringTok{ pancakes for breakfast"}\OperatorTok{\%}\NormalTok{(}\DecValTok{10}\NormalTok{))}
\CommentTok{\#\textgreater{} I had 10 pancakes for breakfast}
\end{Highlighting}
\end{Shaded}

You are not limited to a single value that you can put into a string. You can specify more locations via \texttt{\%} but you must make sure that you pass the right number of values in the right order. Before running it, can you figure out which call will actually work (and what will be the output) and which will produce an error?

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{\textquotesingle{}I had }\SpecialCharTok{\%d}\StringTok{ pancakes and either }\SpecialCharTok{\%d}\StringTok{  or }\SpecialCharTok{\%d}\StringTok{ steaks for dinner\textquotesingle{}}\OperatorTok{\%}\NormalTok{(}\DecValTok{2}\NormalTok{))}
\BuiltInTok{print}\NormalTok{(}\StringTok{\textquotesingle{}I had }\SpecialCharTok{\%d}\StringTok{ pancakes and }\SpecialCharTok{\%d}\StringTok{ steaks for dinner\textquotesingle{}}\OperatorTok{\%}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{10}\NormalTok{))}
\BuiltInTok{print}\NormalTok{(}\StringTok{\textquotesingle{}I had }\SpecialCharTok{\%d}\StringTok{ pancakes and }\SpecialCharTok{\%d}\StringTok{ steaks for dinner\textquotesingle{}}\OperatorTok{\%}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Do exercise \#10.

As noted above, in case of real values you have two options: \texttt{\%f} and \texttt{\%g}. The latter uses scientific notation (e.g.~\texttt{1e10} for \texttt{10000000000}) to make a representation more compact.

Do exercise \#11 to get a better feeling for the difference.

These is much more to formatting and you can read about it at \href{https://pyformat.info/}{pyformat.info}. However, these basics are sufficient for us to start programming our first game in the next chapter.

\hypertarget{guess-the-number-single-round}{%
\chapter{Guess the Number: a single round edition}\label{guess-the-number-single-round}}

The previous chapter covered Python basics, so now you are ready to start developing you first game! We will build it step by step as there will be a lot to learn about input, libraries, conditional statements, and indentation.

Before you start, create a new folder (inside your \protect\hyperlink{files-folder}{course folder}) called, for example, ``guess-the-number'', download \href{notebooks/Seminar\%2002.\%20Guess\%20the\%20number\%20-\%20single\%20round.ipynb}{exercise notebook}, copy it in the newly created folder, and open it in \protect\hyperlink{jupyter-notebooks}{Jupyter Notebook}. As in the chapter before, it will contain exercises on reading and understanding the code.

However, we will be using \protect\hyperlink{install-vs-code}{VS Code} to program scripts with the actual game. You will need to create a separate file for each code practice\footnote{You can ``Save as\ldots{}'' the previous code to avoid copy-pasting things by hand.} (e.g., \emph{code01.py}\footnote{I recommend using \texttt{01} instead of \texttt{1}, as it will ensure consistent file sorting in your file manager}, \emph{code02.py}, etc.) This is not the most efficient implementation of a version control and it will certainly clutter the folder. But it would allow me to see your solutions for every step, which will make it easier for me to give feedback. For submitting the assignment, just zip the folder and submit the zip-file.

\hypertarget{chapter-concepts-1}{%
\section{Chapter concepts}\label{chapter-concepts-1}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{documenting-your-code}{Documenting code}.
\item
  \protect\hyperlink{debugging}{Debugging code}.
\item
  Getting \protect\hyperlink{input-function}{input} from a user.
\item
  Using \protect\hyperlink{comparisons}{comparison} in \protect\hyperlink{if-statement}{conditional statements}.
\item
  Using \protect\hyperlink{indentation}{indentation} to group statements together.
\item
  Using Python \protect\hyperlink{using-libraries}{libraries}.
\item
  Generating \protect\hyperlink{picking-a-number-randomly}{random numbers}.
\end{itemize}

\hypertarget{the-game}{%
\section{The Game}\label{the-game}}

We will program a game in which one participant (computer) picks a number within a certain range (say, between 1 and 10) and the other participant (human player) is trying to guess it. After every guess of the human, the computer responds whether the actual number is lower than a guess, higher than a guess, or matches it. The game is over when the player correctly guesses the number or (in the later version of the game) runs out of attempts.

Our first version will allow just one attempt and the overall game algorithm will look like this:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  computer generates a random number between 1 and 10
\item
  prints it out for debug purposes
\item
  prompts user to enter a guess
\item
  compares two numbers and print outs the outcome: ``My number is lower'', ``My number is higher'', or ``Spot on!''
\end{enumerate}

\hypertarget{lets-pick-a-number}{%
\section{Let's pick a number}\label{lets-pick-a-number}}

Let us start by implementing just the first two steps of the program. First, create a variable holding a number that computer ``picked''. We will name it \texttt{number\_picked} (you can use some other meaningful name as well but it might be easier if we all stick to the same name). To make things a simpler at the beginning, we will hard-code an arbitrary number between 1 and 10 (pick the one you like). Then, let us print it out, so that we know the number ourselves \footnote{Of course, we know it because we hard-coded it. But that won't be the case when computer will generate it randomly, so let us plan for the future}. Use string formatting to make things user-friendly, e.g., print out something like ``The number I've picked is \ldots{}''. You should be able to do this using the knowledge from the previous chapter. Your code should be a two-liner:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. create variable and set its value}
\CommentTok{\# 2. print out the value}
\end{Highlighting}
\end{Shaded}

Try out this two-liner in a Jupyter Notebook (create an empty notebook just for that). Once you are happy with it, copy-paste the code into \texttt{code01.py} and read on to learn how to run it.

Put your code into \texttt{code01.py}.

\hypertarget{documenting-your-code}{%
\section{Documenting your code}\label{documenting-your-code}}

Now that you have your first file with Python program, you should document it. Documenting a two-lines long and simple program may feel silly but it should be an automatic thing. Later on you will find yourself using several lines of comments to document a single line function. Again, it is not about the code that works, it is about the code you can understand. In a sense, it is better to have a clean well-documented program that currently does not work correctly than an undocumented spaghetti code that does. You can fix and update the former, but maintaining or updating the latter\ldots{}

In Python, you have two ways to write comments multiline and single line

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}}
\CommentTok{A }
\CommentTok{multiline }
\CommentTok{comment}
\CommentTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}}

\CommentTok{\#  A single line comment.}
\end{Highlighting}
\end{Shaded}

Use multiline comments to write documentation for individual files, functions, classes, methods, etc. You will learn how to format this documentation Numpy docstring style, once you learn about functions. In our case, you should start your \texttt{code01.py} file with a multiline comment that briefly describes what program it contains. Minimally, you should write that this is a \emph{Guess a Number} game. It is probably a good idea to sketch out what the game is about.

Use single line comments to explain what happens in a particular code block. You do not need to comment every line and you should not explain the code in human language. A comment should be about \emph{what} is going on not \emph{how}. At the moment, we have too little code to need this.

Document \texttt{code01.py} file.

\hypertarget{debugging}{%
\section{Running and debugging your game in VS Code}\label{debugging}}

Now that we have a two-lines-long program, we can run it and already start learning how to debug it. Yes, our current program is probably to simple to require actual debugging but it is also simple enough to make understanding debugging easier as well. And debugging is a crucial skill that turns a running program from a black box into something transparent and easy\footnote{Or, at least, easier.} to understand. Below I will describe how to debug in VS Code but you might want to consult \href{https://code.visualstudio.com/docs/python/debugging}{an official manual} in case things have changed in the meantime.

There are two ways to run a Python program in VS Code. First, you can use the \emph{``Run Python File in Terminal''} play button on the right. This runs your program \emph{without} a debugger, so you should use it only for the actual runs of the finalized code. Still, you can try running it and see whether it prints out what it should.

\begin{figure}
\centering
\includegraphics{images/debug-vs-run.png}
\caption{Running code without a debugger.}
\end{figure}

The alternative is the debugging tab, the one with a little bug on top of the run button. If you select it, it will show \emph{``Run and Debug''}. Click on the button and it will offer various choices for different kinds of Python projects and frameworks. For our intents and purposes, we will only need \emph{``Python File: Debug the currently active Python file''}. Click on that and it will execute your code (should run exactly the same way as with the other button).

\begin{figure}
\centering
\includegraphics{images/debug-select-debug-configuration.png}
\caption{Selecting debugging configuration.}
\end{figure}

You probably do not want to click through Debugging tab → Run and Debug button → Pick configuration all the time. A better way is to configure it once and for all and then use \textbf{F5} key to run your code. First, click on \emph{``create a launch.json file''} and select the \emph{``Python File: Debug the currently active Python file''} again. You will see a new \emph{launch.json} file appearing in the editor that should look like this:

\begin{figure}
\centering
\includegraphics{images/debug-launch-json.png}
\caption{Debug configuration in launch.json file.}
\end{figure}

That's it! VS Code created a configuration for you. Now you can close \emph{launch.json} file and run your program with a simple press of \textbf{F5} button. Try it! Again, it should work just like before, so why did we go through all this trouble? Because debugger will \emph{pause} an execution of your code whenever it encounters a problem, giving you a chance to examine variables, run snippets of code, etc. In contrast, running python file in terminal (the first option) will only print an error message and exit the program. Moreover, you can use \emph{breakpoints} to pause the program at any line, which gives you an opportunity to examine your code at any location that you need.

You enable breakpoints by clicking to the left of the line number that you are interested in. Here, I've clicked on line 6 and you can see a red dot that indicates an active breakpoint.

\begin{figure}
\centering
\includegraphics{images/debug-breakpoint.png}
\caption{Active breakpoint.}
\end{figure}

If I now run the code via \textbf{F5}, the program will stop at that line \emph{before} executing it.

\begin{figure}
\centering
\includegraphics{images/debug-pause.png}
\caption{Program paused at the breakpoint.}
\end{figure}

This gives me a chance to see what value my \texttt{number\_picked} variable has. It is already listed in local variables (top left). But I also added it to list of watched variables (\emph{Watch}, lift middle) and I also looked at its value in the \emph{Debug Console} (bottom tab) that allows me to execute \emph{any} Python code while my program is paused. Do the same and explore these different ways yourself. For example, see how you can compute \texttt{number\_picked\ +\ 1} or \texttt{number\_picked\ *\ number\_picked} in the \emph{Watch} tab and in \emph{Debug Console}.

Once you are done examining the current state of the program, you have six buttons at the top to decide what to do next (hover over them to see hints). They are, from left to right

\begin{itemize}
\tightlist
\item
  Continue (\textbf{F5}): resume the program.
\item
  Step Over (\textbf{F10}): executes the code without going into functions (this and two following options will become clearer once you learn about writing functions).
\item
  Step Into the code (\textbf{F11})
\item
  Step Out of the code (\textbf{Shift+F11}).
\item
  Restart the program (\textbf{Ctrl+Shift+F5}).
\item
  Stop the program (\textbf{Shift+F5}).
\end{itemize}

To better understand how this works, stop the program (\textbf{Shift+F5}) and put an additional breakpoint on the first line of your code (line \#5 in my program, the other lines are comments or are empty). Run the program again via \textbf{F5} and it will pause at that very first line. Can you figure out the value of variable \texttt{number\_picked} now?

The answer is ``no'' because that variable does not exist yet. Remember, the program pauses \emph{before} executing the line. Use \textbf{F10} to step through the code line by line to see how the variable appears and the information gets printed out.

This debugging exercise may not have been necessary to solve problems with your current code but it showed how to do that in the future. Do not hesitate to put a breakpoint to pause the program and check that reality (i.e., actual values of variables) matches your expectations. Use the stepping through the code to slow things down to watch and ponder.

\hypertarget{input-function}{%
\section{Asking a player for a guess}\label{input-function}}

It takes two to play the \emph{Guess the Number} game. The computer did its part by picking a number, now we need to ask a player to enter their guess. For this, we will use \href{https://docs.python.org/3/library/functions.html\#input}{input({[}prompt{]})} \emph{function}.

A function is an isolated code that accepts (optional) \emph{inputs}, performs an \emph{action}, and, optionally, returns a value (\emph{output}). This allows both to split the code into smaller chunks that are easier to maintain and to reuse the same code. You already used \href{https://docs.python.org/3/library/functions.html\#print}{print()} function to print things out, and \href{https://docs.python.org/3/library/functions.html\#func-str}{str()}, \href{https://docs.python.org/3/library/functions.html\#bool}{bool()}, \href{https://docs.python.org/3/library/functions.html\#int}{int()} and \href{https://docs.python.org/3/library/functions.html\#float}{float()} functions to convert values. For \href{https://docs.python.org/3/library/functions.html\#print}{print()} \emph{input} is an arbitrary number of values (even none, try this in Jupiter Notebook!), its \emph{action} is to print things out, but it returns nothing (no \emph{output}). \href{https://docs.python.org/3/library/functions.html\#float}{float()} function takes (somewhat surprisingly) zero or one value as \emph{input} (try giving it none or more than one in Jupiter Notebook as see the difference), attempts to convert given value to float (throwing an error, if it cannot do it), and returns a float value as an \emph{output}.

Similar \emph{input} → \emph{action} → \emph{output} scheme holds for the \href{https://docs.python.org/3/library/functions.html\#input}{input({[}prompt{]})}. It takes optional \texttt{prompt} string as input. Then it prints the \texttt{prompt} message and waits for a user to enter a \emph{string} until they press \textbf{Enter}. It then returns this \emph{string} value. The latter bit about \emph{string} is important, because in our game we need a player to enter an \emph{integer} not a string. For a moment, let us assume that the input is always a valid integer number, so type only valid integers when testing the program! This way we can convert it to an integer without extra checks (will add them in the future) and assign this value to a new variable called \texttt{guess}. Thus, you need to add a single line assignment statement with \texttt{guess} variable on the left side and call to \href{https://docs.python.org/3/library/functions.html\#input}{input()} function on the right side (think of a nice prompt message) wrapped by (inside of) the type-conversion to integer via \href{https://docs.python.org/3/library/functions.html\#int}{int()}. Test this code but, again, only enter valid integers, so that the conversion works without an error.

Update your \texttt{code01.py}.

\hypertarget{if-statement}{%
\section{\texorpdfstring{Conditional \emph{if} statement}{Conditional if statement}}\label{if-statement}}

Now we have two numbers: One that computer picked (\texttt{number\_picked}) and one that is player entered (\texttt{guess}). We need to compare them to provide correct output message. For this, we will use conditional \href{https://docs.python.org/3/tutorial/controlflow.html\#if-statements}{if statement}:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ some\_condition\_is\_true:}
    \CommentTok{\# do something}
\ControlFlowTok{elif}\NormalTok{ some\_other\_condition\_is\_true:}
    \CommentTok{\# do something else}
\ControlFlowTok{elif}\NormalTok{ yet\_another\_condition\_is\_true:}
    \CommentTok{\# do yet something else}
\ControlFlowTok{else}\NormalTok{:}
    \CommentTok{\# do something only if all conditions above are false.}
\end{Highlighting}
\end{Shaded}

Only the \texttt{if} part is required, whereas \texttt{elif} (short for ``else, if'') and \texttt{else} are optional. Thus you can do something, only if a condition is true:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ some\_condition\_is\_true:}
    \CommentTok{\# do something, but OTHERWISE DO NOT DO ANYTHING }
    \CommentTok{\# and continue with code execution}
  
\CommentTok{\# some code that is executed after the if{-}statement,}
\CommentTok{\# irrespective of whether the condition was true or not.}
\end{Highlighting}
\end{Shaded}

Before we can use conditional statements in our game, you need to understand (1) the conditions themselves and (2) use of indentation as a mean of grouping statements together.

\hypertarget{comparisons}{%
\section{Conditions and comparisons}\label{comparisons}}

Condition is any expression that can be evaluated to see whether it is \texttt{True} or \texttt{False}. A straightforward example of such expression are comparisons expressed in human language as: \emph{Is today Thursday?} \emph{Is the answer (equal to) 42?} \emph{Is it raining and I have an umbrella?}. We will concentrate on comparisons like that for a moment but later you will see that in Python \emph{any} expression is either \texttt{True} or \texttt{False}, even when it does not look like a comparison\footnote{This is because you can convert any value to a logical one via \href{https://docs.python.org/3/library/functions.html\#bool}{bool()} function that you learned about the last time and so any value is (converted to) either \texttt{True} or \texttt{False}.}.

For the comparison, you can use the following operators:

\begin{itemize}
\tightlist
\item
  \emph{``A is equal B''} is written as \texttt{A\ ==\ B}.
\item
  \emph{``A is not equal B''} is written as \texttt{A\ !=\ B}.
\item
  \emph{``A is greater than B''} and \emph{``A is smaller than B''} are, respectively, \texttt{A\ \textgreater{}\ B} and \texttt{A\ \textless{}\ B}.
\item
  \emph{``A is greater than or equal to B''} and \emph{``A is smaller than or equal to B''} are, respectively, \texttt{A\ \textgreater{}=\ B} and \texttt{A\ \textless{}=\ B} (please note the order of symbols as \texttt{=\textgreater{}} and \texttt{=\textless{}} will produce an error).
\end{itemize}

Go to exercise \#1 to solve some comparisons.

Note that Python also has an \href{https://docs.python.org/3/library/operator.html\#operator.is_}{is} operator that may \emph{look} identical to \texttt{==} (e.g., \texttt{x\ ==\ 2} looks equivalent to \texttt{x\ is\ 2}). Moreover, is \emph{some} cases it also works the same way. However, there is a subtle difference: \texttt{==} checks whether \emph{values} are identical, whereas \texttt{is} checks whether \emph{objects} (that ``hold'' values) are identical. You need to understand classes and objects before you can appreciate this difference, so for now just keep in mind that you should only use \texttt{==} (I will explicitly mentioned when \texttt{is} is needed).

You can \emph{invert} the logical value using \texttt{not} operator, as \texttt{not\ True} is \texttt{False} and \texttt{not\ False} is \texttt{True}. This means that \texttt{A\ !=\ B} is the same as \texttt{not\ A\ ==\ B} and, correspondingly, \texttt{A\ ==\ B} is \texttt{not\ A\ !=\ B}. To see how that works, consider both cases when \texttt{A} is indeed equal \texttt{B} and when it is not.

\begin{itemize}
\tightlist
\item
  If A is equal B then \texttt{A\ ==\ B} evaluates to \texttt{True}. The \texttt{A\ !=\ B} is then \texttt{False}, so \texttt{not\ A\ !=\ B} → \texttt{not\ False} → \texttt{True}.
\item
  If A is not equal B then \texttt{A\ ==\ B} evaluates to \texttt{False}. The \texttt{A\ !=\ B} is then \texttt{True}, so \texttt{not\ A\ !=\ B} → \texttt{not\ True} → \texttt{False}.
\end{itemize}

Go to exercise \#2 to explore this inversion yourself.

You can also combine several comparisons using \texttt{and} and/or\footnote{pun intended} \texttt{or} operators. As in human language, \texttt{and} means that both parts must be true: \texttt{True\ and\ True} → \texttt{True} but \texttt{True\ and\ False} → \texttt{False}, \texttt{False\ and\ True} → \texttt{False}, and \texttt{False\ and\ False} → \texttt{False}. Same holds if you have more have than two conditions/comparisons linked via \texttt{and}: \textbf{All} of them must be true. In case of \texttt{or} only one of the statements must be true, e.g.~\texttt{True\ and\ True} → \texttt{True}, \texttt{True\ and\ False} → \texttt{True}, \texttt{False\ and\ True} → \texttt{True}, but \texttt{False\ and\ False} → \texttt{False}. Again, for more than two comparisons/conditions at least one of them should be true for the entire expression to be true.

Do exercises \#3 and \#4.

Subtle but important point: conditions are evaluated from left to right until the whole expression is resolved one way or another. This means that if the first expression in a \texttt{and} pair is \texttt{False}, the second one is \textbf{never evaluated}. I.e., if \texttt{first\ and\ second} expressions both need to be \texttt{True} and you know that \texttt{first} expression already is false, the whole expression will be \texttt{False} in any case. This means that in the code below there will be no error, even though evaluating \texttt{int("e123")} alone would raise a \texttt{ValueError}.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \OperatorTok{*} \DecValTok{2} \OperatorTok{==} \DecValTok{5} \KeywordTok{and} \BuiltInTok{int}\NormalTok{(}\StringTok{"e123"}\NormalTok{) }\OperatorTok{==} \DecValTok{123}
\end{Highlighting}
\end{Shaded}

However, reverse the order, so that \texttt{int("e123")\ ==\ 123} needs to be evaluated first and you get the error message

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{int}\NormalTok{(}\StringTok{"e123"}\NormalTok{) }\OperatorTok{==} \DecValTok{123} \KeywordTok{and} \DecValTok{2} \OperatorTok{*} \DecValTok{2} \OperatorTok{==} \DecValTok{4}
\CommentTok{\# Generates ValueError: invalid literal for int() with base 10: \textquotesingle{}e123\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

Similarly, if \emph{any} expression in \texttt{or} is \texttt{True}, you do not need to check the rest.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \OperatorTok{*} \DecValTok{2} \OperatorTok{==} \DecValTok{4} \KeywordTok{or} \BuiltInTok{int}\NormalTok{(}\StringTok{"e123"}\NormalTok{) }\OperatorTok{==} \DecValTok{123}
\end{Highlighting}
\end{Shaded}

However, if the first condition is \texttt{False}, we do need to continue (and stumble into an error):

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \OperatorTok{*} \DecValTok{2} \OperatorTok{==} \DecValTok{5} \KeywordTok{or} \BuiltInTok{int}\NormalTok{(}\StringTok{"e123"}\NormalTok{) }\OperatorTok{==} \DecValTok{123}
\CommentTok{\# Generates ValueError: invalid literal for int() with base 10: \textquotesingle{}e123\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

Do exercise \#5.

Finally, like in simple arithmetic, you can use brackets \texttt{()} to group conditions together. Thus a statement ``I always eat chocolate but I eat spinach only when I am hungry'' can be written as \texttt{food\ ==\ "chocolate"\ or\ (food\ ==\ "spinach"\ and\ hungry)}. Here, \texttt{the\ food\ ==\ "chocolate"} and \texttt{food\ ==\ "spinach"\ and\ hungry} are evaluated independently, their values are substituted in their place and then the \texttt{and} condition is evaluated.

Do exercise \#6.

Final thought on comparisons: Do not hesitate to test them in Jupyter Notebook using various combinations of values or pause the program at the condition via a breakpoint and evaluate a comparison in \emph{Watch} or \emph{Debug Console}.

\hypertarget{indentation}{%
\section{Grouping statements via indentation}\label{indentation}}

Let us go back to a conditional if-statement. Take a look at following code example (and note an \texttt{:} at the end of the \texttt{if\ some\_condition\_is\_true:}), in which \emph{statement \#1} is executed only if \emph{some condition} is true, whereas \emph{statement \#2} is executed after that \emph{irrespective} of the condition.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ some\_condition\_is\_true:}
\NormalTok{    statement }\CommentTok{\#1}
\NormalTok{statement }\CommentTok{\#2 }
\end{Highlighting}
\end{Shaded}

Both statements \#1 and \#2 appear after the if-statement, so how does Python now that the first one is executed only if condition is true but the other one always runs? The answer is indentation: The \textbf{4 (four!) spaces} that are automatically added whenever you press \textbf{Tab} in VS Code and removed whenever you press \textbf{Shift+Tab}. The indentation puts statement \#1 \emph{inside} the if-statement. Thus, indentation shows whether statements belong to the same group and must be executed one after another (same indentation level for \texttt{if} and \texttt{statement\ \#2}) or are inside conditional statement, loop, function, class, etc. (\texttt{statement\ \#1}). For more complex code that will have, for example, an if-statement inside an if-statement inside a loop, you will express this by adding more levels of indentation. E.g.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# some statements outside of the loop (0 indentation)}
\ControlFlowTok{while}\NormalTok{ game\_is\_not\_over: }\CommentTok{\# (0 indentation)}
    \CommentTok{\# statements inside of the loop }
    \ControlFlowTok{if}\NormalTok{ key\_pressed: }\CommentTok{\# (indentation of 4)}
        \CommentTok{\# inside loop and if{-}statement }
        \ControlFlowTok{if}\NormalTok{ key }\OperatorTok{==} \StringTok{"Space"}\NormalTok{: }\CommentTok{\# (indentation of 8)}
            \CommentTok{\# inside the loop, and if{-}statement, and another if{-}statement}
\NormalTok{            jump() }\CommentTok{\# (indentation of 12)}
        \ControlFlowTok{else}\NormalTok{: }\CommentTok{\# (indentation of 4)}
            \CommentTok{\# inside the loop, and if{-}statement, and else part of another if{-}statement}
\NormalTok{            stand() }\CommentTok{\# (indentation of 12)}
    
    \CommentTok{\# statements inside of the loop but outside of the outermost if{-}statement}
    \BuiltInTok{print}\NormalTok{(key) }\CommentTok{\# (indentation of 4)}
    
\CommentTok{\# some statements outside of the loop (0 indentation)}
\end{Highlighting}
\end{Shaded}

Pay very close attention to the indentation as it determines which statements are executed together! A wrong indentation level is unfortunately a very common mistake.

Do exercise \#7.

The \texttt{if} and \texttt{ifelse} statements are evaluated until one of them turns out to be \texttt{True}. After that any following \texttt{ifelse} and \texttt{else} statements are simply ignored.

Do exercise \#8.

\hypertarget{checking-the-answer}{%
\section{Checking the answer}\label{checking-the-answer}}

Now you have all necessary tools to finish the first version of our game. Add a conditional statements to your \texttt{code01.py}, so that

\begin{itemize}
\tightlist
\item
  if the computer pick is smaller than player's guess, it will print \texttt{"My\ number\ is\ lower!"}
\item
  if the computer pick is larger than player's guess, it will print \texttt{"My\ number\ is\ higher!"}
\item
  if two numbers are identical, it will print \texttt{"Spot\ on!"}
\end{itemize}

Update \texttt{code01.py}

Test that your code works. Again, use breakpoints if you need to better understand the control flow and check whether comparisons work the way you expect.

\hypertarget{using-libraries}{%
\section{Using libraries}\label{using-libraries}}

Our game is ``feature-complete'': computer picks a number, player makes a guess, computer responds appropriately. However, currently we are playing for both sides. Lets make computer pick a random number itself. For this we need to use \href{https://docs.python.org/3/library/random.html\#random.randint}{randint(a, b)}. It is a part of any Python distribution, so you would have it even if you would install a vanilla Python distribution instead of using one from PsychoPy. However, you cannot use it straightaway like you did with \texttt{print()} or \texttt{input()}. Type \texttt{randint(1,\ 3)} in your Jupyter Notebook and observe \emph{NameError: name `randint' is not defined}.

The reason for this is that Python has an awful lot of functions and loading them all at the same time would clog the memory with things you never intended to use. Instead, they are packaged into \emph{libraries}, so that you can import only functions (or libraries) that you actually need for your program. You \emph{import} them via an \texttt{import} statement that should go to the top of your file (but below the comment about the file content). There are several ways you can import libraries. First, you can import an \emph{entire} library (such as \emph{random} library that has function \texttt{randint()} that we need) and then use its functions as \texttt{\textless{}library\textgreater{}.\textless{}function\textgreater{}}. For \texttt{randint} this would be

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ random}

\NormalTok{computer\_pick }\OperatorTok{=}\NormalTok{ random.randint(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

I would suggest this as a preferred way of using libraries as it forces you to explicitly mention the name of the library when calling a function, i.e.~\texttt{random.randint()} instead of just \texttt{randint()}. This may not look important with just one imported library but even in a modestly-sized project you will import many libraries, so figuring out which library the function belongs to will be tricky. Even more importantly, different libraries may have functions with \emph{the same name}. In this case, the function you are using will come from the \emph{last} library you imported. But you may not realize this and this is a sort of mistake that is really hard to track down. Thus, unless you have a very good reason to do otherwise, always import the entire library and use \texttt{library.} notation!

Another and less explicit option is to import only \emph{some} functions and use them \emph{without} the \texttt{library.} prefix. You can import more than one function by listing them all

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ random }\ImportTok{import}\NormalTok{ randint, randrange}

\NormalTok{computer\_pick }\OperatorTok{=}\NormalTok{ randint(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

You can also \emph{rename} a library or a function while importing it via \texttt{as}. In short, you should not do this as using a different name for a library or a function would make it harder for others (and even for future-you) to understand your code. However, there are some ``standard'' renaming patterns that are used universally and which you are likely to encounter.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# this is a standard way to import these two libraries}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}

\NormalTok{np.}\BuiltInTok{abs}\NormalTok{(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)}

\CommentTok{\# you can rename individual functions as well, if you really have to (but, please, don\textquotesingle{}t!)}
\ImportTok{from}\NormalTok{ random }\ImportTok{import}\NormalTok{ randint }\ImportTok{as}\NormalTok{ random\_integer}

\NormalTok{computer\_pick }\OperatorTok{=}\NormalTok{ random\_integer(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Finally, there is a \textbf{very bad way} to import functions from a library: \texttt{from\ random\ import\ *}. The asterisk means that you want to import \emph{all} functions from the library and you want to call them by their names without \texttt{random.} prefix. Never, never, never\footnote{Did I already say never? never!} do this! This fills your environment with functions that you may not be aware of, potentially overwriting some other functions, creating conflicts, etc. Never ever! I am showing you this only because you will, at some point, see a code that uses this approach and you might think that this is a good idea. It is a terrible idea! Import the library, not the functions, so you can explicitly show which library you are relying on when calling a function. Always remember the \href{https://www.python.org/dev/peps/pep-0020/}{Zen of Python}: ``Explicit is better than implicit.''

\hypertarget{picking-a-number-randomly}{%
\section{Picking a number randomly}\label{picking-a-number-randomly}}

Now that you know how to import a library, we can use \href{https://docs.python.org/3/library/random.html\#random.randint}{randint()} function. For this, save a copy of your original code into \texttt{code02.py}. Import the library and use \href{https://docs.python.org/3/library/random.html\#random.randint}{randint()} to generate a random number between 1 and 10. Read the documentation on \href{https://docs.python.org/3/library/random.html\#random.randint}{randint()} to understand how to use it. Reading manuals is a necessary part of programming, so this is a good point to start practicing.

Once you implemented this in \texttt{code02.py}, run it several times to check that computer does pick different random values. Again, use breakpoints if you want to double-check what is going on.

Put your code into \texttt{code02.py}.

Congratulations, you just programmed your first computer game! Yes, it is very simple but it has key ingredients: a random decision by computer, a user input, and feedback. Next time, you will learn about loops to allow for multiple attempts and will start writing functions to make your code modular and reliable. In the meantime, let us solidify your knowledge by programming yet another game!

\hypertarget{one-armed-bandit-a-single-round-edition}{%
\section{One-armed bandit (a single round edition)}\label{one-armed-bandit-a-single-round-edition}}

You know everything you need to program a simple version of an ``one-armed bandit'' game. Here is the game logic:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Import random library, so you could use \texttt{randint} function
\item
  Generate three random integers (say, between 1 and 5) and store them in three variables \texttt{slot1}, \texttt{slot2}, and \texttt{slot3}.
\item
  Print out the numbers, use string formatting to make it look nice.
\item
  In addition,

  \begin{itemize}
  \tightlist
  \item
    if all three values are the same, print \texttt{"Three\ of\ a\ kind!"}.
  \item
    If only two numbers match, print \texttt{"Pair!"}.
  \item
    Do not print anyting, if all numbers are different.
  \end{itemize}
\end{enumerate}

Do not forget to document the new \texttt{code03.py} file and feel three to use breakpoints to debug it.

Put your code into \texttt{code03.py}.

\hypertarget{submitting-for-the-seminar}{%
\section{Submitting for the seminar}\label{submitting-for-the-seminar}}

For the seminar, submit a zipped folder with exercise notebook and all three programs.

\hypertarget{guess-the-number-multi-round}{%
\chapter{Guess the Number: a multi round edition}\label{guess-the-number-multi-round}}

In previous chapter, you programmed a single-attempt-only ``Guess the Number'' game. Now, we will expand to allow multiple attempts and will add other bells-and-whistles to make it more fun. Create a new subfolder and download the \href{notebooks/Seminar\%2003.\%20Guess\%20the\%20number\%20-\%20multi\%20round.ipynb}{exercise notebook} before we start!

\hypertarget{chapter-concepts-2}{%
\section{Chapter concepts}\label{chapter-concepts-2}}

\begin{itemize}
\tightlist
\item
  Repeating code using \protect\hyperlink{while-loop}{while} loop.
\item
  Making in \protect\hyperlink{break}{emergency exit} from a loop.
\end{itemize}

\hypertarget{while-loop}{%
\section{While loop}\label{while-loop}}

If you want to repeat something, you need to use loops. There are two types of loops: \href{https://docs.python.org/3/reference/compound_stmts.html\#the-while-statement}{while} loop, which is repeated \emph{while} a condition is true, and \href{https://docs.python.org/3/reference/compound_stmts.html\#the-for-statement}{for} loop that iterates over items (we will use it later).

The basic structure of a \emph{while} loop is

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# statements before the loop}

\ControlFlowTok{while} \OperatorTok{\textless{}}\NormalTok{condition}\OperatorTok{\textgreater{}}\NormalTok{:}
    \CommentTok{\# statements inside are executed}
    \CommentTok{\# repeatedly for as long as}
    \CommentTok{\# the condition is True}
    
\CommentTok{\# statements after the loop}
\end{Highlighting}
\end{Shaded}

The \texttt{\textless{}condition\textgreater{}} here is any expression that is evaluated to be either \texttt{True} or \texttt{False}, just like in an \texttt{if...elif...else} \protect\hyperlink{comparisons}{conditional statement}. Also, the same \protect\hyperlink{indentation}{indentations rules} determine which code is inside the loop and which outside.

Do exercise \#1.

Let us use \emph{while} loop to allow the player to keep guessing until they finally get it right. You can copy-paste the code you programmed during the last seminar or could redo it from scratch (I would strongly recommend you doing the latter!). The overall program structure should be the following

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# import random library so you can use randint function}

\CommentTok{\# generated a random number and store in number\_picked variable}
\CommentTok{\# get player input, convert it to an integer, and store in guess variable}

\CommentTok{\# while players guess is not equal to the value the computer picked:}
    \CommentTok{\# print out "my number is smaller" or "my number is larger" using if{-}else statement}
    \CommentTok{\# get player input, convert it to an integer, and store in guess variable}
    
\CommentTok{\# print "Spot on!" }
\CommentTok{\# (because if we got here that means guess is equal to the computer\textquotesingle{}s pick)}
\end{Highlighting}
\end{Shaded}

Put your code into \texttt{code01.py}.

Do not forget to document the file and use breakpoints and step overs to explore the program flow.

\hypertarget{counting-attempts}{%
\section{Counting attempts}\label{counting-attempts}}

Now let us add a variable that will count a total number of attempts by the player. For this, create a new variable (call it \texttt{attempts} or something similar) \emph{before the loop} and initialize it \texttt{1}. Add \texttt{1} to it every time the player enters a guess. After the loop, expand the \texttt{"Spot\ on!"} message by adding information about the number of attempts. Use \protect\hyperlink{ux5cux23string-formatting}{string formatting} to make things look nice, e.g., \texttt{"Spot\ on,\ and\ you\ needed\ just\ 5\ attempts!"}. Check that the number of attempts your required \emph{matches} the number of attempts reported by the program!

Put your code into \texttt{code02.py}.

\hypertarget{break}{%
\section{Breaking (and exiting)}\label{break}}

Code inside the \emph{while} loop is executed repeatedly while the condition is \texttt{True} and, importantly, all of code the inside is executed before the condition is evaluated again. However, sometimes you may need to abort sooner without executing the remaining code. For this, Python has a \href{https://docs.python.org/3/tutorial/controlflow.html\#break-and-continue-statements-and-else-clauses-on-loops}{break} statement that causes the program to exit the loop immediately without executing the rest of the code inside the loop, so that the program continues with the code \emph{after} the loop.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# this code runs before the loop}

\ControlFlowTok{while} \OperatorTok{\textless{}}\NormalTok{somecondition}\OperatorTok{\textgreater{}}\NormalTok{:}
  \CommentTok{\# this code runs on every iteration}
  
    \ControlFlowTok{if} \OperatorTok{\textless{}}\NormalTok{someothercondition}\OperatorTok{\textgreater{}}\NormalTok{:}
        \ControlFlowTok{break}
  
  \CommentTok{\# this code runs on every iteration but not when you break out of the loop}

\CommentTok{\# this code runs after the loop}
\end{Highlighting}
\end{Shaded}

Do exercise \#2 to build your intuition.

\hypertarget{limiting-number-of-attempts-via-break}{%
\section{Limiting number of attempts via break}\label{limiting-number-of-attempts-via-break}}

Let's put the player under some pressure! Decide on maximal number of attempts you allow and stores it as a \protect\hyperlink{constants}{CONSTANT}. Pick an appropriate name (e.g.~\texttt{MAX\_ATTEMPTS}) and REMEMBER, ALL CAPITAL LETTERS for a constant name! Now, use \texttt{break} to quit the \texttt{while} loop, if the current attempt number is greater than \texttt{MAX\_ATTEMPTS}. Think about when (within the code inside the loop) you should check this.

Put your code into \texttt{code03.py}.

\hypertarget{correct-end-of-game-message}{%
\section{Correct end-of-game message}\label{correct-end-of-game-message}}

Let us update the final message. Currently it says ``Spot on\ldots{}'' because we assumed that program exited the loop only if the player gave a correct answer. With limited attempts that is not necessarily the case. Now there are two reasons why it exited the while loop:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The player answered correctly
\item
  The player ran out of attempts.
\end{enumerate}

Use \texttt{if-else} conditional statement to print out an appropriate message. E.g., print \texttt{"Better\ luck\ next\ time!}, if the player lost (ran out of attempts).

Put your code into \texttt{code04.py}.

\hypertarget{limiting-number-of-attempts-without-a-break}{%
\section{Limiting number of attempts without a break}\label{limiting-number-of-attempts-without-a-break}}

Although it was my idea to add the \texttt{break} statement, you should use it sparingly. Without \texttt{break} there is a \emph{single} place in the code that you need to check to understand when the program will exit the loop: the condition. However, if you add a \texttt{break}, you now have \emph{two} places that need to be examined. And every additional \texttt{break} keeps adding to that. This does not mean that you should avoid them at all costs! You \emph{should} use them, if this makes the code easier to understand. But always check if a modified condition could also do the trick.

Let us try exactly that. Modify your code to work \emph{without} the \texttt{break} statement. You need a more complicated condition for your while loop. so that it repeats while player's guess is incorrect and the number of attempts is still less than the maximally allowed. Test that your code works both when you win and when you lose.

Put your code into \texttt{code05.py}.

\hypertarget{show-remaining-attempts}{%
\section{Show remaining attempts}\label{show-remaining-attempts}}

It is all about a user interface! Modify the \texttt{input} prompt message to include a number of \emph{remaining} attempts. E.g. \texttt{"Please\ enter\ the\ guess,\ you\ have\ X\ attempts\ remaining"}.

Put your code into \texttt{code06.py}.

\hypertarget{guess-the-number-repeat-game}{%
\section{Repeating the game}\label{guess-the-number-repeat-game}}

Let us give an option for the player to play again. This means putting \emph{all} the current code inside of another \texttt{while} loop (this is called \emph{nested loops}) that is repeated for as long as the player wants to keep playing. The code should look following:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# import random library so you can use randint function}

\CommentTok{\# define MAX\_ATTEMPTS}

\CommentTok{\# define a variable called "want\_to\_play" and set to True}
\CommentTok{\# while the player still wants to play}
  
  \CommentTok{\# your current working game code goes here}
  
  \CommentTok{\# ask user whether via input function. E.g. "Want to play again? Y/N"}
  \CommentTok{\# want\_to\_play should be True if user input is equal to "Y" or "y"}
  
\CommentTok{\# very final message, e.g. "Thank you for playing the game!"}
\end{Highlighting}
\end{Shaded}

\textbf{Pay extra attention to indentations to group the code properly!}

Put your code into \texttt{code07.py}.

\hypertarget{you-do-not-need-a-comparison-if-you-already-have-the-value}{%
\section{You do not need a comparison, if you already have the value}\label{you-do-not-need-a-comparison-if-you-already-have-the-value}}

In your updated code, you have \texttt{want\_to\_play} variable that is either \texttt{True} or \texttt{False}. It is used in the loop that repeats while its value is \texttt{True}. Sometimes, people write \texttt{want\_to\_play\ ==\ True} to express that. While it is technically correct and will certaintly work correctly, it is also redundant. Since \texttt{want\_to\_play} can only be \texttt{True} or \texttt{False} this comparison turns into \texttt{True\ ==\ True} (which is of course \texttt{True}) or \texttt{False\ ==\ True} (which is \texttt{False}). So comparing either value to \texttt{True} produces exactly the same value. Thus, you can just write \texttt{while\ want\_to\_play:} and use the logical value directly.

\hypertarget{best-score}{%
\section{Best score}\label{best-score}}

A ``proper'' game typically keeps the track of players' performance. Let us record a fewest number of attempts that the player needed to guess the number. For this, create a new variable \texttt{fewest\_attempts} and set it to \texttt{MAX\_ATTEMPTS} (this is as bad as the player can be). Think, where do you need to create it. You should update it after each game round. Add the information about ``Best so far'' into the round-over message.

Put your code into \texttt{code08.py}.

\hypertarget{counting-game-rounds}{%
\section{Counting game rounds}\label{counting-game-rounds}}

Let us count how many rounds the player played. The idea and implementation is the same as with counting the attempts. Create a new variable, initialize it to 0, increment by 1 whenever a new round starts. Include the total number of rounds into the very final message, e.g.~``Thank you for playing the game \emph{X} times!''

Put your code into \texttt{code09.py}.

\hypertarget{wrap-up}{%
\section{Wrap up}\label{wrap-up}}

Most excellent, you now have a proper working computer game with game rounds, limited attempts, best score, and what not! Zip the folder and submit.

\hypertarget{guess-the-number-ai}{%
\chapter{Guess the Number: AI takes a turn}\label{guess-the-number-ai}}

Let us program Guess the Number game again\footnote{This is the last time, I promise!} but \emph{reverse} the roles. Now \emph{you} will pick a number and the computer will guess. Think about the algorithm that a computer could use for this before reading the next paragraph\footnote{You should imagine Dora the Explorer staring at you while you think.}.

The optimal way to do this is to use the middle of the interval for a guess. This way you rule out \emph{half} the numbers that are either greater or smaller than your guess (or you guess the number correctly, of course). So, if you know that the number is between 1 and 10, you should split things in the middle, that is picking 5 or 6, as you cannot pick 5.5 (we assume that you can use only integers). If your opponent tells that their number is greater than your pick, you know that it must be somewhere between your guess and the original upper limit, e.g., between 5 and 10. Conversely, if the opponent responds ``lower'', the number is the lower limit and you guess, e.g., between 1 and 5. On your next attempt, you pick split the interval again until you either guess the number correctly or end up with an interval that contains just one number. Then you do not need to guess anymore.

To implement this program, you will need to learn about functions, how to document them like a pro, and how to use your own libraries. Grab the \href{notebooks/05.\%20Guess\%20the\%20number\%20-\%20AI.ipynb}{exercise notebook} before we start!

\hypertarget{chapter-concepts.}{%
\section{Chapter concepts.}\label{chapter-concepts.}}

\begin{itemize}
\tightlist
\item
  Writing you own \protect\hyperlink{function}{functions}.
\item
  Understanding variable \protect\hyperlink{scopes-for-immutable-values}{scopes}.
\item
  Adopting \protect\hyperlink{numpy-docstring}{standard ways} to document your code.
\item
  Using your \protect\hyperlink{using-you-own-libraries}{own libraries}.
\end{itemize}

\hypertarget{guess-the-number-players-response}{%
\section{Player's response}\label{guess-the-number-players-response}}

Let us warm up by writing a code that will allow a player to respond to computer's guess. Recall that there are just three options: your number is greater, smaller, or equal to a computer's guess. I would suggest using, respectively, \texttt{\textgreater{}}, \texttt{\textless{}}, and \texttt{=} symbols to communicate this. You need to write the code that will prompt a player for their response until they enter one of these symbols. I.e., the prompt should be repeatedly repeated if they enter anything else. Thus, you definitely need to use the \href{https://docs.python.org/3/library/functions.html\#input}{input({[}prompt{]})} and a \protect\hyperlink{while-loop}{while} loop. Think of a useful and informative prompt message for this. Test that it works. Using breakpoints might be very useful here.

Put your code into \texttt{code01.py}.

\hypertarget{function}{%
\section{Functions}\label{function}}

You already now how to use function, now it is turn for you to learn more about why you should care. The purpose of a function is to isolate certain code that performs a single computation making it testable and reusable. Let us go through the first sentence bit by bit using examples.

\hypertarget{function-performs-a-single-computation}{%
\subsection{Function performs a single computation}\label{function-performs-a-single-computation}}

I already \protect\hyperlink{programming-tips}{told you} that reading code is easy because every action has to be spelled-out for computers in a simple and clear way. However, \emph{a lot} of simple things can be very overwhelming and confusing. Think about the final code for the previous seminar: we had two loops with conditional statements nested inside. Add a few more of those and you have so many branches to trace, you never be quite sure what will happen. This is because our cognition and working memory, which you use to trace all branches, are limited to just about four items\footnote{The official magic number is \href{https://en.wikipedia.org/wiki/The_Magical_Number_Seven,_Plus_or_Minus_Two}{7±2} but reading the original paper tells you that this is more like four for most of us}.

Thus, a function should perform \emph{one} computation / action that is conceptually clear and those purpose should be understood directly from its name or, at most, from a single sentence that describes it\footnote{This is similar to scientific writing, where a single paragraph conveys a single idea. For me, it helps to first write the idea of the paragraph in a single sentence before writing the paragraph itself. If one sentence is not enough, I need to split the text into more paragraphs.}. The name of a function should typically be a \emph{verb} because function is about doing an action. If you need more than once sentence to explain what function does, you should consider splitting the code further. This does not mean that entire description / documentation must fit into a single sentence. The full description can be lengthy, particularly if underlying computation is complex and there are many parameters to consider. However, these are optional details that tell the reader \emph{how} the function is doing its job or how the its behavior can be modified. Still, they should be able to understand \emph{what} the job is just from the name or from a single sentence. I am repeating myself and stressing this so much because conceptually simple single-job functions are a foundation of a clear robust reusable code. And future-you will be very grateful that it has to work with easy-to-understand isolated reliable code you wrote.

\hypertarget{function-isolates-code-from-the-rest-of-the-program}{%
\subsection{Function isolates code from the rest of the program}\label{function-isolates-code-from-the-rest-of-the-program}}

Isolation means that your code runs in a separate scope where the only things that exist are function arguments (limited number of values you pass to it from outside with fixed meaning) and local variables that you define inside the function. You have no access to variables defined in the outside script\footnote{This is not strictly true but that will concern us only once we get to so-called ``mutable'' objects like lists or dictionaries.} or to variables defined inside of other functions. Conversely, neither global script nor other functions have access to variables and values that you use inside. This means that you only need to study the code \emph{inside} the function to understand how it works. Accordingly, when you write the code it should be \emph{independent} of any global context the function can be used in. The isolation is both practical (no run-time access to variables from outside means fewer chance that things go terribly wrong) and conceptual (no further context is required to understand the code).

\hypertarget{function-makes-code-easier-to-test}{%
\subsection{Function makes code easier to test}\label{function-makes-code-easier-to-test}}

You can build even moderately complex programs only if you can be certain what individual chunks of code are doing under every possible condition. Do they produce the correct results? Do the fail clearly and raise a correct error, if the inputs are wrong? Do they use defaults when required? However, testing all chunks together means running extreme number of runs as you need to test all possible combinations of conditions for one chunk given all possible conditions for other chunk, etc. Functions make your life much easier. Because they have a single point of entry, fixed number of parameters, a single return value, and are isolated (see above), you can test them one at a time independent of other functions of the rest of the code. This is called \emph{unit testing} and it is heavy use of \href{https://docs.python.org/3/library/unittest.html}{automatic unit testing}\footnote{it is normal to have more code devoted to testing than to the actual program} that ensures reliable code for absolute majority of programs and apps that you use\footnote{You still need tests for the integrated system but testing individual functions is a clear prerequisite.}.

\hypertarget{function-makes-code-reusable}{%
\subsection{Function makes code reusable}\label{function-makes-code-reusable}}

Sometimes, this is given as a primary reason to use functions. Turning code into a function means that you can call the function instead of copy-pasting the code. The latter approach is a terrible idea as it means that you have to maintain the same code at many places and you might not be even sure in just how many. This is a problem even if a code is extremely simple. Here, we define a \emph{standard} way to compute an initial by taking the first symbol from a string (you will learn about indexing and slicing in details later). The code is as simple as it gets.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{...}
\NormalTok{initial }\OperatorTok{=} \StringTok{"test"}\NormalTok{[}\DecValTok{0}\NormalTok{]}
\NormalTok{...}
\NormalTok{initial\_for\_file }\OperatorTok{=}\NormalTok{ filename[}\DecValTok{0}\NormalTok{]}
\NormalTok{...}
\NormalTok{initial\_for\_website }\OperatorTok{=}\NormalTok{ first\_name[}\DecValTok{0}\NormalTok{]}
\NormalTok{...}
\end{Highlighting}
\end{Shaded}

Imagine that you decided to change it and use first \emph{two} symbols. Again, the computation is not complicated, use just replace \texttt{{[}0{]}} with \texttt{{[}:2{]}}. But you have to do it for \emph{all} the code that does this computation. And you cannot use \emph{Replace All} option because sometimes you might use the first element for some other purposes. And when you edit the code, you are bound to forget about some locations (I do it all the time) making things even less consistent and more confusing. Turning code into a function means you need to modify and test at just \emph{one} location. Here is the original code implemented via a function.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ generate\_initial(full\_string):}
    \CommentTok{"""Generates an initial using first symbol.}
\CommentTok{    }
\CommentTok{    Parameters}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    full\_string : str}
\CommentTok{    }
\CommentTok{    Returns}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    str : single symbol}
\CommentTok{    """}
    \ControlFlowTok{return}\NormalTok{ full\_string[}\DecValTok{0}\NormalTok{]}

\NormalTok{...}
\NormalTok{initial }\OperatorTok{=}\NormalTok{ generate\_initial(}\StringTok{"test"}\NormalTok{)}
\NormalTok{...}
\NormalTok{initial\_for\_file }\OperatorTok{=}\NormalTok{ generate\_initial(filename)}
\NormalTok{...}
\NormalTok{initial\_for\_website }\OperatorTok{=}\NormalTok{ generate\_initial(first\_name)}
\NormalTok{...}
\end{Highlighting}
\end{Shaded}

and here is the ``alternative'' initial computation. Note that the code that uses the function \emph{stays the same}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ generate\_initial(full\_string):}
    \CommentTok{"""Generates an initial using first TWO symbols.}
\CommentTok{    }
\CommentTok{    Parameters}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    full\_string : str}
\CommentTok{    }
\CommentTok{    Returns}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    str : two symbols long}
\CommentTok{    """}
    \ControlFlowTok{return}\NormalTok{ full\_string[:}\DecValTok{2}\NormalTok{]}

\NormalTok{...}
\NormalTok{initial }\OperatorTok{=}\NormalTok{ generate\_initial(}\StringTok{"test"}\NormalTok{)}
\NormalTok{...}
\NormalTok{initial\_for\_file }\OperatorTok{=}\NormalTok{ generate\_initial(filename)}
\NormalTok{...}
\NormalTok{initial\_for\_website }\OperatorTok{=}\NormalTok{ generate\_initial(first\_name)}
\NormalTok{...}
\end{Highlighting}
\end{Shaded}

Thus, turning the code into function is particularly useful when the reused code is complex but it pays off even if computation is as simple and trivial as in example above. With a function you have a single code chunk to worry about and you can be sure that the same computation is performed whenever you call the function (and that these are not several copies of the code that might or might not be identical).

Note that I put reusable code as the last and the least reason to use functions. This is because the other three reasons are far more important. Having a conceptually clear isolated and testable code is advantageous even if you call this function only once. It still makes code easier to understand and to test and helps you to reduce its complexity by replacing chunks of code with its meaning. Take a look at the example below. The first code takes the first symbol but this action (taking the first symbol) does not \emph{mean} anything by itself, it is just a mechanical computation. It is only the original context \texttt{initial\_for\_file\ =\ filename{[}0{]}} or additional comments that give it its meaning. In contrast, calling a function called \emph{compute\_initial} tells you what is happening, as it disambiguates the purpose. I suspect that future-you is very pro-disambiguation and anti-confusion.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ filename[}\DecValTok{0}\NormalTok{] }\OperatorTok{==} \StringTok{"A"}\NormalTok{:}
\NormalTok{    ...}
    
\ControlFlowTok{if}\NormalTok{ compute\_initial(filename) }\OperatorTok{==} \StringTok{"A"}\NormalTok{:}
\NormalTok{    ...}
\end{Highlighting}
\end{Shaded}

\hypertarget{functions-in-python}{%
\section{Functions in Python}\label{functions-in-python}}

\hypertarget{defining-a-function-in-python}{%
\subsection{Defining a function in Python}\label{defining-a-function-in-python}}

A function in Python looks like this (note the indentation and \texttt{:} at the end of the first line)

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \OperatorTok{\textless{}}\NormalTok{function name}\OperatorTok{\textgreater{}}\NormalTok{(param1, param2, ...):}
\NormalTok{    some internal computation}
    \ControlFlowTok{if}\NormalTok{ somecondition:}
        \ControlFlowTok{return}\NormalTok{ some value}
    \ControlFlowTok{return}\NormalTok{ some other value}
\end{Highlighting}
\end{Shaded}

The parameters are optional, so is the return value. Thus the minimal function would be

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ minimal\_function():}
    \ControlFlowTok{pass} \CommentTok{\# pass means "do nothing"}
\end{Highlighting}
\end{Shaded}

You must define your function (once!) before calling it (one or more times). Thus, you should create functions \emph{before} the code that uses it.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ do\_something():}
    \CommentTok{"""}
\CommentTok{    This is a function called "do\_something". It actually does nothing.}
\CommentTok{    It requires no input and returns no value.}
\CommentTok{    """}
    \ControlFlowTok{return}
    
\KeywordTok{def}\NormalTok{ another\_function():}
\NormalTok{    ...}
    \CommentTok{\# We call it in another function.}
\NormalTok{    do\_something()}
\NormalTok{    ...}

\CommentTok{\# This is a function call (we use this function)}
\NormalTok{do\_something()}

\CommentTok{\# And we use it again!}
\NormalTok{do\_something()}

\CommentTok{\# And again but via another\_function call}
\NormalTok{another\_function()}
\end{Highlighting}
\end{Shaded}

Do exercise \#1.

You must also keep in mind that redefining a function (or defining a technically different function that has the same name) overwrites the original definition, so that only the \emph{latest} version of it is retained and can be used.

Do exercise \#2.

Although example in the exercise makes the problem easy to spot, in a large code that spans multiple files and uses various libraries, solving the same problem may not be so straightforward!

\hypertarget{function-arguments}{%
\subsection{Function arguments}\label{function-arguments}}

Some function may not need arguments (also called parameters), as they perform a fixed action:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ ping():}
    \CommentTok{"""}
\CommentTok{    Machine that goes "ping!"}
\CommentTok{    """}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"ping!"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

However, you may need to pass information to the function via arguments in order to influence how the function performs its action. In Python, you simply list arguments within the round brackets after the function name (there are more bells and whistles but we will keep it simple for now). For example, we could write a function that computes and prints person's age given two parameters 1) their birth year, 2) current year:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ print\_age(birth\_year, current\_year):}
    \CommentTok{"""}
\CommentTok{    Prints age given birth year and current year.}
\CommentTok{    }
\CommentTok{    Parameters}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    birth\_year : int}
\CommentTok{    current\_year : int}
\CommentTok{    """}
    \BuiltInTok{print}\NormalTok{(current\_year }\OperatorTok{{-}}\NormalTok{ birth\_year)}
\end{Highlighting}
\end{Shaded}

It is a \textbf{very good idea} to give meaningful names to functions, parameters, and variables. The following code will produce exactly the same result but understanding \emph{why} and \emph{what for} it is doing what it is doing would be much harder (so \textbf{always} use meaningful names!):

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ x(a, b):}
    \BuiltInTok{print}\NormalTok{(b }\OperatorTok{{-}}\NormalTok{ a)}
\end{Highlighting}
\end{Shaded}

When calling a function, you must pass the correct number of parameters and pass them in a \emph{correct order}, another reason for a function arguments to have meaningful names\footnote{Again, this not strictly true but you will have to wait until you learn about named parameters and default values}.

Do exercise \#3.

When you call a function, values you \emph{pass} to the function are assigned to the parameters and they are used as \emph{local} variables (more on \emph{local} bit later). However, it does not matter \emph{how} you came up with this values, whether they were in a variable, hard-coded, or returned by another function. If you are using numeric, logical, or string values (\emph{immutable} types), you can assume that any link to the original variable or function that produced it is gone (we'll deal with \emph{mutable} types, like lists, later). Thus, when writing a function or reading its code, you just assume that it has been set to some value during the call and you can ignore the context in which this call was made

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# hardcoded}
\NormalTok{print\_age(}\DecValTok{1976}\NormalTok{, }\DecValTok{2020}\NormalTok{)}

\CommentTok{\# using values from variables}
\NormalTok{i\_was\_born }\OperatorTok{=} \DecValTok{1976}
\NormalTok{today\_is }\OperatorTok{=} \DecValTok{2020}
\NormalTok{print\_age(i\_was\_born, today\_is)}

\CommentTok{\# using value from a function}
\KeywordTok{def}\NormalTok{ get\_current\_year():}
    \ControlFlowTok{return} \DecValTok{2020}

\NormalTok{print\_age(}\DecValTok{1976}\NormalTok{, get\_current\_year())}
\end{Highlighting}
\end{Shaded}

\hypertarget{functions-returned-value-output}{%
\subsection{Functions' returned value (output)}\label{functions-returned-value-output}}

Your function may perform an action without returning any value to the caller (this is what out \texttt{print\_age} function was doing). However, you may need to return the value instead. For example, to make things more general, we might want write a new function called \texttt{compute\_age} that returns the age instead of printing it (we can always print it ourselves).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ compute\_age(birth\_year, current\_year):}
    \CommentTok{"""}
\CommentTok{    Computes age given birth year and current year.}

\CommentTok{    Parameters}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    birth\_year : int}
\CommentTok{    current\_year : int}
\CommentTok{    }
\CommentTok{    Returns}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    int : age}
\CommentTok{    """}
    \ControlFlowTok{return}\NormalTok{ current\_year }\OperatorTok{{-}}\NormalTok{ birth\_year}
\end{Highlighting}
\end{Shaded}

Note that even if a function returns the value, it is retained only if it is actually used (stored in a variable, used as a value, etc.). Thus, just calling it will not by itself store the returned value anywhere!

Do exercise \#4.

\hypertarget{scopes-for-immutable-values}{%
\subsection{Scopes (for immutable values)}\label{scopes-for-immutable-values}}

As we have discussed above, turning code into a function \emph{isolates} it, so makes it run in it own \emph{scope}. In Python, each variable exists in the \emph{scope} it has been defined in. If it was defined in the \emph{global} script, it exists in that \emph{global} scope as a \emph{global} variable. However, it is not accessible (at least not without special effort via a \texttt{global} operator) from within a function. Conversely, function's parameters and any variables defined \emph{inside a function}, exists and are accessible only \textbf{inside that function}. It is fully invisible for the outside world and cannot be accessed from a global script or from another function. Conversely, any changes you make to the function parameter or local variable have no effect on the outside world\footnote{Again, almost, as \emph{mutable} objects like lists are more complicated, more on that later}.

The purpose of scopes is to isolate individual code segments from each other, so that modifying variables within one scope has no effect on all other scopes. This means that when writing or debugging the code, you do not need to worry about code in other scopes and concentrate only on the code you working on. Because scopes are isolated, they may have \emph{identically named variables} that, however, have no relationship to each other as they exists in their own parallel universes. Thus, if you want to know which value a variable has, you must look only within the scope and ignore all other scopes (even if the names match!).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# this is variable \textasciigrave{}x\textasciigrave{} in the global scope}
\NormalTok{x  }\OperatorTok{=} \DecValTok{5} 

\KeywordTok{def}\NormalTok{ f1():}
  \CommentTok{\# This is variable \textasciigrave{}x\textasciigrave{} in the scope of function f1}
  \CommentTok{\# It has the same name as the global variable but}
  \CommentTok{\# has no relation to it: many people are called Sasha }
  \CommentTok{\# but they are still different people. Whatever you}
  \CommentTok{\# happens to \textasciigrave{}x\textasciigrave{} in f1, stays in f1\textquotesingle{}s scope.}
\NormalTok{  x }\OperatorTok{=} \DecValTok{3}
  
  
\KeywordTok{def}\NormalTok{ f2(x):}
  \CommentTok{\# This is parameter \textasciigrave{}x\textasciigrave{} in the scope of function f2.}
  \CommentTok{\# Again, no relation to other global or local variables.}
  \CommentTok{\# It is a completely separate object, it just happens to }
  \CommentTok{\# have the same name (again, just namesakes)}
  \BuiltInTok{print}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

Do exercise \#5.

\hypertarget{players-response-as-a-function}{%
\section{Player's response as a function}\label{players-response-as-a-function}}

Let us put all that theory about functions into practice. Use the code that you created to acquire \protect\hyperlink{guess-the-number-players-response}{player's response} and turn it into function. I suggest that you call it \texttt{input\_response} (or something along these lines). Test that the code works by calling this function for the main script.

Put your code into \texttt{code02.py}.

\hypertarget{debugging-a-function}{%
\section{Debugging a function}\label{debugging-a-function}}

Now that we have your first function, you can make sense of three step over/in/out buttons that the debugger offers you. Copy-paste the following code in a separate file (call it \texttt{test01.py}, for example).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ f1(x, y):}
  \ControlFlowTok{return}\NormalTok{ x }\OperatorTok{/}\NormalTok{ y}
  
\KeywordTok{def}\NormalTok{ f2(x, y):}
\NormalTok{  x }\OperatorTok{=}\NormalTok{ x }\OperatorTok{+} \DecValTok{5}
\NormalTok{  y }\OperatorTok{=}\NormalTok{ y }\OperatorTok{*} \DecValTok{2}
  \ControlFlowTok{return}\NormalTok{ f1(x, y)}
  
\NormalTok{z }\OperatorTok{=}\NormalTok{ f2(}\DecValTok{4}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(z)}
\end{Highlighting}
\end{Shaded}

First, put a break point on the line in the main script that calls function \texttt{f2()}. Run the debugger via \textbf{F5} and the program will pause at that line. If you now press \textbf{F10} (step over), the program will go to the next line \texttt{print(z)}. However, if you are to press \textbf{F11} (step into) instead, the program will \emph{step into} the function and go to \texttt{x\ =\ x\ +\ 5} line. When inside the function, you have the same two choices we just looked at but also, you can press \textbf{Shift+F11} to step out of the function. Here, the program will run all the code until you reach the next line \emph{outside} of the function (you should end up at \texttt{print(z)} again). Experiment with putting breakpoints at various lines and stepping over/in/out to get a hang of these useful debugging tools.

Now, put the breakpoint inside of \texttt{f1()} function and run the code via \textbf{F5}. Take a look at the left pane, you will see a \emph{Call Stack} tab. While yellow highlighted line in the editor shows you where you currently are (should be inside the \texttt{f1()} function), the \emph{Call Stack} shows you how did you get where. In this case it should show:

\begin{longtable}[]{@{}lll@{}}
\toprule
\endhead
f1 & test01.py & 2:1 \\
f2 & test01.py & 7:1 \\
\textless module\textgreater{} & test01.py & 9:1 \\
\bottomrule
\end{longtable}

The calls are stacked from bottom to top, so this means that a function was called in the main module in line 9, you ended up in function \texttt{f2} in line 7, and then in function \texttt{f1} and in line 2. Experiment with stepping in and out of functions while keeping an eye on this. You might not need this information frequently but could be useful in out later projects with multiple nested function calls.

\hypertarget{numpy-docstring}{%
\section{Documenting your function}\label{numpy-docstring}}

Writing a function is only half the job. You need to document it! \protect\hyperlink{programming-tips}{Remember}, this is a good habit that makes your code easy to use and reuse. There are different ways to document the code but we will use \href{https://numpydoc.readthedocs.io/en/latest/format.html\#docstring-standard}{NumPy docstring convention}. Here is an example of such documented function

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ generate\_initial(full\_string):}
    \CommentTok{"""Generates an initial using first symbol.}
\CommentTok{    }
\CommentTok{    Parameters}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    full\_string : str}
\CommentTok{    }
\CommentTok{    Returns}
\CommentTok{    {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{    str : single symbol}
\CommentTok{    """}
    \ControlFlowTok{return}\NormalTok{ full\_string[}\DecValTok{0}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

Take the look at the \href{https://numpydoc.readthedocs.io/en/latest/format.html\#docstring-standard}{manual} and document the \texttt{input\_response} function. You will not need the \texttt{Parameters} section as it currently accepts no inputs.

Update your code in \texttt{code02.py}.

\hypertarget{using-prompt}{%
\section{Using prompt}\label{using-prompt}}

In the future, we will be asking about a specific number that is a current guess by the computer, thus we cannot use a fixed prompt message. Modify the \texttt{input\_response} function by adding a \texttt{guess} parameter. Then, modify the prompt that you used for the \href{https://docs.python.org/3/library/functions.html\#input}{input()} to include that number. Update functions' documentation. Test it by calling with different values for the \texttt{guess} parameter.

Put your code into \texttt{code03.py}.

\hypertarget{splitting-interval-in-the-middle}{%
\section{Splitting interval in the middle}\label{splitting-interval-in-the-middle}}

Let us practice writing functions a bit more. Recall that the computer should use the middle of the interval as a guess. Create a function (let us call it \texttt{split\_interval()} or something like that) that takes two parameters --- \texttt{lower\_limit} and \texttt{upper\_limit} --- and returns \emph{an integer} that is closest to the middle of the interval. The only tricky part is how you convert a potentially float number (e.g, when you are trying to find it for the interval 1..10) to an integer. You can use function \href{https://docs.python.org/3/library/functions.html\#int}{int()} for that. However, read the documentation carefully, as it \emph{does not} perform a proper rounding (what does it do? read the docs!). Thus, you should \href{https://docs.python.org/3/library/functions.html\#round}{round()} the number to the closest integer before converting it.

Write a function, document it, and test it by checking that numbers are correct.

Put you \texttt{split\_interval()} function and the testing code into \texttt{code04.py}.

\hypertarget{single-round}{%
\section{Single round}\label{single-round}}

You have both functions that you need, so let us write the code to initialize the game and play a single round. The initialization boils down to creating two variables that correspond to the lower and upper limits of the game range (we used 1 to 10 so far, but you can always change that). Next, the computer should generate a guess (you have your \texttt{split\_interval()} function for that) and ask the player about the guess (that is the \texttt{input\_response()} function). Once you have the response (stored in a separate variable, think of the name yourself), you can update your upper or lower limit using an \protect\hyperlink{if-statement}{if..elif..else} statement. Print out a joyous message, if computer's guess was correct.

Put both functions and the script code into \texttt{code05.py}.

\hypertarget{multiple-rounds}{%
\section{Multiple rounds}\label{multiple-rounds}}

Extend the game, so that the computer keeps guessing until it finally wins. You already know how to use the \protect\hyperlink{while-loop}{while} loop, just think how you can use participant's response as a loop condition variable. Also, think about the initial value of that variable and how to use it so you call \texttt{input\_response()} only at one location.

Put the updated code into \texttt{code06.py}.

\hypertarget{playing-again}{%
\section{Playing again}\label{playing-again}}

Modify the code, so that you can play this game several times. You already know how to do this and the only thing you need to consider is where exactly should you perform initialization before each round. As you already implemented that for the last game, you might be tempted to look how you did it or, even, copy-paste the code. However, I would recommend writing it from scratch. Remember, your aim is not to write a program but to learn how to do this and, therefore, the journey is more important than a destination.

Put the updated code into \texttt{code07.py}.

\hypertarget{best-score-1}{%
\section{Best score}\label{best-score-1}}

Add the code to count the number of attempts that the computer required in each round and
report the best score (fewest number of attempts) after the game is over. You will need one variable to count the number of attempts and one to keep the best score. Again, try writing it without looking at your previous game.

Put the updated code into \texttt{code08.py}.

\hypertarget{using-you-own-libraries}{%
\section{Using you own libraries}\label{using-you-own-libraries}}

You already know how to \protect\hyperlink{using-libraries}{use existing libraries} but you can also create and use your own. Take the two functions that you developed and put them into a new file called \texttt{utils.py} (do not forget to put a multiline comment at the top of the file to remind you what is inside!) . Copy the remaining code (the global script) into \texttt{code09.py}. It will not work in its current state as it won't find the two functions (try it to see the error message), so you need to import from your own \texttt{utils} module. Importing works exactly the same way as for other libraries. Note that even though your file is \texttt{utils.py}, the module name is \texttt{utils} (without the extension).

Put function into \texttt{utils.py}, the remaining code into \texttt{code09.py}.

\hypertarget{keep-imports-tidy}{%
\section{Ordnung muss sein!}\label{keep-imports-tidy}}

So far, you only imported one library at most. However, as Python is highly modular, it is very common to have many imports in a single file. There are several rules that make it easier to track the imports. When you import libraries, all import statements should be at the top of your file and you should avoid putting them in random order. The recommended order is 1) system libraries, like \texttt{os} or \texttt{random}; 2) third-party libraries, like \texttt{psychopy}; 3) your project modules . And, within each section you should put the libraries \emph{alphabetically}, so

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ os}
\ImportTok{import}\NormalTok{ random}
\end{Highlighting}
\end{Shaded}

This may not look particularly useful for our simple code but as your projects will grow, you will need to include more and more libraries. Keeping them in that order makes it easy to understand which libraries you use and which are non-standard. Alphabetic order means that you can quickly check whether a library is included, as you can quickly find the location where its import statement should appear.

\hypertarget{putting-video-into-videogames}{%
\section{Putting video into videogames}\label{putting-video-into-videogames}}

Submit your files and be ready for more excitement as we are moving onto ``proper'' videogames with PsychoPy.

\hypertarget{psychopy-basics}{%
\chapter{Gettings started with PsychoPy}\label{psychopy-basics}}

Before we program our first game using \href{https://psychopy.org/}{PsychoPy}, we need to spend some time figuring out its basics. It is not the most suitable library for writing games, for that you might want to use \href{https://arcade.academy/}{Python Arcade} or \href{https://www.pygame.org/}{PyGame}. However, it is currently the best Python library for developing psychophysical experiments (and this is what we are after).

\hypertarget{chapter-concepts-3}{%
\section{Chapter concepts}\label{chapter-concepts-3}}

\begin{itemize}
\tightlist
\item
  Understanding how to use \protect\hyperlink{classes-and-objects}{classes and objects}.
\item
  Using \protect\hyperlink{arguments-by-position-or-name}{named parameters} in functions.
\item
  Understanding PsychoPy \protect\hyperlink{psychopy-units}{units system}.
\item
  Using basic Psycho \protect\hyperlink{adding-text-message}{visual stimuli} and handling \protect\hyperlink{make-the-square-jump-on-your-command}{user inputs}.
\end{itemize}

\hypertarget{minimal-psychopy}{%
\section{Minimal PsychoPy code}\label{minimal-psychopy}}

Copy-paste the following code into \texttt{code01.py} file (you did remember to create a new folder for the chapter?):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{"""}
\CommentTok{A minimal PsychoPy code.}
\CommentTok{"""}

\CommentTok{\# this imports two modules from psychopy}
\CommentTok{\# visual has all the visual stimuli, including the Window class}
\CommentTok{\# that we need to create a program window}
\CommentTok{\# event has function for working with mouse and keyboard}
\ImportTok{from}\NormalTok{ psychopy }\ImportTok{import}\NormalTok{ visual, event}

\CommentTok{\# creating a 800 x 600 window}
\NormalTok{win }\OperatorTok{=}\NormalTok{ visual.Window(size}\OperatorTok{=}\NormalTok{(}\DecValTok{800}\NormalTok{, }\DecValTok{600}\NormalTok{))}

\CommentTok{\# waiting for any key press}
\NormalTok{event.waitKeys()}

\CommentTok{\# closing the window}
\NormalTok{win.close()}
\end{Highlighting}
\end{Shaded}

Run it to check that PsychoPy work. If you get an error saying that \texttt{psychopy} library is not found, check the \protect\hyperlink{install-vs-code}{active Python interpreter}. You should get a gray window with \emph{PsychoPy} title. Press any key (click on the window, if you switched to another one, so that it registers a key press) and it should close. Not very exciting but does show that everything works as it should.

Put your code into \emph{code01.py}.

The code is simple but packs quite a few novel bits. First line is easy, we simply import \href{https://psychopy.org/api/visual/index.html}{visual} and \href{https://psychopy.org/api/event.html}{event} modules from \emph{psychopy} library (a library can be itself organized into sublibraries to make things even more modular). Then, we create an \emph{object} \texttt{win} using a \emph{class} \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window}{Window} with custom size. Third line uses function \href{https://psychopy.org/api/event.html\#psychopy.event.waitKeys}{waitKeys()} from \emph{event} module to wait for a key press. The last one closes the window by calling its \texttt{close} \emph{method}. You should have little trouble with lines \#1 and \#3 but you need to learn about object-oriented programming to understand \#2 and \#4.

\hypertarget{classes-and-objects}{%
\section{Classes and objects}\label{classes-and-objects}}

The PsychoPy library is collection of \emph{classes} that you use to create \emph{objects}, an approach called \emph{object-oriented programming}. The core idea is in the name: Instead of keeping variables (data) separate from functions (actions), you combine them in an object that has attributes\footnote{Also called properties} (its own variables) and methods (its own functions). This approach utilizes our natural tendency to perceive the world as a collection of interacting objects.

First, you need to understand an important distinction between \emph{classes} and \emph{objects}. A \emph{class} is a ``blueprint'' that describes properties and behavior of \emph{all} objects of that class. This ``blueprint'' is used to create an \emph{instance} of that class, which is called an \emph{object}. For example, Homo sapiens is a \emph{class} that describes species that have certain properties, such as height, and can do certain things, such as running. However, Homo sapiens as a class has only a \emph{concept} of height but no specific height itself. E.g., you cannot ask ``What is height of Homo sapiens?'' only what is an average (mean, median, etc.) height of individuals of that class. Similarly, you cannot say ``Run, Homo sapiens! Run!'' as abstract concepts have trouble performing real actions like that. Instead, it is Alexander Pastukhov who is an \emph{instance} of Homo sapiens class with a specific height and a specific (not particularly good) ability to run. Other instances of Homo sapiens (other people) have different height and a different (typically better) ability to run. Thus, a class describes all common properties and methods that all \emph{instances} of the class (all objects) will have. But individual object will behave differently because of different values of their properties. This means that whenever you meet a Homo sapien, you could be sure that they have height per se but will need to look at an individual \emph{instance} to figure what height they have.

\texttt{Window} is a class that describes properties that a PsychoPy window must have and actions it can perform (you can see the complete list in \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window}{the manual}). To create an object, we use its class definition and store the result in a variable. In the code above we call \texttt{Window} class\footnote{Technically, we call a class constructor method called \texttt{\_\_init\_\_} but this is not important for now.} while passing custom parameters to it (\texttt{size=(800,\ 600)}) and store an object that it returns in variable \texttt{win}.

Attributes are, essentially, variables that belong to the class and, therefore, variables that each object will possess. For example, a \texttt{Window} class has \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.size}{size} attribute that determines its on-screen size in pixels. It also has (background) \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.color}{color}, an attribute that determines whether it should be shown in \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.fullscr}{full screen mode}, etc. Thus, a \texttt{win} object will have all these attributes and they will have specific values.

To understand both properties and class/object distinction better, put a breakpoint on the third line of code (\texttt{event.waitKeys()}) and fire up the debugger via \textbf{F5}. Once the window is created, the execution will pause and you will find a \texttt{win} object in \emph{Variables/Locals}. Click on it and it will expand to show all attributes and its values, including \texttt{size} (check that it is \texttt{{[}800,\ 600{]}}). Note that you will not see \texttt{Window} itself in the same list. This is because it is a class, an abstract concept, whereas as \texttt{win} is its instance and object of that class.

Methods, such as \texttt{Window.close()} are, essentially, functions that belong to the class/object and perform certain actions on the object. For example, method \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.close}{close()} closes the window, \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.flip}{flip()} updates it after we finished drawing in it, etc. What is important is to remember is that each method will act only on the object \emph{it belongs to} and not on other instances of the same class. This means that you can create two windows (\texttt{win1} and \texttt{win2}) and calling \texttt{win1.close()} will close the first but not the second window (try this out!). Same goes for attributes, changing them in one object will not affect any other objects of the same class, just like changing a value in one variable will not affect the other ones.

Although we barely scratch the surface of object-oriented programming, it will be enough for us to be able to use classes defined for us in PsychoPy library.

\hypertarget{arguments-by-position-or-name}{%
\section{Function parameters: default values, passing by position or by name}\label{arguments-by-position-or-name}}

There are a few more curious bits in the \texttt{visual.Window(size=(800,\ 600))} call above that we need to discuss. These curiosities are related to functions (and, therefore, methods) not classes per se. First, constructor method of the Window class has \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window}{a lot of arguments} (when we construct an object, we call a constructor \emph{method} of the class, which is why we are talking about functions). And yet, we only passed one of them. This is because you can specify \href{https://docs.python.org/3/tutorial/controlflow.html\#default-argument-values}{default values} for individual parameters. In this case, if a parameter is omitted, a default value is used instead

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ divide(x1, x2}\OperatorTok{=}\DecValTok{2}\NormalTok{):}
  \CommentTok{"""}
\CommentTok{  Divides numbers, uses 2 as a second value if a second term is omitted.}
\CommentTok{  }
\CommentTok{  Parameters:}
\CommentTok{  {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{  x1 : number}
\CommentTok{  x2 : number, defaults to 2}
\CommentTok{  }
\CommentTok{  Returns:}
\CommentTok{  {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{  number}
\CommentTok{  """}
  \ControlFlowTok{return}\NormalTok{ x1 }\OperatorTok{/}\NormalTok{ x2}
\BuiltInTok{print}\NormalTok{(divide(}\DecValTok{2}\NormalTok{))}
\CommentTok{\#\textgreater{} 1.0}
\BuiltInTok{print}\NormalTok{(divide(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\CommentTok{\#\textgreater{} 0.5}
\end{Highlighting}
\end{Shaded}

If you look at \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window}{documentation}, you will see that for the Window class constructor \emph{all} parameters have a default value. This is part of PsychoPy's philosophy of combining rich customization (just look at the sheer number of parameters!) with simplicity of use through sensible defaults (specify nothing and the window will still work).

Second, we did not just pass the value but specified which parameter this value is for via \texttt{size=(800,\ 600)}. This notation is called \href{https://docs.python.org/3/tutorial/controlflow.html\#keyword-arguments}{keyword arguments}. The advantage is in making it more explicit which parameter you are passing a value through. Plus, it allows you to put parameters any order, if that is more relevant given the context\footnote{However, stick to original order for consistency otherwise.}. If you do not use names, the values are assigned to individual parameters based on their \emph{position} (a.k.a. positional parameters). You can even mix the two, but positional parameters must come first, see \href{https://docs.python.org/3/tutorial/controlflow.html\#more-on-defining-functions}{documentation} if you want to know more.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# using positional parameters}
\BuiltInTok{print}\NormalTok{(divide(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\CommentTok{\#\textgreater{} 0.5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# using keyword arguments}
\BuiltInTok{print}\NormalTok{(divide(x2}\OperatorTok{=}\DecValTok{4}\NormalTok{, x1}\OperatorTok{=}\DecValTok{2}\NormalTok{))}
\CommentTok{\#\textgreater{} 0.5}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# mixing positional and keyword arguments}
\BuiltInTok{print}\NormalTok{(divide(}\DecValTok{2}\NormalTok{, x2}\OperatorTok{=}\DecValTok{4}\NormalTok{))}
\CommentTok{\#\textgreater{} 0.5}
\end{Highlighting}
\end{Shaded}

\hypertarget{adding-main-loop}{%
\section{Adding main loop}\label{adding-main-loop}}

Currently, not much is happening in our program. One thing we need to add is a loop in which we can repeatedly draw in a window (and update it via its \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.flip}{flip()} method), check user input, and perform any other necessary actions.

First, let us add the loop and handling of user inputs (the fun drawing part will be next). The loop goes between opening and closing the window:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{importing libraries}
\NormalTok{opening the window}

\OperatorTok{{-}{-}\textgreater{}}\NormalTok{ our main loop }\OperatorTok{\textless{}{-}{-}}

\NormalTok{closing the window}
\end{Highlighting}
\end{Shaded}

The loop should be repeated until the user presses an \emph{escape} key and, therefore, you will need a variable that signals this. My approach is to create a variable \texttt{gameover} initializing it to \texttt{False} and repeat the loop as long as the game not over. Then, in the loop, use function \href{https://psychopy.org/api/event.html\#psychopy.event.getKeys}{event.getKeys()} to check whether \emph{escape} button was pressed (for this, you need to pass \texttt{keyList={[}\textquotesingle{}escape\textquotesingle{}{]}}). The function returns a \emph{list} of keys, if any of them were pressed in the meantime or an empty list, if no keys from the \texttt{keyList} were pressed. Store that returned value in a temporary variable (I tend to call it \texttt{keys}). You will learn about lists only in the \emph{next} chapter, so for now use a ready-made: \texttt{len(keys)\ \textgreater{}\ 0} is a comparison that is \texttt{True} if list is not empty. If the list is indeed not empty, that means that the user pressed \emph{escape} (as that is the only key that we specified in the function call) and the game should be over. Think how can you do it \emph{without} an \texttt{if} statement, computing the logical value directly?

Put your code into \emph{code02.py}.

\hypertarget{adding-text-message}{%
\section{Adding text message}\label{adding-text-message}}

Although we are now running a nice game loop, we still have only a boring gray window to look at. Let us create a text stimulus, which would say ``Press escape to exit'' and display it during the loop. For this we will use \href{https://psychopy.org/api/visual/textstim.html}{visual.TextStim} class from PsychoPy library.

First, you need to create the \texttt{press\_escape\_text} object (instance of the \href{https://psychopy.org/api/visual/textstim.html\%20class}{TextStim}) before the main loop. There are quite a few parameters that you can play with but minimally, you need to pass the window the text should be displayed in (our \texttt{win} variable) and the actual text you want to display (\texttt{text="Press\ escape\ to\ exit"}). For all other settings PsychoPy will use its \protect\hyperlink{arguments-by-position-or-name}{defaults} (default font family, color and size, placed right at the windows' center).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{press\_escape\_text }\OperatorTok{=}\NormalTok{ visual.TextStim(win, }\StringTok{"Press escape to exit"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

To show the visuals in PsychoPy, you first \emph{draw} each element by calling its \href{https://psychopy.org/api/visual/textstim.html\#psychopy.visual.TextStim.draw}{draw()} method and then update the window by \emph{flipping}\footnote{This is called flipping because a window has two buffers: one that is currently displayed on the screen and the other one in which you can draw your stimuli. Once you are done with drawing, you ``flip'' the buffers so that they exchange their places. Now the one you drew in gets displayed and you have the other buffer to draw in.} it. Note that you call \href{https://psychopy.org/api/visual/window.html\#psychopy.visual.Window.flip}{flip()} only \emph{once} after \emph{all} stimuli are drawn. I typically organize this code into a separate chunk and prepend it with a comment line \texttt{\#\ drawing\ stimuli}.

The \texttt{\#\ drawing\ stimuli} chunk goes inside the main loop either before\footnote{my personal preference but in most cases it makes no difference} or after the keyboard check. Organize the latter also as a separate code chunk with its own brief comment.

Put your code into \emph{code03.py}.

Now, you should have a nice, although static, message positioned at the window's center that tells you how you can exit the game. Check out the manual page for \href{https://psychopy.org/api/visual/textstim.html}{visual.TextStim} and try changing it by passing additional parameters to the class call. For example you can change its \texttt{color}, whether text is \texttt{bold} and/or \texttt{italic}, how it is aligned, etc. However, if you want to change \emph{where} the text is displayed, read on below.

\hypertarget{adding-a-square-and-placing-it-not-at-the-center-of-the-window}{%
\section{\texorpdfstring{Adding a square and placing it \emph{not} at the center of the window}{Adding a square and placing it not at the center of the window}}\label{adding-a-square-and-placing-it-not-at-the-center-of-the-window}}

Now, let us figure out how create and move visuals to an arbitrary location on the screen. In principle, this is very straightforward as every visual stimulus (including \href{https://psychopy.org/api/visual/textstim.html\#psychopy.visual.TextStim}{TextStim} we just used) has \href{https://psychopy.org/api/visual/textstim.html\#psychopy.visual.TextStim.pos}{pos} property that specifies (you guessed it!) its position within a window. However, to make your life easier, PsychoPy first complicates it by having \href{https://psychopy.org/general/units.html}{\textbf{five} (5!) different position units systems}.

Before we start exploring the units, let us create a simple white square. The visual class we need is \href{https://psychopy.org/api/visual/rect.html}{visual.Rect}. Just like the \href{https://psychopy.org/api/visual/textstim.html\#psychopy.visual.TextStim}{TextStim} above, it requires \texttt{win} variable (so it knows which window it belongs to), \texttt{width} (defaults to 0.5 of those mysterious units), \texttt{height} (also defaults to 0.5), \texttt{pos} (defaults to (0,0)), \texttt{lineColor} (defaults to \texttt{white}) and \texttt{fillColor} (defaults to \texttt{None}). Thus, to get a ``standard'' white outline square with size of \texttt{(0.5,\ 0.5)} units at \texttt{(0,\ 0)} location you only need pass the \texttt{win} variable: \texttt{white\_square\ =\ visual.Rect(win)}. However, on \emph{some} computers a curious bug prevents PsychoPy from drawing the outline correctly. If you end up staring at an empty screen, add \texttt{fillColor="white"} to the call and you should see a filled white square.

You draw the square just like you drew the text stimulus, via its \href{https://psychopy.org/api/visual/rect.html\#psychopy.visual.rect.Rect.draw}{draw()} method. Create the code (either keep the text and draw both, or drop the text), run it to see a very white square.

Put your code into \emph{code04.py}.

What? Your square is not really a square? Well, I've warned you: \href{https://psychopy.org/general/units.html\#units}{\textbf{Five} units systems}!

\hypertarget{psychopy-units}{%
\section{Five units systems}\label{psychopy-units}}

\hypertarget{psychopy-units-height}{%
\subsection{Height units}\label{psychopy-units-height}}

With \href{https://psychopy.org/general/units.html\#height-units}{height units} everything is specified in the units of window height. The center of the window is at \texttt{(0,0)} and the window goes vertically from \texttt{-0.5} to \texttt{0.5}. However, horizontal limits depend on the aspect ratio. For our 800×600 window (4:3 aspect ratio), it will go from -0.666 to 0.666 (the window is 1.3333 window heights wide). For a 600×800 window (3:4 aspect ratio) from -0.375 to 0.375 (the window is 0.75 window heights wide), for a square window 600×600 (aspect ratio 1:1) from -0.5 to 0.5 (again, in all these cases it goes from -0.5 to 0.5 vertically). This means that the actual on-screen distance for the units is the same for both axes. So that a square of \texttt{size=(0.5,\ 0.5)} is actually a square (it spans the same distance vertically and horizontally). Thus, height units make \emph{sizing} objects easier but \emph{placing them on horizontal axis correctly} harder (as you need to know the aspect ratio).

Modify your code by specifying the unit system when you create the window: \texttt{win\ =\ visual.Window(...,\ units="height")}. Play with your code by specifying position of the square when you create it. You just need to pass an extra parameter \texttt{pos=(\textless{}x\textgreater{},\ \textless{}y\textgreater{})}.

Put your code into \emph{code05.py}.

By the way, which way is up: When y is below or above zero? Unfortunately, unlike x-axis, the y-axis can go both ways. For PsychoPy y-axis points up (so negative values move the square down and positive up). However, if you would use an Eyelink eye tracker to record where participants looked \emph{on the screen}, it assumes that y-axis starts at the top of the screen and points down (this could be very confusing, if you forget about this when overlaying gaze data on an image you used in the study and wondering what on Earth the participants were doing).

Now, modify the size of the square (and turn it into a non-square rectangle) by passing \texttt{width=\textless{}some-width-value\textgreater{}} and \texttt{height=\textless{}some-height-value\textgreater{}}.

Put your code into \emph{code06.py}.

\hypertarget{psychopy-units-norm}{%
\subsection{Normalized units}\label{psychopy-units-norm}}

\href{https://psychopy.org/general/units.html\#normalised-units}{Normalized units} are default units and assume that the window goes from -1 to 1 both along x- and x-axis. Again, (0,0) is the center of the screen but the bottom-left corner is (-1, -1) whereas the top-right is (1, 1). This makes \emph{placing} your objects easier but \emph{sizing} them harder (you need to know the aspect ratio to ensure that a square is a square).

Modify your code, so that it uses \texttt{"norm"} units when you create the window and size your white square stimulus, so it does look like a square.

Put your code into \emph{code07.py}.

\hypertarget{pixels-on-screen}{%
\subsection{Pixels on screen}\label{pixels-on-screen}}

For pixels on screen (\url{https://psychopy.org/general/units.html\#pixels-on-screen}) units, the window center is still at \texttt{(0,0)} but it goes from \texttt{-\textless{}width-in-pixels\textgreater{}/2} to \texttt{\textless{}width-in-pixels\textgreater{}/2} horizontally (from -400 to 400 in our case) and \texttt{-\textless{}height-in-pixels\textgreater{}/2} to \texttt{\textless{}height-in-pixels\textgreater{}/2} vertically (from -300 to 300). These units could be more intuitive when you are working with a fixed sized window, as the span is the same along the both axes (like for the height units). However, they spell trouble if your window size has changed or you are using a full screen window on a monitor with an unknown resolution. In short, you should use them only if they dramatically simplify your code.

Modify your code to use \texttt{"pix"} units and briefly test sizing and placing your square within the window.

Put your code into \emph{code08.py}.

\hypertarget{degrees-of-visual-angle}{%
\subsection{Degrees of visual angle}\label{degrees-of-visual-angle}}

Unlike the three units above, using \href{https://psychopy.org/general/units.html\#degrees-of-visual-angle}{degrees of visual angle} requires you knowing a physical size of the screen, its resolution, and viewing distance (how far your eyes are away from the screen). They are \emph{the} measurement units used in visual psychophysics as they describe stimulus size as it appears on the retina (see \href{https://en.wikipedia.org/wiki/Visual_angle}{Wikipedia} for details). Thus, these are the units you want to use when running an actual experiment in the lab.

\hypertarget{centimeters-on-screen}{%
\subsection{Centimeters on screen}\label{centimeters-on-screen}}

Here, you would need know the physical size of your screen and its resolution. These are fairly exotic units for very specific usage cases\footnote{So specific that I cannot think of one, to be honest.}.

\hypertarget{make-your-square-jump}{%
\section{Make your square jump}\label{make-your-square-jump}}

So far, we fixed the location of the square when we created it. However, you can move it at any time by assigning a new \texttt{(\textless{}x\textgreater{},\ \textless{}y\textgreater{})} coordinates to its \texttt{pos} property. \emph{E.g.}, \texttt{white\_square.pos\ =\ (-0.1,\ 0.2)}. Let us experiment by moving the square to a random location on every iteration of the loop (this could cause a lot of flashing, so if you have a photosensitive epilepsy that can be triggered by flashing lights, you probably should do it just once before the loop). Use the units of your choice and generate a new position using \href{https://docs.python.org/3/library/random.html\#random.uniform}{random.uniform(a, b)} function, that generates a random value within \emph{a..b} range\footnote{You need to import the random library for this, of course.}. Generate two values (one for x, one for y). If you use \texttt{"norm"} units, your range is the same (from -1 to 1) for the two dimensions. However, if you used \texttt{"height"} units, you need to take into account the aspect ratio of your window (4:3 if you are using 800×600 pix window).

Put your code into \emph{code09.py}.

\hypertarget{make-the-square-jump-on-your-command}{%
\section{Make the square jump on your command}\label{make-the-square-jump-on-your-command}}

This was very flashy, so let us make the square jump only when you press \textbf{space} button. For this, we need to expand the code that processes keyboard input. So far, we restricted it to just \textbf{escape} button and checked whether any (hence, \textbf{escape}) button was pressed.

You will learn about lists and indexes in the next chapter, so here is another ready-made. First, add \texttt{"space"} to the \texttt{keyList} parameter. Next, use conditional \protect\hyperlink{ux5cux257Bux5cux23if-statement}{if statement} to check whether \href{https://psychopy.org/api/event.html\#psychopy.event.getKeys}{event.getKeys()} returned a key press. If it did (\texttt{len(keys)\ \textgreater{}\ 0}), you can now check whether \texttt{keys{[}0{]}} is equal to \texttt{"space"} or \texttt{"escape"}\footnote{You can use \texttt{if..else}, because we only have two options but I would recommend to go for a more general solution \texttt{if..elif}}. If it was the latter, the game is over as before. If it was \texttt{"space"} then move the square to a new random position (and do not move it on every frame!)

Hint, if you are debugging, put you breakpoint inside the \texttt{if} statement, so that the program pauses only once you pressed a key (what happens if you put it on the \texttt{win.flip()} line?)

Put your code into \emph{code10.py}.

\hypertarget{basics-covered}{%
\section{Basics covered}\label{basics-covered}}

There is plenty more to learn about PsychoPy but we've got the basics covered. Submit your files and get ready to \protect\hyperlink{whack-a-mole}{Whack a Mole}!

\hypertarget{whack-a-mole}{%
\chapter{Whack-a-Mole}\label{whack-a-mole}}

Today you will create your first \emph{video} game Whack-a-Mole. The game itself is very much a reaction time experiment: moles/targets appear after a random delay at one of the predefined locations, the player's task is to whack (press a corresponding button) the mole/target before it disappears. Your final game should look approximately like the one in the video: Circles (moles) turn white, if I hit the correct button in time.

Grab the \href{notebooks/07.\%20Whack-a-mole.ipynb}{exercise notebook} before we start!

\hypertarget{chapter-concepts-4}{%
\section{Chapter concepts}\label{chapter-concepts-4}}

\begin{itemize}
\tightlist
\item
  Storing many items in \protect\hyperlink{lists}{lists}.
\item
  Iterating over items use \protect\hyperlink{for-loop}{for} loop.
\item
  Generating a list of number using \protect\hyperlink{range}{range()}.
\item
  Making \protect\hyperlink{clock-wait}{a pause} and limiting time you \protect\hyperlink{waitKeys-maxwait}{wait for a key}.
\end{itemize}

\hypertarget{lists}{%
\section{Lists}\label{lists}}

So far, we were using variables to store single values: computer's pick, player's guess, number of attempts, PsychoPy window object, etc. But sometimes we need to handle more than one value. We already had this problem in the \protect\hyperlink{guess-the-number-ai}{computer-based Guess-the-Number} game when we needed to store the remaining number range. We got away by using two variables, one for the lower and one for the upper limit. However, this approach clearly does not scale well and, sometimes, we might not even know how many values we will need to store. Python's \href{https://docs.python.org/3/library/stdtypes.html\#lists}{lists} are the solution to the problem.

A list is a mutable\footnote{More on that and tuples (list's immutable cousins) later.} sequence of items where individual elements can be accessed via their zero-based index. Extending the idea of \protect\hyperlink{variables}{variable-as-a-box}, you can think about lists as a box with numbered slots. To store and retrieve a particular piece you will need to know both the \emph{variable name} and the \emph{index of the item} you are interested in within that box. Then, you work with a variable-plus-index in exactly the same way you work with a normal variable, accessing or changing its value via the same syntax as before.

A list is defined via square brackets \texttt{\textless{}variable\textgreater{}\ =\ {[}\textless{}value1\textgreater{},\ \textless{}value2\textgreater{},\ ...\ \textless{}valueN\textgreater{}{]}}. An individual slot within a list is also accessed via square brackets \texttt{\textless{}variable\textgreater{}{[}\textless{}index\textgreater{}{]}} where index is, again, \textbf{zero-based}\footnote{This is typical for ``classic'' programming languages but less so for ones that are linear algebra / data science oriented. Both Matlab and R use one-based indexing, so you need to be careful and double-check whether you are using correct indexes.}. This means that the \emph{first} items is \texttt{variable{[}0{]}} and, if there are \emph{N} items in the list, the last one is \texttt{variable{[}N-1{]}}. You can figure out the total number of items in a list by getting its length via a special \href{https://docs.python.org/3/library/functions.html\#len}{len()} function. Thus, you can access the last item via \texttt{variable{[}len(variable)-1{]}}\footnote{There is a simpler way to do this, which you will learn in a little while.}. Note the \texttt{-1}: If you list has 3 items, the index of the last one is 2, if it has 100, then 99, etc. I am spending so much time on this because it is a fairly common source of confusion.

Do exercise \#1 see how lists are defined and indexed.

Lists also allow you access more than one slot/index at a time via \emph{slicing}. You can specify index of elements via \texttt{\textless{}start\textgreater{}:\textless{}stop\textgreater{}} notation. For example, \texttt{x{[}1:3{]}} will give you access to two items with indexes 1 and 2. Yes, \emph{two} items: Slicing index goes from the \texttt{start} up to \textbf{but not including} the \texttt{stop}. Thus, if you want to get \emph{all} the items of a list, you will need to write \texttt{x{[}0:length(x){]}} and, yet, to get the last item alone you still write \texttt{x{[}len(x)-1{]}}. Confusing? I think so. I understand the logic but I find this stop-is-not-included to be counterintuitive and I still have to consciously remind myself about this. Unfortunately, this is a standard way to define sequences of numbers in Python, so you need to memorize this.

Do exercise \#2 to build the intuition.

When slicing, you can omit either \texttt{start} or \texttt{stop}. In this case, Python will assume that a missing \texttt{start} means \texttt{0} (the index of the first element) and missing \texttt{stop} means \texttt{len(\textless{}list\textgreater{})} (so, last item is included). If you omit \emph{both}, e.g., \texttt{my\_pretty\_numbers{[}:{]}} it will return all values, as this is equivalent to \texttt{my\_pretty\_numbers{[}0:len(my\_pretty\_numbers){]}}.\footnote{Note, that this is almost but not quite the same thing as just writing \texttt{my\_pretty\_numbers}, the difference is subtle but important. We will return to it later when talking about mutable versus immutable types.}

Do exercise \#3.

You can also use \emph{negative} indexes that are computed relative to length of the list. For example, if you want to get the \emph{last} element of the list, you can say \texttt{my\_pretty\_numbers{[}len(my\_pretty\_numbers)-1{]}} or just \texttt{my\_pretty\_numbers{[}-1{]}}. The last-but-one element would be \texttt{my\_pretty\_numbers{[}-2{]}}, etc. You can use negative indexes for slicing but keep in mind the \emph{including the start but excluding the stop} catch: \texttt{my\_pretty\_numbers{[}:-1{]}} will return all but last element of the list not the entire list!

Do exercise \#4.

Slicing can be extended by specifying a \texttt{step} via \texttt{stop:start:step} notation. \texttt{step} can be negative, allowing you to build indexes in the reverse order:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_pretty\_numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{]}
\NormalTok{my\_pretty\_numbers[}\DecValTok{4}\NormalTok{:}\DecValTok{0}\NormalTok{:}\OperatorTok{{-}}\DecValTok{1}\NormalTok{]}
\CommentTok{\#\textgreater{} [5, 4, 3, 2]}
\end{Highlighting}
\end{Shaded}

However, you must pay attention to the sign of the step. If it goes in the wrong direction then \texttt{stop} cannot be reached, Python will return an empty list.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_pretty\_numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{]}
\NormalTok{my\_pretty\_numbers[}\DecValTok{4}\NormalTok{:}\DecValTok{0}\NormalTok{:}\DecValTok{1}\NormalTok{]}
\CommentTok{\#\textgreater{} []}
\end{Highlighting}
\end{Shaded}

Steps can be combined with omitted and negative indexes. To get every \emph{odd} element of the list, you write \texttt{my\_pretty\_numbers{[}::2{]}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_pretty\_numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{]}
\NormalTok{my\_pretty\_numbers[::}\DecValTok{2}\NormalTok{]}
\CommentTok{\#\textgreater{} [1, 3, 5, 7]}
\end{Highlighting}
\end{Shaded}

Do exercise \#5.

If you try to to access indexes \emph{outside} of a valid range, Python will raise an \href{https://docs.python.org/3/library/exceptions.html\#IndexError}{IndexError}\footnote{If you are familiar with R and its liberal attitude towards indexes, you will find this very satisfying.}. Thus, trying to get 6\textsuperscript{th} element (index 5) of a five-element-long list will generate a simple and straightforward error. However, if your \emph{slice} is larger than the range, it will be truncated without an extra warning or an error. So, for a five-element list \texttt{my\_pretty\_numbers{[}:6{]}} or \texttt{my\_pretty\_numbers{[}:600{]}} will both return all numbers (effectively, this is equivalent to \texttt{my\_pretty\_numbers{[}:{]}}). Moreover, if the slice is empty (\texttt{2:2}, cannot include 2 because it is a stop value, even though it starts from 2 as well) or the entire slice is outside of the range, Python will return an empty list, again, neither warning or error is generated.

Do exercise \#6.

In Python lists are dynamic, so you can always add or remove elements to it, see {[}the list of methods {]}{]}(\url{https://docs.python.org/3/tutorial/datastructures.html\#more-on-lists}). You can add a new item to the of the end of the list via \texttt{append(\textless{}new\_value\textgreater{})} method

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_pretty\_numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{]}
\NormalTok{my\_pretty\_numbers.append(}\DecValTok{10}\NormalTok{)}
\NormalTok{my\_pretty\_numbers}
\CommentTok{\#\textgreater{} [1, 2, 3, 4, 5, 6, 7, 10]}
\end{Highlighting}
\end{Shaded}

Or, you can \texttt{insert(\textless{}index\textgreater{},\ \textless{}new\_value\textgreater{})} \emph{before} an element with that index. Unfortunately, this means that you can use an arbitrary large index and it will insert a new value as a \emph{last} element without generating an error.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_pretty\_numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{]}
\NormalTok{my\_pretty\_numbers.insert(}\DecValTok{2}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{my\_pretty\_numbers.insert(}\DecValTok{500}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\NormalTok{my\_pretty\_numbers}
\CommentTok{\#\textgreater{} [1, 2, 10, 3, 4, 5, 6, 7, 20]}
\end{Highlighting}
\end{Shaded}

You can remove an item using its index via \texttt{pop(\textless{}index\textgreater{})}, note that the item is \emph{returned} as well. If you omit the index, \texttt{pop()} removes the \emph{last} element of the list. Here, you can only use valid indexes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_pretty\_numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{]}
\NormalTok{my\_pretty\_numbers.pop(}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} 7}
\NormalTok{my\_pretty\_numbers.pop(}\DecValTok{3}\NormalTok{)}
\CommentTok{\#\textgreater{} 4}
\NormalTok{my\_pretty\_numbers}
\CommentTok{\#\textgreater{} [1, 2, 3, 5, 6]}
\end{Highlighting}
\end{Shaded}

Do exercise \#7.

\hypertarget{basic-game-scaffolding}{%
\section{Basic game scaffolding}\label{basic-game-scaffolding}}

Phew that was \emph{a lot} about lists\footnote{and we barely scratched the surface!}. However, \href{https://en.wikipedia.org/wiki/All_work_and_no_play_makes_Jack_a_dull_boy}{all work and no play makes Jack a dull boy}! So let us start with a basic PsychoPy scaffolding. Here the code structure:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ libraries }\ImportTok{from}\NormalTok{ [psychopy]}
\NormalTok{create the PsychoPy window (visual.Window())}
\NormalTok{flip the window (.flip())}
\NormalTok{wait }\ControlFlowTok{for}\NormalTok{ a player to press the escape key (event.waitKeys())}
\NormalTok{close the window (.close())}
\end{Highlighting}
\end{Shaded}

Try doing it from scratch. I have left hints to help you with this and you can always consult the \href{https://psychopy.org/api/index.html}{online documentation}. Do not forget to document the file and to split your code into meaningful chunks with comments (if needed).

Put your code into \emph{code01.py}.

\hypertarget{three-moles}{%
\section{Three moles}\label{three-moles}}

Let us create three moles that will be represented by \href{https://psychopy.org/api/visual/circle.html\#psychopy.visual.circle.Circle}{circles}. Create a new list variable \texttt{moles} and put three circles into it. One should go to the left, one dead center, and one to the right. Watch a video above to see what I mean. Think of a reasonable size (which \protect\hyperlink{psychopy-units}{units} make keeping circle a circle easier?) and position. You can also use different colors for them, as I did).

You can either create an empty list and then \texttt{append()} circles one at a time. Or you can use square brackets to put all three of them into the list in one go. Then \href{https://psychopy.org/api/visual/circle.html\#psychopy.visual.circle.Circle.draw}{draw()} circles before you flip the window and wait for a key press. Note that you have to draw them one at a time. Therefore, you will need to add three lines for this but the next section will show you an easier way.

Put your code into \emph{code02.py}.

\hypertarget{for-loop}{%
\section{For loop}\label{for-loop}}

In the code above, we needed to iterate over three moles (circles) that we had in a list. Python has a tool just for that: a
\href{https://docs.python.org/3/tutorial/controlflow.html?highlight=loop\#for-statements}{for loop} that iterates over the items in any sequence (our list is a sequence!). Here is an example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{42}\NormalTok{]}
\ControlFlowTok{for}\NormalTok{ a\_number }\KeywordTok{in}\NormalTok{ numbers:}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"Value of a\_number variable on this iteration is }\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{\%}\NormalTok{(a\_number))}
\NormalTok{    a\_number }\OperatorTok{=}\NormalTok{ a\_number }\OperatorTok{+} \DecValTok{3}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"  Now we incremented it by 3: }\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{\%}\NormalTok{(a\_number))}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"  Now we use in a formula a\_number / 10: }\SpecialCharTok{\%g}\StringTok{"}\OperatorTok{\%}\NormalTok{(a\_number }\OperatorTok{/} \DecValTok{10}\NormalTok{))}
\CommentTok{\#\textgreater{} Value of a\_number variable on this iteration is 2}
\CommentTok{\#\textgreater{}   Now we incremented it by 3: 5}
\CommentTok{\#\textgreater{}   Now we use in a formula a\_number / 10: 0.5}
\CommentTok{\#\textgreater{} Value of a\_number variable on this iteration is 4}
\CommentTok{\#\textgreater{}   Now we incremented it by 3: 7}
\CommentTok{\#\textgreater{}   Now we use in a formula a\_number / 10: 0.7}
\CommentTok{\#\textgreater{} Value of a\_number variable on this iteration is 42}
\CommentTok{\#\textgreater{}   Now we incremented it by 3: 45}
\CommentTok{\#\textgreater{}   Now we use in a formula a\_number / 10: 4.5}
\end{Highlighting}
\end{Shaded}

Here, the code inside the \texttt{for} loop is repeated three times because there are three items in the list. On each iteration, next value from the list gets assigned to a temporary variable \texttt{a\_number} (see the output). Once the value is assigned to a variable, you can use it just like any variable. You can print it out (first \texttt{print}), you can modify it (second line within the loop), use its value for when calling other functions, etc. To better appreciate this, copy-paste this code into a temporary file (call it \texttt{test01.py}), put a \protect\hyperlink{debugging}{breakpoint} onto the first \texttt{print} statement and then use \textbf{F10} to step through the loop and see how value of \texttt{a\_number} variable changes on each iteration and then it gets modified in the second line within the loop.

Note that you can use the same \href{https://docs.python.org/3/tutorial/controlflow.html?highlight=loop\#break-and-continue-statements-and-else-clauses-on-loops}{break} statement as for the \href{https://docs.python.org/3/reference/compound_stmts.html\#the-while-statement}{while} loop.

Do exercise \#8.

\hypertarget{drawing-in-a-loop}{%
\section{Drawing in a loop}\label{drawing-in-a-loop}}

Now that you have learned about the \protect\hyperlink{for-loop}{for} loop, it is easy to draw the moles. Just iterate over the list (come up with a good temporary variable name) and \texttt{draw()} a current item (which is in your temporary variable).

Put your code into \emph{code03.py}.

\hypertarget{range}{%
\section{range() function: Repeating code N times}\label{range}}

Sometimes, you might need to repeat the code several times. For example, imagine that you have 40 trials in an experiment. Thus, you need to repeat a trial-related code 40 times. You can, of course, build a list 40 items long by hand and iterate over it but Python has a handy \href{https://docs.python.org/3/tutorial/controlflow.html?highlight=loop\#the-range-function}{range()} function for that. \texttt{range(N)} yields N integers from 0 to N-1 (same up-to-but-not-including rule as for slicing) that you can iterate over in a for loop.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ x }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{3}\NormalTok{):}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"Value of x is }\SpecialCharTok{\%d}\StringTok{"}\OperatorTok{\%}\NormalTok{(x))}
\CommentTok{\#\textgreater{} Value of x is 0}
\CommentTok{\#\textgreater{} Value of x is 1}
\CommentTok{\#\textgreater{} Value of x is 2}
\end{Highlighting}
\end{Shaded}

You can modify \href{https://docs.python.org/3/library/stdtypes.html\#range}{range()} function behavior by providing a starting value and a step size. But in its simplest form \texttt{range(N)} is a handy tool to repeat the code that many times. Note that while you always need to have a temporary variable in a \texttt{for} loop, sometimes you may not use it at all. In cases like this, you should use \texttt{\_} (underscore symbol) as a variable name to indicate the lack of use.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ \_ }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{2}\NormalTok{):}
    \BuiltInTok{print}\NormalTok{(}\StringTok{"I will be repeated twice!"}\NormalTok{)}
\CommentTok{\#\textgreater{} I will be repeated twice!}
\CommentTok{\#\textgreater{} I will be repeated twice!}
\end{Highlighting}
\end{Shaded}

Alternatively, you can use \texttt{range()} to loop through indexes of a list (remember, you can always access an individual list item via \texttt{var{[}index{]}}). Do exactly that\footnote{Note, this is note a \emph{better} way but an \emph{alternative} way to do this.}! Modify your code to use \href{(https://docs.python.org/3/library/stdtypes.html\#range)}{range()} function in the for loop (how can you compute the number of iterations from the length of the list?), use temporary variable as an index for the list to draw each item\footnote{Style hint: if a variable is an \emph{index} of something, I tend to call it \texttt{isomething}. E.g., if it holds an index to a current mole, I would call it \texttt{imole}. This is \emph{my} way of doing it. Others use \texttt{i\_} prefix or an \texttt{\_i} suffix. But either way, it is a useful naming convention. Remember, the easier it is to understand the meaning of a variable from its name, the easier it is for you to read and modify the code.}. When in doubt, put a breakpoint inside (or just before) the loop and step through your code to understand what values a temporary loop variable gets and how it is used.

Put your modified code into \emph{code04.py}.

\hypertarget{random-mole}{%
\section{A random mole}\label{random-mole}}

Drawing all three moles served as a practical exercise with loops but in a real game we need to shown only one random target at a time. We could create the three targets as before and draw one of them. However, later on we would like to change the color of the target to indicate that the player did hit it, so it is simpler (if a bit wasteful) to create a single mole every time we need one.

For this, define one \protect\hyperlink{constants}{CONSTANT} with a list of three colors that you used and another one with three horizontal locations (the vertical location is the same, so we do not need to worry about it). Next, randomly pick which target out of three you want to create, i.e., we need to generate an \emph{index} of the target. You can do it either via \href{https://docs.python.org/3/library/random.html\#random.randrange}{random.randrange()} or via \href{https://docs.python.org/3/library/random.html\#random.choice}{random.choice()} building the range yourself via \href{}{the function with the same name} you have just learned about (remember to organize your imports alphabetically). Store the index in a variable with a meaningful name\footnote{\texttt{itarget}? \texttt{imole}?} and use it with constants to create the target of the corresponding color at a corresponding location. Then, you need to draw that single target before waiting for a key press.

Once you have the code, put a breakpoint and check that the value of the index variable matches what is shown on a screen\footnote{I know it feels redundant but these are little checks that cost little time by themselves but help you avoid wasting lots of time on tracing weird mistakes. Here, you check that your expectations (if the middle target is shown, the index should be 1) match the reality. Once you check this, you do not \emph{expect} it to be true, you \emph{know} it to be true!}.

Put your modified code into \emph{code05.py}.

\hypertarget{clock-wait}{%
\section{Random time}\label{clock-wait}}

What makes Whack-a-Mole game fun is not only that you do not know \emph{which} mole will appear but you also do not know \emph{when} it will appear and \emph{how much time} you have to whack it. Thus, we need to modify our presentation schedule. We need a blank period of a random duration (I would suggest between 0.75 s to 1.5 s) and limited presentation duration (between 0.5 to 0.75 s). First, you need to define these ranges as \protect\hyperlink{constants}{constants}. Now that you know lists you can use a single variable to hold both ends of the range. Then, you need to generate two numbers (one for the blank another for the presentation) coming from \href{https://docs.python.org/3/library/random.html\#random.uniform}{a uniform distrubition} within that range. Finally, you need to time your blank and presentation using the \href{https://psychopy.org/api/clock.html\#psychopy.clock.wait}{wait()} function from the \href{https://psychopy.org/api/clock.html}{clock} module.

Now is time to update and structure you code. Here is a approximate outline (note that I have dropped the wait for keys):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{"""Document your file}
\CommentTok{"""}
\ImportTok{import} \BuiltInTok{all}\NormalTok{ libaries you need }\KeywordTok{in}\NormalTok{ an alphabetical order}

\NormalTok{define CONSTANTS}

\NormalTok{create window}

\CommentTok{\# generating random parameters for the trial}
\NormalTok{pick random index }\ControlFlowTok{for}\NormalTok{ the mole}
\NormalTok{create the mole}
\NormalTok{generate random durations }\ControlFlowTok{for}\NormalTok{ blank }\KeywordTok{and}\NormalTok{ presentation interval}

\CommentTok{\# blank}
\NormalTok{clear window (win.flip() alone)}
\NormalTok{wait }\ControlFlowTok{for} \StringTok{"blank duration"}\NormalTok{ seconds}

\CommentTok{\# presentation}
\NormalTok{draw the mole}
\NormalTok{wait }\ControlFlowTok{for} \StringTok{"presentation duration"}\NormalTok{ seconds}

\NormalTok{close the window}
\end{Highlighting}
\end{Shaded}

Note that it has no response processing at the moment and that window should close right after the stimulus is presented.

Put your code into \emph{code06.py}.

\hypertarget{repeating-trials}{%
\section{Repeating trials}\label{repeating-trials}}

You already know how to \protect\hyperlink{range}{repeat} the same code many times. Decide on number of trials / rounds (define this as a constant) and repeat the single round that many times. Think about what code goes inside the loop and what should stay outside for the randomization to work properly.

Put your code into \emph{code07.py}.

\hypertarget{waitKeys-maxwait}{%
\section{Exit strategy}\label{waitKeys-maxwait}}

I hope that you used a small number of trials because (on my advice, yes!) we did not program a possibility to exit the game via the \textbf{escape} key. To put it in, we will replace \emph{both} \href{https://psychopy.org/api/clock.html\#psychopy.clock.wait}{wait()} calls with \href{https://psychopy.org/api/event.html\#psychopy.event.waitKeys}{waitKeys()} function. It has \texttt{maxWait} parameter that by default is set to infinity but can be set to the duration we require. If a player does not press a key, it will work just like \href{https://psychopy.org/api/clock.html\#psychopy.clock.wait}{wait()} did. If a player presses a key (allow only \texttt{"escape"} for now), it means that they want to abort the game (the only possible action at the moment). Thus, assign the returned value to a temporary variable (\texttt{keys}?) and check whether it is equal to \texttt{None}\footnote{Confusingly, if no key was pressed, \href{https://psychopy.org/api/event.html\#psychopy.event.getKeys}{getKeys()} returns an empty list but \href{https://psychopy.org/api/event.html\#psychopy.event.waitKeys}{waitKeys()} returns \texttt{None} and \texttt{None} has no length.}. If it is not equal to \texttt{None}, \protect\hyperlink{break}{break} out of the loop!

Put your code into \emph{code08.py}.

\hypertarget{whacking-that-mole}{%
\section{Whacking that mole}\label{whacking-that-mole}}

We have moles that appear at a random location after a random delay for a random period of time. Now we just need to add an ability to whack 'em! You whack a mole only when it is present. Thus, we only need to modify and handle the \href{https://psychopy.org/api/event.html\#psychopy.event.waitKeys}{waitKeys()} call for the presentation interval.

First, create a new constant with three keys that correspond to three locations. I would suggest using \texttt{{[}"left",\ "down",\ "right"{]}}, which are cursor keys\footnote{Want to know key codes for sure? Write a small program that open a window and then repeatedly waits for any key press and prints out into console.}. Next, you need to use them for the \texttt{keyList} parameter. However, we cannot use this list directly, as we also need the \textbf{escape} key. The simplest way is to put ``escape'' into its own list and concatenate the two lists via \texttt{+}: \texttt{{[}"escape"{]}\ +\ YOUR\_CONSTANT\_WITH\_KEYS}. Do this concatenation directly when you set a value to the \texttt{keyList} in the function call. Before we continue, run the code and test that you can abort the program during the presentation (but not during the blank interval) by pressing any of these three keys. Also check that \textbf{escape} still works!

Now that we have keys to press, we need more sophisticated processing (we gonna have quite a few nested conditional statements). We still need to check whether \href{https://psychopy.org/api/event.html\#psychopy.event.waitKeys}{waitKeys()} returned \texttt{None} first. If it did not, it must have returned a list of pressed keys. Actually, it will be a list with just a single item\footnote{You will get more than one item in that list only if you set \texttt{clearEvents=False}. In this case, you will get the list of keys pressed before the call. However, if you opted for a default \texttt{clearEvents=True}, you will get only one key press in the list (at least I was never able to get more than one).}, so we can work with it directly via \texttt{keys{[}0{]}}. Use conditional \protect\hyperlink{if-statement}{if-else statement} to break out of the loop if the player pressed \textbf{escape}. Otherwise, it was one of the three ``whack'' keys.

Our next step is to establish which index the key corresponds to. Python makes it extremely easy as lists have \texttt{.index(value)} method that returns the index of the value within the list. You have the (CONSTANT) list with the keys, you have the pressed key: Figure out the index and check whether it matches the index of the target (\texttt{imole} variable in my code). If it does, let us provide a visual feedback of success: change mole (circle) \texttt{fillColor} to white, draw it, and \href{https://psychopy.org/api/clock.html\#psychopy.clock.wait}{wait} for 300 ms (setup a constant for feedback duration). This way, the mole will turn white and remain briefly on the screen when hit but will disappear immediately, if you missed.

Put your code into \emph{code09.py}.

\hypertarget{you-did-it}{%
\section{You did it!}\label{you-did-it}}

Congratulations on your first video game! It could use some bells-and-whistles like having a score, combos would be cool, proper mole images instead circle, etc. but it works and it is fun (if you do not feel challenged, reduce the presentation time)! Submit your files and next time we will ditch the keyboard and learn how to handle the mouse for the Memory game.

\hypertarget{memory-game}{%
\chapter{Memory game}\label{memory-game}}

Today, you will write a good old \emph{Memory} game: Eight cards are lying ``face down'', you can turn any two of them and, if they are identical, they are taken off the table. If they are different, the cards turn ``face down'' again.

Before we start, create a new folder for the game and create a subfolder \emph{Images} in it. Then, download \href{material/chicken.zip}{images of chicken}\footnote{The images are courtesy of \href{https://openclipart.org/artist/Firkin}{Kevin David Pointon} and were downloaded
  from \href{https://openclipart.org/}{OpenClipart}. They are \href{https://creativecommons.org/publicdomain/zero/1.0/}{public domain} and can be used and distributed freely.} that we will use for the game and unzip them into \emph{Images} subfolder.

\hypertarget{chapter-concepts-5}{%
\section{Chapter concepts}\label{chapter-concepts-5}}

\begin{itemize}
\tightlist
\item
  \protect\hyperlink{mutable-objects}{Mutable} vs.~\protect\hyperlink{variables-as-boxes-immutable-objects}{immutable} objects
\item
  Showing \protect\hyperlink{imagestim}{images}.
\item
  Working with files via \protect\hyperlink{os-library}{os} library.
\item
  Using other \protect\hyperlink{dictionaries}{dictionary} containers.
\item
  \protect\hyperlink{list-operations}{List operations}.
\item
  Looping over both index and item via list \protect\hyperlink{enumerate}{enumeration}.
\end{itemize}

\hypertarget{variables-as-boxes-immutable-objects}{%
\section{Variables as Boxes (immutable objects)}\label{variables-as-boxes-immutable-objects}}

In this game, you will use \protect\hyperlink{dictionaries}{dictionaries}. These are \emph{mutable}, like \protect\hyperlink{lists}{lists} in constrant to ``normal'' \emph{immutable} values (integers, floats, strings). You need to learn about this distinction as these two kinds of objects (values) behave very differently under some circumstances, which is both good (power!) and bad (weird unexpected behavior!) news.

You may remember the \emph{variable-as-a-box} metaphor that I used it to introduce \protect\hyperlink{variables}{variables}. In short, a variable can be thought of as a ``box'' with a variable name written on it and a value being stored ``inside''. When you use this value or assign it to a different variable, you can assume that Python \emph{makes a copy} of it\footnote{Not really, but this makes it easier to understand.} and puts that \emph{copy} into a different variable ``box''. When you \emph{replace} value of a variable, you take out the old value, destroy it (by throwing it into a nearest black hole, I assume), create a new one, and put it into the variable ``box''. When you \emph{change} a variable based on its current state, the same thing happens. You take out the value, create a new value (by adding to the original one or doing some other operation), destroy the old one, and put the new one back into the variable ``box''. The important point is that although a \emph{variable} can have different immutable values (we \protect\hyperlink{random-mole}{changed} \texttt{imole} variable on every round), the immutable \emph{value} itself never changes. It gets \emph{replaced} with another immutable value but \emph{never changes}\footnote{A metaphor attempt: You can wear different shirts, so your \emph{look} (variable) changes but each individual shirt (potential values) remains the same (we ignore the wear and tear here) irrespective of whether your are wearing it (value is assigned to a variable) or not.}.

The box metaphor explains why the \protect\hyperlink{scopes-for-immutable-values}{scopes} work the way they do. Each scope has its own set of boxes and whenever you pass information between scopes, e.g., from a global script to a function, a copy of a value (from a variable) is created and put into a new box (e.g., a parameter) inside the function. When a function returns a value, it is copied and put in one of the boxes in the global script (variable you assigned the returned value to), etc.

However, this is true only for \emph{immutable} objects (values) such as numbers, strings, logical values, etc. but also \href{https://docs.python.org/3/library/stdtypes.html?highlight=tuple\#tuple}{tuples} (see below for what these are). As you could have guessed from the name, this means that there are other \emph{mutable} objects and they behave very differently.

\hypertarget{mutable-objects}{%
\section{Variables as post-it stickers (mutable objects)}\label{mutable-objects}}

Mutable objects are lists, dictionaries\footnote{Coming up shortly!}, and classes, i.e., things that can change. The key difference is that \emph{immutable} objects can be thought as fixed in their size. A number takes up that many bytes to store, same goes for a given string (although a different string would require more or fewer bytes). Still, they do not change, they are created and destroyed when unneeded but never truly updated.

\emph{Mutable} objects can be changed\footnote{Building on the looks metaphor: You can change your look by using a different (immutable) shirt or by \emph{changing} your haircut. You hair is mutable, you do not wear a different one on different days to look different, you need to modify it to look different.}. For example, you can add elements to your list, or remove them, or shuffle them. Same goes for \href{https://docs.python.org/3/tutorial/datastructures.html?highlight=dictionary\#dictionaries}{dictionaries}. Making such object \emph{immutable} would be computationally inefficient: Every time you add a value a (long) list is destroyed and recreated with just that one additional value. Which is why Python simply \emph{updates} the original object. For further computation efficiency, these objects are not copied when you assign them to a different variable or use as a parameter value but \emph{passed by reference}. This means that the variable is no longer a ``box'' but a ``sticker'' you put on an object (a list, a dictionary). And you can put as many stickers on an object as you want \emph{and it still will be the same object}!

What on Earth do I mean? Keeping in mind that a variable is just a sticker (one of many) for a mutable object, try figuring out what will be the output below:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{y }\OperatorTok{=}\NormalTok{ x}
\NormalTok{y.append(}\DecValTok{4}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

Do exercise \#1.

Huh? That is precisely what I meant with ``stickers on the same object''. First, we create a list and put an \texttt{x} sticker on it. Then, we assign \texttt{y} \emph{to the same list}, in other words, we put a \texttt{y} sticker on the same list. Since both \texttt{x} and \texttt{y} are stickers on the \emph{same} object, they are, effectively, synonyms. In that specific situation, once you set \texttt{x\ =\ y}, it does not matter which variable name you use to change \emph{the} object, they are just two stickers hanging side-by-side on the \emph{same} list. Again, just a reminder, this is \emph{not} what would happen for \emph{immutable} values, like numbers, where things would behaved the way you expect them to behave.

This variable-as-a-sticker, a.k.a. ``passing value by reference'', has very important implications for the function calls, as it breaks your scope without ever giving you a warning. Look at the code below and try figuring out what the output will be.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ change\_it(y):}
\NormalTok{    y.append(}\DecValTok{4}\NormalTok{)}

\NormalTok{x }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{change\_it(x)}
\BuiltInTok{print}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

Do exercise \#2.

How did we manage to modify a \emph{global} variable from inside the function? Didn't we change the \emph{local} parameter of the function? Yep, that is exactly the problem with passing by reference. Your function parameter is yet another sticker on the \emph{same} object, so even though it \emph{looks} like you do not need to worry about global variables (that's why you wrote the function and learned about scopes!), you still do. If you are perplexed by this, you are in a good company. This is one of the most unexpected and confusing bits in Python that routinely catches people\footnote{Well, at least me!} by surprise. Let us do a few more exercises, before I show you how to solve the scope problem for the mutable objects.

Do exercise \#3.

\hypertarget{tuple-a-frozen-list-tuple}{%
\section{Tuple: a frozen list (\#tuple)}\label{tuple-a-frozen-list-tuple}}

The wise people who created Python were acutely aware of the problem that the \emph{variable-as-a-sticker} creates. Which is why, they added an \textbf{immutable} version of a list, called a \href{https://docs.python.org/3/library/stdtypes.html?highlight=tuple\#tuple}{tuple}. It is a ``frozen'' list of values, which you can loop over, access its items by index, or figure out how many items it has, but you \emph{cannot modify it}. No appending, removing, replacing values, etc. For you this means that a variable with a frozen list is a box rather than a sticker and that it behaves just like any other ``normal'' \textbf{immutable} object. You can create a \texttt{tuple} by using round brackets.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i\_am\_a\_tuple }\OperatorTok{=}\NormalTok{ (}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

You can loop over it, e.g.,

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i\_am\_a\_tuple }\OperatorTok{=}\NormalTok{ (}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ number }\KeywordTok{in}\NormalTok{ i\_am\_a\_tuple:}
    \BuiltInTok{print}\NormalTok{(number)}
\CommentTok{\#\textgreater{} 1}
\CommentTok{\#\textgreater{} 2}
\CommentTok{\#\textgreater{} 3}
\end{Highlighting}
\end{Shaded}

but, as I said, appending will throw a mistake (try this code in a Jupyter Notebook)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i\_am\_a\_tuple }\OperatorTok{=}\NormalTok{ (}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}

\CommentTok{\# throws AttributeError: \textquotesingle{}tuple\textquotesingle{} object has no attribute \textquotesingle{}append\textquotesingle{}}
\NormalTok{i\_am\_a\_tuple.append(}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Same goes for trying to change it

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i\_am\_a\_tuple }\OperatorTok{=}\NormalTok{ (}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}

\CommentTok{\# throws TypeError: \textquotesingle{}tuple\textquotesingle{} object does not support item assignment}
\NormalTok{i\_am\_a\_tuple[}\DecValTok{1}\NormalTok{] }\OperatorTok{=} \DecValTok{1} 
\end{Highlighting}
\end{Shaded}

This means that when you need to pass a list of values to a function and you want them to have no link to the original variable, you should instead pass \emph{a tuple of values} to the function. The function still has a list of values but the link to the original list object is now broken. You can turn a list into a tuple using \texttt{tuple()}. Keeping in mind that \texttt{tuple()} creates a frozen copy of the list, what will happen below?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{y }\OperatorTok{=} \BuiltInTok{tuple}\NormalTok{(x)}
\NormalTok{x.append(}\DecValTok{4}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

Do exercise \#4.

As you probably figured out, when \texttt{y\ =\ tuple(x)}, Python creates \textbf{a copy} of the list values, freezes them (they are immutable now), and puts them into the ``y'' box. Hence, whatever you do to the original list, has no effect on the immutable ``y''.

Conversely, you ``unfreeze'' a tuple by turning it into a list via \texttt{list()}. Please note that it creates \textbf{a new list}, which has no relation to any other existing list, even if values are the same or were originally taken from any of them!

Do exercise \#5.

Remember I just said that \texttt{list()} creates a new list? This means that you can use it to create a copy of a list directly, without an intermediate tuple step. This way you can two \emph{different} lists with \emph{identical} values. You can also achieve the same results by slicing an entire list, e.g.~\texttt{list(x)}, is the same as \texttt{x{[}:{]}}.

Do exercise \#6.

Here, \texttt{y\ =\ list(x)} created a new list (which was a carbon copy of the one with the ``x'' sticker on it) and the ``y'' sticker was put on that new list, while the ``x'' remained hanging on the original.

Confusing? You bet! If you feel overwhelmed by this whole immutable/mutable, tuple/list, copy/reference confusion, you are just being a normal human being. I understand the (computational) reasons for doing things this way, I am aware of this difference and how useful this can be but it still catches me by surprise from time to time!

\hypertarget{minimal-code}{%
\section{Minimal code}\label{minimal-code}}

Enough of theory, let us get busy writing the game. As usual, let us start with a minimal code (try doing it from scratch instead of copy-pasting from the last game):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{importing psychopy modules that we need}
 
\NormalTok{creating a window of a useful size }\KeywordTok{and}\NormalTok{ useful units}

\NormalTok{waiting }\ControlFlowTok{for}\NormalTok{ a key press}

\NormalTok{closing the window}
\end{Highlighting}
\end{Shaded}

The first thing you need to decide on is the window size \emph{in pixels} and which units would sizing and placing cards easier. Each chicken image is 240×400 pixels and, for the game, we need place for \emph{exactly} 4×2 images, i.e.~our window must be 4 cards wide and 2 cards high. Do not forget to document the file!

Put your code into \texttt{code01.py}.

\hypertarget{imagestim}{%
\section{Drawing an image}\label{imagestim}}

We used (abstracta and boring) circles to represent moles but today we will use actual images of chicken (see instructions above on downloading them). Using an \href{https://psychopy.org/api/visual/imagestim.html}{image stimulus} in PsychoPy is very straightforward because it behaves very mcu like other visual stimuli you already know. First, you need to create an new object by calling \texttt{visual.ImageStim(...)}. You can find the complete list of parameters in the \href{(https://psychopy.org/api/visual/imagestim.html)}{documentation} but for our initial intents and purposes, we only need to pass three of them:

\begin{itemize}
\tightlist
\item
  our window variable: \texttt{win}.
\item
  image file name: \texttt{image="Images/r01.png"} (images are in a subfolder and therefore we need to use a relative path).
\item
  size: \texttt{size=(???,\ ???)}. That is one for you to compute. If you picked \protect\hyperlink{psychopy-units-norm}{norm} units, as I did, then window is 2 units wide and 2 units high but for \protect\hyperlink{psychopy-units-height}{height} it is 1 units height and \emph{aspect-ratio} units wide. We want to have a 4×2 images, what is the size (both width and height) of each image in the units of your choice?
\end{itemize}

Draw chicken image (it should appear at the center of the screen).

Put your code into \texttt{code02.py}.

\hypertarget{placing-an-image-index-to-position}{%
\section{Placing an image (index to position)}\label{placing-an-image-index-to-position}}

By default, our image is placed at the center of the screen, which is a surprisingly useful default for a typical psychophysical experiment that shows stimuli at fixation (which is also, typically, at the center of the screen). However, we will need to draw eight images, each at its designated location. You need to create a function that takes an image index (it goes 0 to 7) and returns a list with pair of values with its location on the screen. Below is a sketch of how index correspond to the location. Note that image location (\href{https://psychopy.org/api/visual/imagestim.html\#psychopy.visual.ImageStim.pos\%20attribute}{pos} corresponds to the \emph{center} of the image.

\begin{figure}
\centering
\includegraphics[width=1\textwidth,height=\textheight]{images/memory-location-index.png}
\caption{Card location index}
\end{figure}

Name the function \texttt{position\_from\_index}. It should take one argument (\texttt{index}) and return a list with \texttt{(\textless{}x\textgreater{},\ \textless{}y\textgreater{})} coordinates in the PsychoPy units (from now on I assume that these are \protect\hyperlink{psychopy-units-norm}{norm}). You can then use this value for the \href{https://psychopy.org/api/visual/imagestim.html\#psychopy.visual.ImageStim.pos}{pos} argument of the \href{https://psychopy.org/api/visual/imagestim.html\#imagestim}{ImageStim()}.

The computation might look complicated, so let me get you started. How can you compute \emph{x} coordinate for the \emph{top} row? Concentrating on the top row alone makes things simpler because here the \emph{column index} is the same as the overall index: The left-most column is 0, the next one is 1, etc. You need a simple algebra of \(x = a_x + b_x \cdot column\). You can easily deduce out both \(a_x\) and \(b_x\) if you figure out locations of the first and second cards by hand. Same goes for the \emph{y} coordinate. Assuming that you know the \emph{row}, which is either 0 (top row) or 1 (bottom row), you can compute \(y = a_y + b_y \cdot row\).

But, I hear you say, you do not have row and column indexes, only the overall index! To compute those you only need to keep in mind that each row has \emph{four} cards. Then, you can make use of two special division operators: \href{https://python-reference.readthedocs.io/en/latest/docs/operators/floor_division.html}{floor division operator \texttt{//}} and \href{https://python-reference.readthedocs.io/en/latest/docs/operators/modulus.html}{modulos, divison remainder \texttt{\%}} operators. The former returns only the integer part of the division, so that \texttt{4\ //\ 3} is \texttt{1} (because 4/3 is 1.33333) and \texttt{1\ //\ 4} is \texttt{0} (because 1/4 is 0.25). The latter returns the remaining integers, so that \texttt{4\ \%\ 3} is \texttt{1} and \texttt{1\ \%\ 4} is \texttt{0}.

My suggestion would be first to play with individual formulas in Jupyter Notebook, which makes it easier to try out (dividing) things and seeing the result, putting various values into formulas, etc. Once you are confident that the code is working, turn it into a function, document it, and put into a separate file (\emph{utilities.py}, do not forget to put a comment at the top of the file as well!). You can then import it in the main script and use it to place the card. Try out different indexes and make sure that the card appears where it should. Remember, put a breakpoint and step through the program while watching variables, if things do not work as you expected.

Put \texttt{position\_from\_index} into \texttt{utilities.py}.
Put update code into \texttt{code03.py}

\hypertarget{backside-of-the-card}{%
\section{Backside of the card}\label{backside-of-the-card}}

A chicken image is a card \emph{face} but the game starts with the cards face down, so the player should see their backs. We will use a plain \href{https://psychopy.org/api/visual/rect.html}{rectangle} for as a backside. Pick a nice looking combination of \texttt{fillColor} (inside) and \texttt{lineColor} (contour) colors. Modify your code, to draw image (face of the card) and rectangle (back of the card) side-by-side (\emph{e.g.}, if face is at position with index 0, rectangle should be at position 1 or 4). This way you can check that sizes match and that they are positioned correctly.

Put your code into \texttt{code04.py}.

\hypertarget{dictionaries}{%
\section{Dictionaries}\label{dictionaries}}

Each card that we use has plenty of properties: A front (image), a backside (rectangle), and will have other properties such as which side should be shown or whether card is already taken off the screen. This calls for a container, so we could put all these relevant bits into a single variable. We \emph{could} put into a list and use numerical indexes to access individual elements (e.g., \texttt{card{[}0{]}} would be front image but \texttt{card{[}2{]}} would indicate the active side) but indexes do not have meaning per se, so figuring out how \texttt{card{[}0{]}} is different from \texttt{card{[}2{]}} would be tricky. Python has a solution for cases like this: \href{https://docs.python.org/3/library/stdtypes.html\#dict}{dictionaries}.

A dictionary is a container that stores information using \emph{key : value} pairs. This is similar to how you look up a meaning or a translation (value) of a word (key) in a real dictionary, hence the name. To create a dictionary, you use \emph{curly} brackets \texttt{\{\textless{}key1\textgreater{}\ :\ \textless{}value1\textgreater{}\},\ \{\textless{}key2\textgreater{}\ :\ \textless{}value2\textgreater{},\ ...\}} or create it via \texttt{dict(\textless{}key1\textgreater{}=\textless{}value1\textgreater{},\ \textless{}key2\textgreater{}=\textless{}value2\textgreater{},\ ...)}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{book }\OperatorTok{=}\NormalTok{ \{}\StringTok{"Author"}\NormalTok{ : }\StringTok{"Walter Moers"}\NormalTok{,}
        \StringTok{"Title"}\NormalTok{: }\StringTok{"Die 13½ Leben des Käpt\textquotesingle{}n Blaubär"}\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Once you created a dictionary, you can access or modify each field using its key, \emph{e.g.} \texttt{print(book{[}"Author"{]})} or \texttt{book{[}"Author"{]}\ =\ "Moers,\ W."}. You can also add new fields by assigning values to them, e.g., \texttt{book{[}"Publication\ year"{]}\ =\ 1999}. In short, you can use a combination of \texttt{\textless{}dictionary-variable\textgreater{}{[}\textless{}key\textgreater{}{]}} just like you would use a normal variable. This is similar to using the \texttt{list{[}index{]}} combination, the only difference is that \texttt{index} must be an integer, whereas \texttt{key} can be any hashable\footnote{Immutable values are \href{https://docs.python.org/3/glossary.html\#term-hashable}{hashable}, whereas mutable ones, like dictionaries and lists, are not. This is because mutable objects can \emph{change} while the program is running and therefore are unusable as a key. I.e., it is hard to match by a key, if the key can be different by the time you need to access the dictionary.} value.

\hypertarget{using-a-dictionary-to-represent-a-card}{%
\section{Using a dictionary to represent a card}\label{using-a-dictionary-to-represent-a-card}}

Our card has the following properties, so these will be key-value entries in a dictionary

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{"front"}: front side (image of a chicken).
\item
  \texttt{"back"}: back side (rectangle).
\item
  \texttt{"filename"}: identity on the card that we will use later to check whether the player opened two identical cards (their filenames match) or two different ones.
\item
  \texttt{"side"}: can be either \texttt{"front"} or \texttt{"back"}, information about which side is up (drawn on the screen). Set it \texttt{"back"} because, initially, all cards are face down. However, you can always set it temporarily to \texttt{"front"} to see how the cards are distributed.
\item
  \texttt{"show"}: a logical value, set it to \texttt{True}. We will use it later to mark out cards that are off the table and are, therefore, not shown. Initially, all cards are shown, so all cards should be created with \texttt{"show"} being equal to \texttt{True}.
\end{enumerate}

Create a dictionary variable (name it \texttt{card}) and fill it with the relevant values (use either \texttt{"front"} and ``\texttt{back"} for \texttt{"side"} key) and stimuli (you can put PsychoPy stimuli into a dictionary just like we put them into a list earlier). Modify you code so that it draws the correct image based on the value of the \texttt{"side"} entry. Note that you \textbf{do not need an if-statement for this}! Think about a key you need to access these two sides and the value that you have in for the \texttt{"side"} key.

Put your code into \texttt{code05.py}.

\hypertarget{card-factory}{%
\section{Card factory}\label{card-factory}}

You have the code to create one card but we need eight of them. This definitely calls for a function. Write a function (put it into \texttt{utilities.py} to declutter the main file) that takes three parameters

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  a window variable (you need it to create PsychoPy stimuli),
\item
  a filename,
\item
  card position index,
\end{enumerate}

and returns a dictionary, just like the one you created. You very much have the code, you only need to wrap it into a function and document it. Call function \texttt{create\_card} and use it in the main script to create \texttt{card} dictionary. Think about libraries you will now need import in \emph{utilities.py}.

Put \texttt{create\_card} into \texttt{utilities.py}.
Put code into \texttt{code06.py}.

\hypertarget{getting-a-list-of-files}{%
\section{Getting a list of files}\label{getting-a-list-of-files}}

For a single card, we simply hard-coded the name of an image file, as well as its location. However, for a real game (or an experiment) we would like to be more flexible and automatically determine which files we have in the \emph{Images} folder. This is covered by \href{https://docs.python.org/3/library/os.html}{os} library that contains various utilities for working with your operating system and, in particular, with files and directories. Specifically, \href{https://docs.python.org/3/library/os.html\#os.listdir}{os.listdir(path=``.'')} returns a list with filenames of \emph{all} the files in a folder specified by path. By default, it is a current path (\texttt{path="."}). However, you can use either a relative path - \texttt{os.listdir("Images")}, assuming that \emph{Images} is a subfolder in your current directory - or an absolute path \texttt{os.listdir("E:/Teaching/Python/MemoryGame/Images")} (in my case)\footnote{Use absolute path only if it is the only option, as it will almost certainly will break your code on another machine.}.

Try this out in a Jupyter Notebook (do not forget to import the \href{https://docs.python.org/3/library/os.html\#module-os}{os} library). You should get a list of 8 files that are coded as \emph{{[}r\textbar l{]}{[}index{]}.png}, where \emph{r} or \emph{l} denote a direction the chicken is looking. However, for our game we need only four images (4 × 2 = 8 cards). Therefore, we need to select a subset of them, e.g., four random cards, chicken looking to the left or to the right only. Here, let us work with chicken looking to the left, meaning that we need to pick only files that start with ``l''. To make this filtering easier, we will use a cool Python trick called \href{https://docs.python.org/3/tutorial/datastructures.html\#list-comprehensions}{list comprehensions}.

\hypertarget{list-comprehension}{%
\section{List comprehension}\label{list-comprehension}}

List comprehension provides an elegant and easy-to-read way to create, modify and/or filter elements of the list creating a new list. The general structure is

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{new\_list }\OperatorTok{=}\NormalTok{ [}\OperatorTok{\textless{}}\NormalTok{transform}\OperatorTok{{-}}\NormalTok{the}\OperatorTok{{-}}\NormalTok{item}\OperatorTok{\textgreater{}} \ControlFlowTok{for}\NormalTok{ item }\KeywordTok{in}\NormalTok{ old\_list }\ControlFlowTok{if} \OperatorTok{\textless{}}\NormalTok{condition}\OperatorTok{{-}}\NormalTok{given}\OperatorTok{{-}}\NormalTok{the}\OperatorTok{{-}}\NormalTok{item}\OperatorTok{\textgreater{}}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

Let us look at examples to understand how it works. Imagine that you have a list \texttt{numbers\ =\ {[}1,\ 2,\ 3{]}} and you need increment each number by 1\footnote{A very arbitrary example!}. You can do it by creating a new list and adding 1 to each item in the part:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{numbers\_plus\_1 }\OperatorTok{=}\NormalTok{ [item }\OperatorTok{+} \DecValTok{1} \ControlFlowTok{for}\NormalTok{ item }\KeywordTok{in}\NormalTok{ numbers]}
\end{Highlighting}
\end{Shaded}

Note that this is equivalent to

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{numbers\_plus\_1 }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ item }\KeywordTok{in}\NormalTok{ numbers:}
\NormalTok{    numbers\_plus\_1.append(item }\OperatorTok{+} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Or, imagine that you need to convert each item to a string. You can do it simply as

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{numbers\_as\_strings }\OperatorTok{=}\NormalTok{ [}\BuiltInTok{str}\NormalTok{(item) }\ControlFlowTok{for}\NormalTok{ item }\KeywordTok{in}\NormalTok{ numbers]}
\end{Highlighting}
\end{Shaded}

What would be an equivalent form using a normal for loop? Write both versions of code in Jupiter cells and check that the results are the same.

Do exercise \#7 in Jupyter notebook.

Now, implement the code below using list comprehension. Check that results match.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{strings }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}2\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}3\textquotesingle{}}\NormalTok{]}
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ astring }\KeywordTok{in}\NormalTok{ strings:}
\NormalTok{    numbers.append(}\BuiltInTok{int}\NormalTok{(astring) }\OperatorTok{+} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Do exercise \#8 in Jupyter notebook.

As noted above, you can also use a conditional statement to filter which items are passed to the new list. In our numbers example, we can retain numbers that are greater than 1

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{numbers\_greater\_than\_1 }\OperatorTok{=}\NormalTok{ [item }\ControlFlowTok{for}\NormalTok{ item }\KeywordTok{in}\NormalTok{ numbers }\ControlFlowTok{if}\NormalTok{ item }\OperatorTok{\textgreater{}} \DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

Sometimes, the same statement is written in three lines, instead of one, to make reading easier:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numbers }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{numbers\_greater\_than\_1 }\OperatorTok{=}\NormalTok{ [item }
                          \ControlFlowTok{for}\NormalTok{ item }\KeywordTok{in}\NormalTok{ numbers}
                          \ControlFlowTok{if}\NormalTok{ item }\OperatorTok{\textgreater{}} \DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

You can of course combine the transformation and filtering in a single statement. Create code that filters out all items below 2 and adds 4 to them.

Do exercise \#9 in Jupyter notebook.

\hypertarget{getting-list-of-relevant-files}{%
\section{Getting list of relevant files}\label{getting-list-of-relevant-files}}

Use list comprehension to create a list of files of chicken looking left, \emph{i.e.} with filenames that start with ``l''. Use \href{https://docs.python.org/3/library/stdtypes.html\#str.startswith}{.startswith()} to check whether it starts with ``l'', store the list in \texttt{filenames} variable. Test you code in a Jupyter Notebook. You should get a list of four files.

\hypertarget{list-operations}{%
\subsection{List operations}\label{list-operations}}

Our list consists of four unique filenames but in the game each card should appear twice. There are several ways of duplicating lists. Here, We will use this as a opportunity to learn about list operations. Python lists implement two operations:

\begin{itemize}
\tightlist
\item
  Adding two lists together: \texttt{\textless{}list1\textgreater{}\ +\ \textless{}list2\textgreater{}}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{b }\OperatorTok{=}\NormalTok{ [}\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{]}
\NormalTok{a }\OperatorTok{+}\NormalTok{ b}
\CommentTok{\#\textgreater{} [1, 2, 3, 4, 5, 6]}
\end{Highlighting}
\end{Shaded}

Note that this produces a \emph{new} list and, therefore, that this is not equivalent to \href{https://docs.python.org/3/tutorial/datastructures.html\#more-on-lists}{extend} method \texttt{a.extend(b)}! The \texttt{+} creates a \emph{new} list, \texttt{.extend()} extends the original list \texttt{a}.\footnote{You will learn about practical implications of this later. For now, keep in mind that seemingly identical output might be fundamentally different underneath.}

\begin{itemize}
\tightlist
\item
  List replication:: \texttt{\textless{}list\textgreater{}\ *\ \textless{}integer-value\textgreater{}} creates a \emph{new} list by replicating the original one \texttt{\textless{}integer-value\textgreater{}} times. For example:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{]}
\NormalTok{b }\OperatorTok{=} \DecValTok{4}
\NormalTok{a }\OperatorTok{*}\NormalTok{ b}
\CommentTok{\#\textgreater{} [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3]}
\end{Highlighting}
\end{Shaded}

Use either operation or \texttt{.extend()} method to create the list where each filename is repeated twice. Hint, you can apply list multiplication directly to the filenames list you created via list comprehension (so, replicate it in that same line). Try this code out in a Jupyter Notebook.

\hypertarget{enumerate}{%
\section{Looping over both index and item via list enumeration}\label{enumerate}}

Now that we have a list of filenames, we can create a list of cards out of it. Our dictionary function requires both index and filename. The latter is the \emph{item} of the list, the former is the \emph{index} of that item. You could for a for loop by build the index using \protect\hyperlink{range}{range()} function but Python has a better solution for this: a \href{https://docs.python.org/3/library/functions.html\#enumerate}{enumerate()} function! If, instead of iterating over a list, you iterate over \href{https://docs.python.org/3/library/functions.html\#enumerate}{enumerate()}, you get a tuple\footnote{A list you cannot change, more on this later.} with both \texttt{(index,\ value)}. Here is an example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{letters }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}c\textquotesingle{}}\NormalTok{]}
\ControlFlowTok{for}\NormalTok{ index, letter }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(letters):}
    \BuiltInTok{print}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\%d}\StringTok{: }\SpecialCharTok{\%s}\StringTok{\textquotesingle{}}\OperatorTok{\%}\NormalTok{(index, letter))}
\CommentTok{\#\textgreater{} 0: a}
\CommentTok{\#\textgreater{} 1: b}
\CommentTok{\#\textgreater{} 2: c}
\end{Highlighting}
\end{Shaded}

And here is how you can use \href{https://docs.python.org/3/library/functions.html\#enumerate}{enumerate()} for list comprehension.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{letters }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}c\textquotesingle{}}\NormalTok{]}
\NormalTok{[}\StringTok{"}\SpecialCharTok{\%d}\StringTok{: }\SpecialCharTok{\%s}\StringTok{"}\OperatorTok{\%}\NormalTok{(index, letter) }\ControlFlowTok{for}\NormalTok{ index, letter }\KeywordTok{in} \BuiltInTok{enumerate}\NormalTok{(letters)]}
\CommentTok{\#\textgreater{} [\textquotesingle{}0: a\textquotesingle{}, \textquotesingle{}1: b\textquotesingle{}, \textquotesingle{}2: c\textquotesingle{}]}
\end{Highlighting}
\end{Shaded}

\hypertarget{os-library}{%
\section{Computing path}\label{os-library}}

Originally, we specified image file name as \texttt{"Images/r01.png"}. This did the job but now we have many filenames that we need to join with the folder name to form a path string. On top of that, major operating systems disagree with Windows on where \texttt{/} (forward slash) or \texttt{\textbackslash{}} (backslash) should be used for paths. To make your code platform-independent and, therefore, more robust, you need to construct a filename string using \href{https://docs.python.org/3/library/os.path.html\#os.path.join}{join} function in \href{https://docs.python.org/3/library/os.path.html}{path} submodule. Thus, you can import \emph{os} library and call it as \texttt{os.path.join(...)} (my personal preference). Or, you can use the same approach as for PsychoPy modules and import \texttt{path} from \emph{os}, shortening the code. Or, of course, you can even import \emph{join} directly but I find that lack of library information during use makes things harder to understand (even though the code is even shorter).

\href{https://docs.python.org/3/library/os.path.html\#os.path.join}{join} takes path components as parameters and joins them to match the OS format. E.g., \texttt{os.path.join("Python\ seminar",\ "Memory\ game",\ "memory01.py")} on Windows will return \texttt{\textquotesingle{}Python\ seminar\textbackslash{}\textbackslash{}Memory\ game\textbackslash{}\textbackslash{}memory01.py\textquotesingle{}}. As we need to load multiple files, the \emph{filename} part will vary. However, the \emph{folder} where the images are located will be the same and, as per usual, it would a good idea to turn it into a formally declared \protect\hyperlink{constants}{CONSTANT}.

Modify the \texttt{create\_card} function so that it assumes that the \texttt{filename} parameter is just the filename with the folder name and, therefore, build the path by \href{https://docs.python.org/3/library/os.path.html\#os.path.join}{join} it with the folder name (defined as a constant in the this module!). You now need to drop the \texttt{"Images/"} in the value that you pass to it. Test that the code works as before!

Update \texttt{create\_card} in \texttt{utilities.py}
Put updated code into \texttt{code07.py}.

\hypertarget{a-deck-of-cards}{%
\section{A deck of cards}\label{a-deck-of-cards}}

Let us put together all the code we need for figuring out cards' filenames, duplicating them, and creating the cards using filename and index.

Copy the code for building a duplicated list of filenames that you tested in Jupyter notebook to your main script (that'll be \texttt{code09.py}). Then, use enumerate and list comprehension over enumerated duplicate filenames to create \texttt{cards} (plural, replacing your singular \texttt{card} variable) via \texttt{create\_card} function you wrote earlier. Update your drawing code to loop over and draw all cards. If your default is \texttt{"side"} is \texttt{"back"}, things will look pretty boring. Change that to '``front''` for all cards to see their faces.

Put your code into \texttt{code08.py}.

\hypertarget{shuffle}{%
\section{Shuffling cards}\label{shuffle}}

When you draw cards faces, you will notice that duplicating filenames list produces a very orderly sequence that makes playing the game easy (and boring). We need to \href{https://docs.python.org/3/library/random.html\#random.shuffle}{shuffle()} the filename list \emph{before} we create \texttt{cards}. Note that \href{https://docs.python.org/3/library/random.html\#random.shuffle}{shuffle()} shuffles list item \emph{in place} using the fact that the list is \protect\hyperlink{mutable-objects}{mutable}. That means you simply call the function and pass the list as an argument. The list gets modified, nothing is returned and nothing need to be assigned back of \texttt{filenames} variable.

Put your code into \texttt{code09.py}.

\hypertarget{lets-have-a-break}{%
\section{Let's have a break!}\label{lets-have-a-break}}

We covered a lot of ground, so it might be a good point to take a break and submit your code for my review.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{adding-main-game-loop}{%
\section{Adding main game loop}\label{adding-main-game-loop}}

At this point, we have a shuffle deck of cards that we show until a player presses a key. Modify the code to have the main presentation loop, similar to one we had when we experimented with \protect\hyperlink{psychopy-basics}{PsychoPy} stimuli. Previously, we used a logical \texttt{gameover} variable to control the \protect\hyperlink{ux5cux23while-loop}{while} loop. Here, we will have two reasons to exit the loop: the player pressed an \textbf{escape} key or they won the game. Therefore, let us use a \emph{string} \texttt{game\_state} variable that is initialized to \texttt{"running"}. Repeat the loop while the \texttt{game\_state} is equal to \texttt{"running"} but change it \texttt{"abort"} if a player pressed \textbf{escape}. You also need to replace \href{https://psychopy.org/api/event.html\#psychopy.event.waitKeys}{waitKeys}) with (\href{https://psychopy.org/api/event.html\#psychopy.event.getKeys}{getKeys}.

Put your code into \texttt{code10.py}.

\hypertarget{psychopy-mouse}{%
\section{Detecting a mouse click}\label{psychopy-mouse}}

In the game, the player will click on individual cards to turn them over. Before you can use a \href{https://psychopy.org/api/event.html\#psychopy.event.Mouse}{mouse} in PsychoPy, you must create it via \texttt{mouse\ =\ event.Mouse(visible=True,\ win=win)} call, where \texttt{win} is the PsychoPy window you already created. This code should appear immediately below the line where you create the window itself.

Now, you can check whether the left button was pressed using \href{https://psychopy.org/api/event.html\#psychopy.event.Mouse.getPressed}{mouse.getPressed()} method. It returns a three-item tuple with \texttt{True}/\texttt{False} values indicating whether each of the three buttons are \emph{currently being pressed}. Use it the main loop, so that if the player presses \emph{left} button (its index in the returned list is 0), you change \texttt{"side"} of the first card (so, the card with index 0 in the list) to \texttt{"front"}. This assumes that you initialized card with their \texttt{"back"} shown, of course. If you run the code and click \emph{anywhere}, this should flip the first card.

Put the mouse-click-processing code \emph{before} drawing cards. At the moment, it makes no difference but will be useful later on, as it will allow us to draw the latest state of the card (i.e., right after it was flipped by a player).

Put your code into \texttt{code11.py}.

\hypertarget{position-to-index}{%
\section{Position to index}\label{position-to-index}}

Currently, the first card is flipped if you click \emph{anywhere}. But the card you flip should be the card the player clicked on. For this we need to implement a function \texttt{index\_from\_position} that is an inverse of \texttt{position\_from\_index}. It should take an argument \texttt{pos}, which is a tuple of \texttt{(\textless{}x\textgreater{},\ \textless{}y\textgreater{})} values (a mouse position within the window), and return an \emph{integer card index}. You have float values (with decimal points) in the \texttt{pos} argument (because it ranges from -1 to 1 for \protect\hyperlink{psychopy-units-norm}{norm} units) and by default the values you compute from them will also be float. However, an index \emph{must} be integer, so you will need to wrap it in \href{https://docs.python.org/3/library/functions.html\#int}{int()} function call, before returning it.

Going backwards --- from position to index --- is (IMHO) easier. First, you need to think how you can convert an \emph{x} coordinate (goes from -1 to 1) to a column index (goes from 0 to 3) given that you have 4 columns (draw a sketch on paper as it will make figuring out math simpler). Similarly, you translate \emph{y} (from -1 to 1) into raw index given that there are only two rows. Once you know row and column index, you can compute the index itself, keeping in mind that there are four card in a row. As with \texttt{position\_from\_index}, I think it is easier to first play with formulas in a Jupyter Notebook, before turning the code into a function, documenting it, and putting it into \texttt{utilities.py}.

Put \texttt{index\_from\_position} into \texttt{utilities.py}.

\hypertarget{flip-a-selected-card-on-click}{%
\section{Flip a selected card on click}\label{flip-a-selected-card-on-click}}

Now that you have function that returns an index from position (don't forget to import it), you can flip the card that the player did clicked on. For this, you need to extend the card-flipping code inside the \emph{if left-mouse button was pressed} code. Get the position of the mouse within the window by calling \href{https://psychopy.org/api/event.html\#psychopy.event.Mouse.getPos}{mouse.getPos()}. This will return a pair of \texttt{(x,\ y)} values, which you can pass to your \texttt{index\_from\_position()} function. This, in turn will return the index of the card the player click on. Change the \texttt{"side"} of a card with that index to \texttt{"front"}. Test the code by turning different cards over, make sure that it is the card that you clicked on that gets turned. And a usual reminder, do not hesitate to put a breakpoint inside the if-statement to check the actual mouse position values and how they are translated into index, if things do not work.

Put your code into \texttt{code12.py}.

\hypertarget{keeping-track-of-open-cards}{%
\section{Keeping track of open cards}\label{keeping-track-of-open-cards}}

In the actual game, a player is allowed to flop only \emph{two} cards at a time. If they match, they are removed. If not, they are flipped to their backs again. This means we need to keep track of which and how many cards are face up. We can always figure this out by doing a list comprehension scanning for cards that have their \texttt{"side"} as \texttt{"face"}. But, mutable nature of dictionaries presents us with a simpler solution. We create a new list (let us call it \texttt{face\_up}) and add cards to it. Mutable dictionary will not be copied but rather a reference to it will be present in both lists (same card dictionary will have two stickers on it, one from the \texttt{cards} list, one from \texttt{face\_up} list). This way we know \emph{which} cards are face up (those that are in the list) and we know how many (length of the \texttt{face\_up} list).

However, you need to be careful not do add a card more than once (this will mess up our ``how many cards are face up'' number). There are two ways to do this. Assuming that \texttt{icard} is the index of the card, which you computed via \texttt{position\_to\_index()} from mouse position, you can simply check whether this card \texttt{"side"} is \texttt{"front"}. Alternatively, you can check whether this card is already \href{https://docs.python.org/3/reference/expressions.html?highlight=list\%20dictionary\#in}{in} the \texttt{face\_up} list. Either way will tell you whether the card is face up. If it is not, you should set its \texttt{"side"} to \texttt{"front"} and add it to \texttt{face\_up} list.

Implement this code, open a few cards. Then, use a breakpoint to pause the program and check that \texttt{face\_up} list contains exactly these (this many) cards. If it has \emph{more} then your face-up checks do not work. Put a breakpoint on them and step through the code to see what happens.

Put your code into \texttt{code13.py}.

\hypertarget{opening-only-two-cards}{%
\section{Opening only two cards}\label{opening-only-two-cards}}

Now we need to check whether a player open already two cards. In your code, mouse checks should be \emph{before} the drawing code. This means that cards are drawn face up immediately after a click. Once they are drawn, check the length of \texttt{face\_up}, if it equal to 2:

\begin{itemize}
\tightlist
\item
  pause the program for \textasciitilde0.5 s\footnote{Pick the timing you like!} via \href{https://psychopy.org/api/clock.html\#psychopy.clock.wait}{wait}, so that the player can see both cards.
\item
  flip both cards back (i.e., set their \texttt{"side"} to \texttt{"back"}).
\item
  remove them from \texttt{face\_up} list (see \href{https://docs.python.org/3/tutorial/datastructures.html\#more-on-lists}{.clear()} method).
\end{itemize}

Put your code into \texttt{code14.py}.

\hypertarget{taking-a-matching-pair-off-the-table}{%
\section{Taking a matching pair off the table}\label{taking-a-matching-pair-off-the-table}}

Our code turns cards back even you found a matching pair but we need to take them off the table. Once you have two cards in the \texttt{face\_up} list, you need to check whether they have the same chicken on them, i.e., their filenames are the same. If they are, you set \texttt{"show"} field to \texttt{False}. If not, you set their \texttt{"side"} to \texttt{"back"} (what your code is already doing). Either way, you still need to pause the program to allow the player to see them and to clear \texttt{face\_up} list (they are either off the table or face down, definitely not face up).

We also need to modify our code to handle \texttt{"show"} field correctly. First, modify your drawing code to draw only the cards that should be shown. Second, when handling mouse click, you need to check both that the card is not face up and that it is shown (otherwise you can ``open'' invisible cards).

Put your code into \texttt{code15.py}.

\hypertarget{game-over-once-all-the-cards-are-off-the-table}{%
\section{Game over once all the cards are off the table}\label{game-over-once-all-the-cards-are-off-the-table}}

When your code works correctly, you can take all the card off the table, so that only the gray screen remains. However, that should be the point when the game finishes and congratulates you in your success. Write a function \texttt{remaining\_cards} that will take the list with cards (i.e., our \texttt{cards} list) and will return how many cards are still shown (their \texttt{"show"} field is \texttt{True}). You definitely need a \protect\hyperlink{for-loop}{for} for this but implementation can be very different. You could use an extra counter variable that you initialize to 0 and then increment by one (see \href{https://docs.python.org/3/reference/simple_stmts.html\#augmented-assignment-statements}{+=} for a shortcut). Alternatively, you can use \href{l\#list-comprehension}{list comprehensions} to filter out all cards that not shown and return the length of that list (a single line solution). Implement this function in \emph{utilities.py} and use exit the loop by setting \texttt{game\_state} to \texttt{"victory"}. After the loop, you can check the \texttt{game\_state} variable and if the player was victorious, show a congratulatory message (\href{https://psychopy.org/api/visual/textstim.html\#psychopy.visual.TextStim}{TextStim}, note that you don't even need to create a variable for it, you can create an object and call \texttt{.draw()} on it, i.e., \texttt{visual.TextStim(...).draw()}) and wait for a key press before you close the window.

Put your code into \texttt{code16.py}.

\hypertarget{do-it-fast}{%
\section{Do it fast!}\label{do-it-fast}}

There are different ways on how you can quantify speed in this game. You could look at the number of pairs the player had to open until clearing them up (the fewer, the better). Or, you could measure how fast the player did it in seconds. (Or use a combination of these two measures) Let us use the second option --- total time taken --- as an opportunity to learn about using PsychoPy \href{https://psychopy.org/api/clock.html}{clocks}.

The two classes you will be primarily interested in are \href{https://psychopy.org/api/clock.html\#psychopy.clock.Clock}{Clock} and \href{https://psychopy.org/api/clock.html\#psychopy.clock.CountdownTimer}{CountdownTimer}. The only difference between the two is that \href{https://psychopy.org/api/clock.html\#psychopy.clock.Clock}{Clock} starts at (and \href{https://psychopy.org/api/clock.html\#psychopy.clock.Clock.reset}{resets} to) 0 and start counting \emph{elapsed} time, so its \href{https://psychopy.org/api/clock.html\#psychopy.clock.MonotonicClock.getTime}{getTime()} method will return only \emph{positive} values. In contrast, the \href{https://psychopy.org/api/clock.html\#psychopy.clock.CountdownTimer}{CountdownTimer} start with (and resets to) a value you initialized it with and starts counting \emph{remaining} time down. Importantly, it will not stop once it reaches 0, so you will eventually end up with \emph{negative} remaining time. Thus, for \href{https://psychopy.org/api/clock.html\#psychopy.clock.Clock}{Clock} you check whether the \emph{elapsed} time is longer than some predefined value, whereas for \href{https://psychopy.org/api/clock.html\#psychopy.clock.CountdownTimer}{CountdownTimer} you start at a predefined value and check that the \emph{remaining} time is above zero. Note it is not guaranteed that the remaining time will be exactly zero. If anything, it is extremely unlikely that this will ever happen, so never test for an exact equality with zero\footnote{More generally, never compare float values to exact numbers. They are \href{http://www.lahey.com/float.htm}{tricky}, as the underlying representation \href{https://docs.python.org/3/tutorial/floatingpoint.html}{does not guarantee} that the computation will produce \emph{exactly} the number that it should: \texttt{.1\ +\ .1\ +\ .1\ ==\ .3} is surprisingly \texttt{False}, try it yourself}!

Here, we are interested in the \emph{elapsed} time, so \href{https://psychopy.org/api/clock.html\#psychopy.clock.Clock}{Clock} is the obvious choice. Create a clock before the game loop and use the elapsed time in the congratulatory message.

Put your code into \texttt{code17.py}.

  \bibliography{book.bib}

\end{document}
